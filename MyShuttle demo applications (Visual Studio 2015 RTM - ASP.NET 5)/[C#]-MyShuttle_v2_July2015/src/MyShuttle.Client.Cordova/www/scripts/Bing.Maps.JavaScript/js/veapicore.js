window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.Gimme=function(){var n=function(){function n(n){Array.prototype.push.apply(this,n)}function t(i,r){if(i&&i instanceof n)return i;var u=!i&&[]||(r||typeof i=="string")&&t.query(i,r)||i instanceof Array&&i||[i];return new n(u)}function i(n,t){var i;for(i in t)t.hasOwnProperty(i)&&(n.prototype[i]=t[i])}return i(n,{length:Array.prototype.length,entities:function(){return Array.prototype.slice.apply(this)},sort:function(n){return Array.prototype.sort.call(this,n),this},reverse:function(){return Array.prototype.reverse.call(this),this},push:function(){return Array.prototype.push.apply(this,arguments),this},pop:function(){var t=Array.prototype.pop.call(this);return new n([t])},shift:function(){var t=Array.prototype.shift.call(this);return new n([t])},unshift:function(){return Array.prototype.unshift.apply(this,arguments),this},slice:function(){return new n(Array.prototype.slice.apply(this,arguments))},splice:function(){return new n(Array.prototype.splice.apply(this,arguments))},concat:function(t){return new n(Array.prototype.concat.apply(this.entities(),t.entities&&t.entities()||arguments))}}),t.Helper={get_guid:function(){var n=0;return function(t){if(!t)return"";if(t===window)return"win";if(t===document)return"doc";if(t.uniqueID)return t.uniqueID;var i="__$gimme$_guid__";return typeof t[i]=="undefined"&&(t[i]=i+n++),t[i]}}()},t.Browser=function(){var n=navigator.userAgent.toLowerCase(),t=typeof ActiveXObject!="undefined"||typeof MSPointerEvent!="undefined"||n.indexOf("trident")!==-1;return{is_ie:t,is_opera:typeof window.opera!="undefined",is_khtml:n.indexOf("khtml")!==-1,is_gecko:n.indexOf("khtml")===-1&&!t&&n.indexOf("gecko")!==-1,is_in_quirks_mode:document.compatMode==="BackCompat"}}(),t.undefined={}._$gimme$_undefined,t.ext=n.prototype,t}();return n.ext.select=function(t){return n(t,this[0])},typeof g=="undefined"&&(window.g=n),n.Internals=new function(){function n(n){return function(t,i,r){this[n](t,i,r)}}return{addEventListener:n("addEventListener"),removeEventListener:n("removeEventListener"),attachEvent:n("attachEvent"),detachEvent:n("detachEvent"),parseJSON:function(n){return JSON.parse(n)}}},n.query=function(){return function(){function b(n,t,i){return r[t](n,i)}function k(n,t){var r=[],u=t.length,i;do i=h(n,t[--u]||t),i&&r.push(i);while(u);return r}function h(n,t){if(n===document||!t)return t;for(var i=t;(i=i.parentNode)&&i!==n;);return i===n&&t||null}function d(n,t){var i=n.document||document;return h(n,i.getElementById(t))}function c(n,t){var i,f,r,e;if(t=t||document,n.id)return a([d(t,n.id)],n);if(delete n.id,i=t.getElementsByTagName(n.tag||"*"),(!n.classes||n.classes.length<1)&&(!n.attributes||n.attributes.length<1)&&(!n.pseudos||n.pseudos.length<1))return l(i);for(f=[],e=i.length,r=0;r<e;r++)u(n,i[r])&&f.push(i[r]);return f}function u(n,t){if(!t)return!1;for(var u=n.propNames,f=u.length,i=0;i<f;i++)if(!r[u[i]](t,n[u[i]]))return!1;return!0}function l(n){for(var i=[],r=n.length,t=0;t<r;t++)i[t]=n[t];return i}function a(n,t){for(var r=[],f=n.length,i=0;i<f;i++)n[i]&&n[i].nodeType===1&&u(t,n[i])&&r.push(n[i]);return r}function y(n,t){return v(n,t)!==-1}function p(n){var r;t.inc();for(var u=t.name,f=[],e=n.length,i=0;i<e;i++)r=n[i],r[u]!==t.t&&(r[u]=t.t,f.push(r));return f}function e(n){this.name=n,this.f=0,this.t=1,this.inc=function(){this.f=(this.t+=2)-1}}function g(n){this.parse=function(t){var u,i,f,o=n.preprocessInput,r,e;for(t=o&&o(t)||t,n.reset(),r=0,e=t.length;r<e;){if(u=t.charAt(r),i=i||n[u]||n["default"],i){if(f=i(t.substring(r,e)),!f)throw'No valid match found for "'+i.name+'" rule';r+=f}else throw'No suitable rule found to handle character "'+u+'"';i=null}return n.finish()}}function w(t,i){var w=i,r,u,h,o,a,y,v;if(i=i||document,n.inc(),typeof t!="string")return k(i||document,t);u=[];try{u=l(i.querySelectorAll(t))}catch(d){for(h=s.parse(t),a=h.length,o=0;o<a;o++){var f=h[o],p=f.length,e=p%2-1;for(r=e===0?c(f[e],i):[i||document];f[++e];)y=f[e++],v=f[e],v.root=i,r=b(r,y,v);u=a>1?u.concat(r):r}}return u}var t,i,n,r,o,s,v=function(){function n(n,t){return n.indexOf(t)}function t(n,t){for(var r=n.length,i=0;i<r;i++)if(n[i]===t)return i;return-1}return typeof Array.prototype.indexOf!="undefined"?n:t}(),f=function(){function n(n,t){return n.getAttribute(t)}function t(n,t){switch(t.toLowerCase()){case"class":return n.className||null;case"id":return n.id||null;case"href":case"src":if(typeof n.getAttribute!="undefined")return n.getAttribute(t,2)}return n.attributes&&n.attributes[t]&&n.attributes[t].nodeValue||n.getAttribute(t)}return function(){var i=document.createElement("div"),r;return i.innerHTML='<a href="#test">test<\/a>',r=i.firstChild,r.getAttribute("href")==="#test"?n:t}()}();return t=new e("__$gimme$_unique__"),i=new e("__$gimme$_genSib__"),n=new e("__$gimme$_nth__"),r={id:function(n,t){return n.id===t},tag:function(n,t){return n.tagName===t||t==="*"},classes:function(n,t){var i=n.className,u,r;if(typeof i!="string"&&(i=f(n,"class")),!i)return!1;for(u=" "+i+" ",r=t.length;r--;)if(u.indexOf(" "+t[r]+" ")===-1)return!1;return!0},attributes:function(){var n={},t={parse:function(t){var i=t.match(/^\[([\w-_]+)?(\=|\^=|\$=|\*=|\|=|~=|!=)?(.*)\]$/);return n[t]={name:i&&i[1],delim:i&&i[2],val:i&&i[3].replace(/^['"]|["']$/g,"")}},"=":function(n,t){return n===t},"^=":function(n,t){return n.indexOf(t)===0},"$=":function(n,t){var i=n.lastIndexOf(t);return i!==-1&&i+t.length===n.length},"*=":function(n,t){return n.indexOf(t)!==-1},"|=":function(n,t){return n===t||n.indexOf(t+"-")===0},"~=":function(n,t){return n===t||y(n.split(" "),t)},"!=":function(n,t){return n!==t},unknown:function(){return!1}};return function(i,r){for(var e=r.length,u,o;e--;){if(u=n[r[e]]||t.parse(r[e]),o=f(i,u.name),!o)return!1;if(u.delim&&!t[u.delim||"unknown"](o,u.val))return!1}return!0}}(),pseudos:function(){function r(n){var t=n+"Sibling";return function(n){for(var i=n[t];i&&i.nodeType!==1;)i=i[t];return!i}}var i={},t={parse:function(n){var t=n.match(/([\w-_]+)\b(\((((-?\d*)n)?([+-]?\d+)?|.*)\))?/),r={name:t&&t[1],param:{wholeValue:t&&t[3],a:t&&t[5]||0,b:t&&t[6]||0}};return r.param.wholeValue==="even"?(r.param.a=2,r.param.b=0):r.param.wholeValue==="odd"&&(r.param.a=2,r.param.b=1),i[n]=r},"first-child":r("previous"),"last-child":r("next"),"only-child":function(n){return t["first-child"](n)&&t["last-child"](n)},"nth-child":function(t,i){var h=n.t*1e4,u=n.name,r=t.parentNode,e=0,f;if(r){if(r[u+":parent"]!==n.t){r[u+":parent"]=n.t;for(var e=0,o=r.children||r.childNodes,s=-1,c=o.length;++s<c;)o[s].nodeType===1&&(e++,o[s][u]=h+e)}return f=t[u]-h-i.param.b,!i.param.a&&i.param.b?f===0:i.param.a*f>=0&&f%(i.param.a||1)==0}return!1},contains:function(n,t){return(n.textContent||n.innerText||n.innerHTML).indexOf(t.param.wholeValue)!==-1},not:function(){return!1}};return function(n,r){for(var u=r.length,f;u--;)if(f=i[r[u]]||t.parse(r[u]),!t[f.name](n,f))return!1;return!0}}()," ":function(n,t){for(var r=[],f=n.length,u,i=0;i<f;i++)if(u=c(t,n[i]),r=r.concat(u),t.id&&u.length===1)break;return p(r)},">":function(n,t){for(var r=[],u=n.length,i=0;i<u;i++)r=r.concat(a(n[i].childNodes,t));return r},"+":function(n,t){for(var f=[],o=n.length,e,i,r=0;r<o;r++){for(e=n[r],i=e.nextSibling;i&&i.nodeType!==1;)i=i.nextSibling;u(t,i)&&f.push(i)}return f},"~":function(n,t){var s,r;i.inc();for(var e=i.name,o=[],h=n.length,f=0;f<h;f++)for(s=n[f],r=s.nextSibling;r&&r[e]!==i.t;)r.nodeType===1&&(r[e]=i.t,u(t,r)&&o.push(r)),r=r.nextSibling;return o}},o=new function(){function i(){this.propNames=[]}var r,t,n;return i.prototype.propNames=[],i.prototype.storePropertyValue=function(n,t){this[n]=t,this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},i.prototype.storeArrayValue=function(n,t){this[n]||(this[n]=[]),this[n].push(t),this.propNames[n]||(this.propNames.push(n),this.propNames[n]=!0)},{preprocessInput:function(n){return n.replace(/\s*([ >+~,])\s*/g,"$1")},reset:function(){r=[],t=[],n=new i},finish:function(){return n&&n.propNames.length>0&&t.push(n),t.length>0&&r.push(t),r},"default":function(t){var r=t.match(/(\w+|\*)/),i;return r?(i=r[0].toUpperCase(),n.storePropertyValue("tag",i),i.length):null},"#":function(t){var i=t.match(/#([_\-\w]+)/),r;return i?(r=i[1],n.storePropertyValue("id",r),i[0].length):null},".":function(t){var i=t.match(/\.([_\-\w\d]+)/),r;if(i)return r=i[1],n.storeArrayValue("classes",r),i[0].length},"[":function(t){var r=t.match(/(\[.*"\]|.*?\])/),i;return r?(i=r[0],n.storeArrayValue("attributes",i),i.length):null},":":function(t){var r=t.match(/:[\w-_]+\b(\(.*\))?/),i;return r?(i=r[0],n.storeArrayValue("pseudos",i),i.length):null}," ":function(){return t.push(n," "),n=new i,1},">":function(){return n.propNames.length>0&&t.push(n),t.push(">"),n=new i,1},"~":function(){return t.push(n,"~"),n=new i,1},"+":function(){return t.push(n,"+"),n=new i,1},",":function(){return t.push(n),r.push(t),t=[],n=new i,1}}},s=new g(o),w.Internal={unique:p,index_of:v,contains:y,has_class:r.classes,get_attr:f},w}()}(),n.Helper.index_of=n.query.Internal.index_of,n.Helper.contains=n.query.Internal.contains,n.Helper.unique=n.query.Internal.unique,n.Helper.has_class=n.query.Internal.has_class,n.Helper.get_attr=n.query.Internal.get_attr,n.Effects={Animation:function(n){function s(n){for(var h=e(n),r=t.length,o,s;r--;){s={};for(o in u)s[o]=i[o][r]+u[o][r]*h;f(t[r],s,n)}}var t=n.elements||[],o=n.duration||1,i=n.from||{},r=n.to||{},u={},f,e;(function(){var f,n,s,e={},o={},h={};for(n in i)for(e[n]=[],o[n]=[],h[n]=[],f=t.length;f--;)s=t[f],e[n][f]=typeof i[n]=="function"?i[n](s,n):i[n],o[n][f]=typeof r[n]=="function"?r[n](s,n):r[n],h[n][f]=o[n][f]-e[n][f];i=e,r=o,u=h})(),f=n.animate,e=n.easing||function(n){return n},this.startTime=n.startTime||0,this.duration=o,this.add_element=function(n){t.push(n)},this.remove_element=function(n){for(var i=t.length;i--;)if(t[i]===n){t.splice(i,1);break}},this.tick=s},Storyboard:function(n){function u(){f||(f=!0,e=(new Date).getTime(),h=setInterval(rt,1))}function v(){t=0,i=1,u()}function y(){s(),l&&l(t)}function s(){clearInterval(h),f=!1}function p(){u()}function w(){i=1,u()}function b(){i=-1,u()}function k(){i*=-1,u()}function d(n){t=n,a()}function g(){return f}function nt(){return i}function tt(){return r}function it(){return o}function rt(){var n=(new Date).getTime();t+=(n-e)/o*i,e=n,t=t<0?0:t>1?1:t,a(),(i===-1&&t===0||i===1&&t===1)&&(s(),c&&c(t))}function a(){for(var u=r.length,n;u--;)n=(o*t-r[u].startTime)/r[u].duration,n=i===-1&&n<0?0:i===1&&n>1?1:n,n>=0&&n<=1&&r[u].tick(n)}var h,e,t=0,i=1,f=!1,r=n.animations,o=n.duration||0,c=n.completed,l=n.aborted;this.begin=v,this.abort=y,this.pause=s,this.resume=p,this.forward=w,this.backward=b,this.reverse=k,this.seek=d,this.is_running=g,this.get_direction=nt,this.get_animations=tt,this.get_duration=it},Easing:{Back:new function(){function n(n,t,i,r){return t=.5,i=0,r=.5,Math.pow(1-n,i)*r*Math.sin(2*Math.PI*n*t)*-1+n}function t(){}function i(){}this.ease_in=n,this.ease_out=t,this.ease_in_out=i},Bounce:new function(){function t(n,t,i){return t=t||1.5,i=i||4,Math.abs(Math.pow(n,t)*Math.cos(Math.PI*n*i))}function i(t,i,r){return 1-n.Effects.Easing.Bounce.ease_in(1-t,i,r)}function r(t,i,r){var u=0,f=n.Effects.Easing.Bounce.ease_in;return t>.5&&(f=n.Effects.Easing.Bounce.ease_out,t-=.5,u=1/2),f(t,i,r)-u}this.ease_in=t,this.ease_out=i,this.ease_in_out=r},Elastic:new function(){function n(){}function t(n,t,i){return t=t||3.5,i=i||5,1-Math.pow(1-n,t)*Math.cos(2*Math.PI*n*i)}function i(){}this.ease_in=n,this.ease_out=t,this.ease_in_out=i},Exponential:new function(){function n(n,t){return Math.pow(n,t)}function t(n,t){return Math.pow(n,1/t)}function i(i,r){return i<=.5?n(i*2,r)*.5:t((i-.5)*2,r)*.5+.5}this.ease_in=n,this.ease_out=t,this.ease_in_out=i}},Enums:{Directions:{vertically:1,horizontally:2,both:3},Speeds:{quickly:500,slowly:1e3}},RunningAnimations:function(){var t={};return{add:function(n,i){t[n]=i},remove:function(n){delete t[n]},get:function(i){return t[i]||new n.Effects.Storyboard({animations:[]})},contains:function(n){return!!t[n]}}}()},n.Effects.Storyboard.create=function(t,i,r,u,f,e,o,s){f=Math.floor(f)||n.Effects.Enums.Speeds[f]||n.Effects.Enums.Speeds.quickly;var h=new n.Effects.Storyboard({duration:f,completed:function(){o&&o.call(this),n.Effects.RunningAnimations.remove(e),h=null},aborted:function(){n.Effects.RunningAnimations.remove(e),h=null},animations:[new n.Effects.Animation({from:i,to:r,duration:f,animate:u,easing:s,elements:t})]});return e&&n.Effects.RunningAnimations.add(e,h),h},function(){var t=0,i={};n.Effects.Animation.requestAnimationFrame=function(){function u(n,t){return function(){i[t]&&n((new Date).getTime()),delete i[t]}}function e(n,f){var e=i[++t]=u(n,t);return r(e,f),t}function o(r){var e=i[++t]=u(r,t);return n.setTimeout(e,f),t}var f=16,n=window,r=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame;return r?e:o}(),n.Effects.Animation.cancelAnimationFrame=function(n){delete i[n]}}(),n.Ajax=new function(){function i(n,i){t(n,i,!0)}function r(n,i){t(n,i,!1)}function u(){if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){throw new Error("Error invoking XMLHTTP");}else throw new Error("XMLHttp is not supported");}function t(t,i,r){var f=u();f.onreadystatechange=function(){if(f.readyState===4){var t=f.responseText;r&&t&&(t=n.Internals.parseJSON(t)),i.call(f,t,f.status),f=null,i=null}},f.open("GET",t,!0),f.send("")}this.request_json=i,this.request_ahah=r},n.Screen=new function(){function t(){return typeof window.innerWidth!="undefined"?{width:window.innerWidth,height:window.innerHeight}:typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0?{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}:{width:document.getElementsByTagName("body")[0].clientWidth,height:document.getElementsByTagName("body")[0].clientHeight}}function i(n){var t,i;return n=n||window.event,t={x:0,y:0},typeof n.pageX!="undefined"?(t.x=n.pageX,t.y=n.pageY):(i=this.get_scroll_pos(),t.x=n.clientX+i.x,t.y=n.clientY+i.y),t}function r(){return n(window).get_scroll_pos()}this.get_viewport_size=t,this.get_mouse_pos=i,this.get_scroll_pos=r},n.Util=new function(){function t(){return n(arguments,!1)}function i(){return n(arguments,!0)}function n(n,t){function u(){i.apply(this,Array.prototype.slice.call(n,2)),t||(i=null)}var i=n[0],r=n[1];return t===!0?window.setInterval(u,r):window.setTimeout(u,r)}this.set_timeout=t,this.set_interval=i},n.Style=new function(){function f(i){var u=i.scrollTop&&i!==document.documentElement&&i!==document.body&&i.tagName!=="TEXTAREA"&&i.tagName!=="INPUT"?-1:0,r={x:i.scrollLeft*u,y:i.scrollTop*u},f;return n.Browser.is_ie&&t(i,"position")==="static"?(f=i.style.position,i.style.position="relative",r.x+=i.offsetLeft,r.y+=i.offsetTop,i.style.position=f):(r.x+=i.offsetLeft,r.y+=i.offsetTop),r}function a(i){var r={x:0,y:0},u;if(i.getBoundingClientRect){var s=i.getBoundingClientRect(),h=o(),c=n(window).get_scroll_pos();r.x=s.left-h.x+c.x,r.y=s.top-h.y+c.y}else while(i!==null)u=f(i),r.x+=u.x,r.y+=u.y,i=i.offsetParent,i&&!e()&&(r.x+=parseFloat(t(i,"borderLeftWidth"))||0,r.y+=parseFloat(t(i,"borderTopWidth"))||0);return r}function e(){var n,t;return typeof arguments.callee.constantValue=="undefined"&&(n=document.createElement("div"),n.style.cssText="position:absolute;visibility:hidden;top:0;left:0;border:1px solid #000;",t=document.createElement("div"),n.appendChild(t),document.body.appendChild(n),arguments.callee.constantValue=t.offsetTop===1,document.body.removeChild(n),n=t=null),arguments.callee.constantValue}function o(){var i,r;if(typeof arguments.callee.constantValue=="undefined"){var t=document.body,u=t.style.position,f=t.style.margin,e=t.style.border;t.style.position="static",t.style.margin="0",t.style.border="1px solid transparent",i=t.getBoundingClientRect(),r=n(window).get_scroll_pos(),arguments.callee.constantValue={x:i.left+r.x,y:i.top+r.y},t.style.position=u,t.style.margin=f,t.style.border=e,document.documentElement.className=document.documentElement.className}return arguments.callee.constantValue}function t(n,t){var r="",u,e,f;return n.currentStyle&&(t==="right"||t==="bottom")?r=i(t,"auto","auto",n)+"px":(u=document.defaultView&&document.defaultView.getComputedStyle&&document.defaultView.getComputedStyle(n,null)||n.currentStyle,u&&(r=u[t]||"",e=r.match(/px$/),e||(f=r.match(/(em|ex|%|in|cm|mm|pt|pc|small|medium|large|thin|thick|auto)$/),f&&(r=i(t,r,f[0],n)+"px")))),r}function i(i,r,u,f){var s,h,a,o,c,v,y,p,l,e,w;if(r){if(u==="px")return parseFloat(r);if(r==="auto")switch(i){case"top":case"left":return 0;case"bottom":case"right":if(s={bottom:["top","offsetTop","height","offsetHeight"],right:["left","offsetLeft","width","offsetWidth"]},h=n(f),h.get_style("position")==="relative")return a=s[i][0],-parseInt(h.get_style(a));for(o=f.parentNode;o!==document&&n(o).get_style("position")==="static";)o=o.parentNode;return c=s[i][2],v=o===document?n.Screen.get_viewport_size()[c]:parseInt(n(o).get_style(c)),y=s[i][1],p=s[i][3],v-f[y]-f[p];case"height":return f.clientHeight||f.offsetHeight&&f.offsetHeight-parseFloat(t(f,"borderTopWidth"))-parseFloat(t(f,"borderBottomWidth"))||0;case"width":return f.clientWidth||f.offsetWidth&&f.offsetWidth-parseFloat(t(f,"borderLeftWidth"))-parseFloat(t(f,"borderRightWidth"))||0;default:return 0}else{switch(i){case"borderLeftWidth":case"borderRightWidth":case"borderTopWidth":case"borderBottomWidth":return i=i.replace("Width","Style"),l=t(f,i),l==="none"?0:parseFloat(l)}f=f||document.body,e=document.createElement("div"),e.style.visbility="hidden",e.style.position="absolute",e.style.lineHeight="0",u==="%"?(f=f.parentNode,i==="height"||i==="top"?e.style.height=r:(i==="width"||i==="left")&&(e.style.width=r)):(e.style.borderStyle="solid",e.style.borderBottomWidth="0",e.style.borderTopWidth=r);try{f.appendChild(e)}catch(b){f=f.parentNode,f.appendChild(e)}return f.offsetWidth,f.offsetHeight,w=e.offsetHeight||e.offsetWidth,f.removeChild(e),w}}else return 0}function v(n,t){var i=c(n,t);return i.camelizedName||n}function y(n,t){var i=c(n,t);return i.nonCamelizedName||n}function c(n,t){var i,e,f,o,s;if(t=t||document.body||document.createElement("div"),i=r[n],!i){for(i={},e=u.length;e--;)if(f=u[e],o=l(f+n),t.style[o]!==undefined){s=(f&&"-"||"")+f.toLowerCase()+n,i.camelizedName=o,i.nonCamelizedName=s;break}r[n]=i}return i}function l(n){return n.replace(/-(\w)/g,function(n,t){return t.toUpperCase()})}var s,h,r,u;this.get_relative_pos=f,this.get_absolute_pos=a,this.offset_includes_borders=e,this.get_bounding_client_rect_offsets=o,s=function(){function t(n,t){n.style.opacity=t}function i(n,t){t*=100;var i;try{i=n.filters.item("DXImageTransform.Microsoft.Alpha"),t<100?(i.Opacity=t,i.enabled||(i.enabled=!0)):i.enabled=!1}catch(r){t<100&&(n.style.filter=(n.currentStyle||n.runtimeStyle).filter+" progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")")}}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&t||typeof n.style.filter!="undefined"&&i||function(){}}(),this.set_opacity=s,h=function(){function i(n){return parseFloat(n.style.opacity)||t(n,"opacity")}function r(n){var t=n.filters["DXIMageTransform.Microsoft.Alpha"];return t?t.Opacity/100:1}var n=document.createElement("div");return typeof n.style.opacity!="undefined"&&i||typeof n.style.filter!="undefined"&&r||function(){}}(),this.get_opacity=h,this.get_rendered_style=t,this.normalize_style=i,r={},u=["O-","ms-","Moz-","webkit-",""],this.get_camelized_style_name=v,this.get_css_style_name=y,this.camelize=l},n.Events=new function(){var r=n.Helper,i=null,t=null;this.capture_mouse=function(r,u){return n.Events.release_mouse(),i=r,u!==!1&&(u=!0),r.setCapture!==undefined?r.setCapture(u):(t=function(r){var e=r.target,f=document.createEvent("MouseEvents"),o,s;f.initMouseEvent(r.type,r.bubbles,r.cancelable,window,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget),f.__defineGetter__&&(o=n.Screen.get_scroll_pos(),f.__defineGetter__("pageX",function(){return this.clientX+o.x}),f.__defineGetter__("pageY",function(){return this.clientY+o.y})),document.removeEventListener(r.type,t,!0),f.captureTarget=e,s=i,u||n(i).has(e)&&(s=e),s.dispatchEvent(f),t!==null&&document.addEventListener(r.type,t,!0),delete f.captureTarget,r.stopPropagation()},document.addEventListener("mouseover",t,!0),document.addEventListener("mouseout",t,!0),document.addEventListener("mousemove",t,!0),document.addEventListener("mouseup",t,!0),document.addEventListener("mousedown",t,!0),document.addEventListener("click",t,!0),document.addEventListener("dblclick",t,!0)),this},this.release_mouse=function(){return i!==null&&(i.releaseCapture!==undefined?i.releaseCapture():(document.removeEventListener("mouseover",t,!0),document.removeEventListener("mouseout",t,!0),document.removeEventListener("mousemove",t,!0),document.removeEventListener("mouseup",t,!0),document.removeEventListener("mousedown",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("dblclick",t,!0)),i=t=null),this},this.get_capture_target=function(n){return n.captureTarget||n.srcElement||n.target},this.Pseudo=new function(){function t(n,t,i){this.pseudoName=n,this.getNativeName=t,this.getProxiedHandler=i}function v(n,t,i){if(n===t)return!1;for(var r=0;t&&t!=n;)r++,t=t.parentNode;return i=i||r,t===n&&i===r}function h(n){var i=r.get_guid(n),t=f[i];return t||(t=f[i]=function(t){var i=t.relatedTarget;i&&this!==i&&!v(this,i)&&n.call(this,t)}),t}function y(t){if(!n.Browser.is_gecko)return t;var u=r.get_guid(t),i=f[u];return i||(i=f[u]=function(n){n.wheelDelta=-40*n.detail,t.call(this,n),n.wheelDelta=null}),i}function s(t){if(!n.Browser.is_ie)return t;var o=r.get_guid(t),u=f[o];return u||(u=f[o]=function(u){var s,f,h,c,o;if(u.pointerType===u.MSPOINTER_TYPE_TOUCH||u.pointerType==="touch"){/pointerup$/.test(u.type.toLowerCase())||/pointercancel$/.test(u.type.toLowerCase())?delete e[u.pointerId]:(s=n.Screen.get_mouse_pos(u),e[u.pointerId]={_$targetId:r.get_guid(u.target),identifier:u.pointerId,pageX:s.x,pageY:s.y}),h=[],c=[];for(f in e)e.hasOwnProperty(f)&&e[f]&&(o=e[f],h.push(o),o._$targetId===r.get_guid(u.target)&&c.push(o));u.touches=h,u.targetTouches=c,u.type===i.touchstart&&(u.preventDefault=p),t.call(this,u),u.touches=u.targetTouches=null}}),u}function p(){return u[this.pointerId]=!0,document.addEventListener(i.touchend,c,!0),document.addEventListener("click",l,!0),MSPointerEvent.prototype.preventDefault.call(this)}function c(n){o=n.pointerId,u[o]&&(u[o]=!1)}function l(n){var t,r=0;for(t in u)t=parseInt(t),u[t]===!1&&delete u[t]||r++,t===o&&(n.stopPropagation()||n.preventDefault());r===0&&(document.removeEventListener(i.touchend,c,!0),document.removeEventListener("click",l,!0))}function a(){}var o=null,u={},f={},e={},i={touchstart:navigator.pointerEnabled?"pointerdown":"MSPointerDown",touchend:navigator.pointerEnabled?"pointerup":"MSPointerUp",touchmove:navigator.pointerEnabled?"pointermove":"MSPointerMove",touchcancel:navigator.pointerEnabled?"pointercancel":"MSPointerCancel"};return t.prototype.add=function(n,t,i){n.add_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},t.prototype.remove=function(n,t,i){n.remove_event(this.getNativeName(this.pseudoName),this.getProxiedHandler(t,n),i,!0)},{mouseenter:new t("mouseenter",function(){return"mouseover"},function(n){return h(n)}),mouseleave:new t("mouseleave",function(){return"mouseout"},function(n){return h(n)}),mousewheel:new t("mousewheel",function(t){return n.Browser.is_gecko?"DOMMouseScroll":t},function(n){return y(n)}),touchstart:new t("touchstart",function(t){return n.Browser.is_ie?i[t]:t},function(t){return n(document).add_event("touchend",a,!0).add_event("touchcancel",a,!0),s(t)}),touchend:new t("touchend",function(t){return n.Browser.is_ie?i[t]:t},function(n){return s(n)}),touchmove:new t("touchmove",function(t){return n.Browser.is_ie?i[t]:t},function(n){return s(n)}),touchcancel:new t("touchcancel",function(t){return n.Browser.is_ie?i[t]:t},function(n){return s(n)})}}},function(){var u=n.Helper,e=n.Internals,i,t,o={},f={},r={load:!1,unload:!1,focus:!1,blur:!1,beforeunload:!1,stop:!1,beforeprint:!1,afterprint:!1,propertychange:!1,filterchange:!1,readystatechange:!1,losecapture:!1};n.ext.add_event=function(){function s(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].add(this,i,r):this.for_each(function(n){e.addEventListener.call(n,t,i,r)}),this}function h(s,h,c,l){function a(i,r){t=t||1,r.eventPhase=t,r.target=r.srcElement,r.currentTarget=i;var u=n.Screen.get_mouse_pos(r);r.pageX=u.x,r.pageY=u.y;switch(r.type){case"keyup":case"keydown":case"keypress":i.type!=="file"&&(r.keyCode===186?r.keyCode=59:r.keyCode===187?r.keyCode=61:r.keyCode===189?r.keyCode=109:null),r.which=r.keyCode,r.charCode=r.keyCode;break;case"mousedown":case"mouseup":case"click":case"dblclick":case"contextmenu":r.which=[1,1,3,r.button,2][r.button];break;case"mouseover":r.relatedTarget=r.fromElement;break;case"mouseout":r.relatedTarget=r.toElement}return r.preventDefault=function(){r.returnValue=!1},r.stopPropagation=function(){r.cancelBubble=!0},r}function v(n,t,i){var u=r[n],f;return u===!1?!1:(u||(u=r[n]={}),f=u[t],f||(f=u[t]=[]),f.push(i),!0)}function y(n,t){var r=f[n],i;r||(r=f[n]={}),i=r[t],i||(i=r[t]={handlerCount:0,remainingHandlers:0}),i.handlerCount++,i.remainingHandlers=i.handlerCount}function p(n,f){for(var a=[],c=n,o,e,h,v,l;c;)a.push(c),c=c.parentNode;while(o=a.pop())if(e=u.get_guid(o),r[s][e])for(i||(i=o),v=r[s][e].length,h=0;h<v;h++)f.cancelBubble||(o===f.target&&(f.eventPhase=t=2),l=r[s],l[e]&&l[e][h]&&l[e][h].call(o,f));return i}return!l&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[s]?n.Events.Pseudo[s].add(this,h,c):this.for_each(function(n){var w=u.get_guid(n),k=u.get_guid(h)+(c||!1).toString(),b="{"+w+" / "+s+" / "+k+"}",l;c&&(c=v(s,w,h)),l=o[b],l||(l=function(u){var e=f[s][w];e.remainingHandlers--,u=a(n,u),r[s]&&t===1&&(i=p(n,u)),t=n===u.target?2:3,u.eventPhase=t,c||u.cancelBubble||h.call(n,u),(!i||u.cancelBubble||n==i&&e.remainingHandlers===0)&&(t=1,i=undefined,e.remainingHandlers=e.handlerCount),u.eventPhase=u.target=u.currentTarget=u.relatedTarget=u.which=u.preventDefault=u.stopPropagation=u.pageX=u.pageY=undefined},o[b]=l,e.attachEvent.call(n,"on"+s,l),y(s,w)),b=null,l=null}),this}return document.addEventListener?s:document.attachEvent?h:function(){}}(),n.ext.remove_event=function(){function t(t,i,r,u){return!u&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,i,r):this.for_each(function(n){e.removeEventListener.call(n,t,i,r)}),this}function i(t,i,s,h){function c(t,i,u){var e=r[t],f,o;e&&(f=e[i],f&&(o=n(f).index_of(u),o!==-1&&f.splice(o,1),f.length===0&&delete e[i]))}function l(n,t){var i=f[n]&&f[n][t];i&&(i.handlerCount>0&&i.handlerCount--,i.remainingHandlers=i.handlerCount)}return!h&&n.Events&&n.Events.Pseudo&&n.Events.Pseudo[t]?n.Events.Pseudo[t].remove(this,i,s):this.for_each(function(n){var f=u.get_guid(n),a=u.get_guid(i)+(s||!1).toString(),h="{"+f+" / "+t+" / "+a+"}",r;s&&c(t,f,i),r=o[h],r&&(e.detachEvent.call(n,"on"+t,r),delete o[h],l(t,f)),h=null,r=null}),this}return document.addEventListener?t:document.attachEvent?i:function(){}}()}(),function(){var t=n.Helper;n.ext.add_class=function(i){var r=i.split(/\s+/);return this.for_each(function(i){n(r).for_each(function(n){t.has_class(i,[n])||(i.className===""?i.className=n:i.className+=" "+n)})}),this}}(),n.ext.remove_class=function(n){return this.swap_class(n,"$1")},n.ext.swap_class=function(t,i){i!=="$1"&&(i=" "+i+" ");var r=t.split(/\s+/);return this.for_each(function(t){var u=t.className;n(r).for_each(function(n){var t=new RegExp("(^| )"+n+"( |$)");u=u.replace(t,i)}),t.className=u.replace(/^\s+|\s+$/g,"")}),this},function(){var t=n.Helper;n.ext.has_class=function(n,i){var r=this[i||0];return r&&t.has_class(r,[n])||!1}}(),n.ext.get_html=function(n){var t=this[n||0];return t&&t.innerHTML||""},n.ext.set_html=function(n){return this.for_each(function(t){t.innerHTML=n}),this},n.ext.get_val=function(n){var t=this[n||0];return t&&t.value||""},n.ext.set_val=function(n){return this.for_each(function(t){typeof t.value!="undefined"&&(t.value=n)}),this},function(){var t=n.Helper.get_attr;n.ext.get_attr=function(n,i){var r=this[i||0];return r&&t(r,n)||""}}(),n.ext.set_attr=function(n,t){return this.for_each(function(i){i.tagName.toUpperCase()==="INPUT"&&n==="checked"?(i[n]=t,i.defaultChecked=t):n.toUpperCase()==="CLASS"?i.className=t:i.setAttribute(n,t)}),this},function(){var t=n.Style.get_rendered_style,i=n.Style.get_opacity,r=n.Style.get_camelized_style_name;n.ext.get_style=function(n,u){var f=this[u||0];return f?n==="opacity"?i(f):t(f,r(n)):""}}(),function(){var t=n.Style.set_opacity,i=n.Style.get_camelized_style_name;n.ext.set_style=function(n){return this.for_each(function(r){var e,u,f;for(e in n){u=n[e],f=i(e);switch(f){case"height":case"maxHeight":case"minHeight":case"width":case"maxWidth":case"minWidth":case"top":case"right":case"bottom":case"left":case"marginTop":case"marginRight":case"marginBottom":case"marginLeft":case"paddingTop":case"paddingRight":case"paddingBottom":case"paddingLeft":r.style[f]=typeof u=="number"?(u||0)+"px":u;break;case"opacity":t(r,u);break;default:r.style[f]=u}}}),this}}(),n.ext.get_native_prop=function(n,t){var i=this[t||0];return i?i[n]:""},n.ext.parent=function(t){var i=this[t||0];return n(i&&i.parentNode)},n.ext.element=function(n){return this[n||0]},n.ext.get_ancestor=function(t,i){for(var r=this[i||0],u=t;u-->0;)if(r)r=r.parentNode;else break;return n(r)},n.ext.get_sibling=function(t,i){var f=this[i||0],r=f;if(t!==0)for(var e=t>0?"nextSibling":"previousSibling",o=Math.abs(t),u=0;u<o;){if(r=r[e],!r)break;r.nodeType===1&&u++}return n(r)},n.ext.for_each=function(){function n(n,t){return this.entities().forEach(n,t),this}function t(n,t){for(var r=this.entities(),u=r.length,i=0;i<u;i++)n.call(t,r[i],i,r);return this}return typeof Array.prototype.forEach!="undefined"?n:t}(),n.ext.iterate=function(t){for(var u=this.length,r,i=0;i<u;i++)r=n(this[i]),t.call(r,i);return t=null,this},n.ext.filter=function(t){for(var r=n(),i=this.length;i--;)t(this[i])&&r.unshift(this[i]);return r},n.ext.map=function(){function t(t,i){return n(this.entities().map(t,i))}function i(t,i){for(var r=n(),u=this.length;u--;)r.unshift(t.call(i,this[u]));return r}return typeof Array.prototype.map!="undefined"?t:i}(),function(){var t=n.Helper;n.ext.contains=function(n){return t.contains(this.entities(),n)}}(),function(){var t=n.Helper;n.ext.index_of=function(n){return t.index_of(this.entities(),n)}}(),n.ext.select=function(t){return n(t,this[0])},n.ext.has=function(t,i){var r=this[i||0];return n(t,r).length>0},function(){var t=n.Helper;n.ext.unique=function(){return n(t.unique(this.entities()))}}(),function(){var t=n.Style.get_rendered_style;n.ext.get_style_pos=function(n){var i=this[n||0];return{x:parseFloat(t(i,"left")),y:parseFloat(t(i,"top"))}}}(),function(){var t=n.Style.get_absolute_pos;n.ext.get_absolute_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){var t=n.Style.get_relative_pos;n.ext.get_relative_pos=function(n){var i=this[n||0];return i&&t(i)||{x:0,y:0}}}(),function(){n.ext.get_scroll_pos=function(t){var r=this[t||0],i={x:0,y:0};return r===window?typeof window.pageYOffset!="undefined"?(i.x=window.pageXOffset,i.y=window.pageYOffset):n.Browser.is_in_quirks_mode||typeof document.documentElement.scrollTop=="undefined"?typeof document.body.scrollTop!="undefined"&&(i.x=document.body.scrollLeft,i.y=document.body.scrollTop):(i.x=document.documentElement.scrollLeft,i.y=document.documentElement.scrollTop):(i.x=r.scrollLeft,i.y=r.scrollTop),i}}(),n.ext.animate=function(t,i,r,u,f){function l(n,t,i){switch(n){case"+":return t+i;case"-":return t-i;case"*":return t*i;case"/":return t/i;default:return i}}function s(t,i){var r=n(t).get_style(i)+"",u=parseFloat(r);return e.units[i]=r.replace(u,""),u}function a(n,i){var e=s(n,i),r=t[i]+"",u=r.match(/^[+\-*\/]/),f=u&&u[0]||"noOp";return r=Number(r.replace(f,"")),l(f,e,r)}var e={units:{},ops:{}},h={},o,c;for(o in t)e[o]=s,h[o]=a;return c=n.Effects.Storyboard.create(this,e,h,function(t,i){var f=n(t),r,u;for(r in i)r!=="units"&&(u={},u[r]=i[r]+e.units[r],f.set_style(u))},i,r,u,f),c.begin(),this},n.ext.bounce=function(t,i,r,u,f){function e(t){return n(t).get_style_pos().y}t===null&&(t=e);var o=n.Effects.Storyboard.create(this,{top:t},{top:i},function(n,t){n.style.top=Math.ceil(t.top)+"px"},r,u,f,n.Effects.Easing.Bounce.ease_out);return o.begin(),this},function(){function t(t,i,r,u,f){this.set_style({zoom:1}),t===null&&(t=function(t,i){return Number(n(t).get_style(i))});var e=n.Effects.Storyboard.create(this,{opacity:t},{opacity:i},function(t,i){n(t).set_style({opacity:i.opacity})},r,u,f,null);return e.begin(),this}n.ext.fade_to=t,n.ext.fade_in=function(n,i,r,u){return t.call(this,0,1,n,i,r,u)},n.ext.fade_out=function(n,i,r,u){return t.call(this,1,0,n,i,r,u)}}(),n.ext.slide=function(t,i,r,u,f,e){function o(t,i){i=i==="left"?"x":"y";var r=t.__pos;return r||(r=t.__pos=n(t).get_style_pos()),i==="y"&&(t.__pos=n.undefined),r[i]}t===null&&(t={x:o,y:o});var s=Math.round,h=n.Effects.Easing.Exponential.ease_in_out,c=n.Effects.Storyboard.create(this,{left:t.x,top:t.y},{left:i.x,top:i.y},function(n,t){n.style.top=s(t.top)+"px",n.style.left=s(t.left)+"px"},r,u,f,e||function(n){return h(n,4)});return c.begin(),this},n.ext.scroll_to=function(t,i,r,u){var f=n.Screen.get_scroll_pos(),e=n(this[0]).get_absolute_pos(),o=Math.round,s=n.Effects.Easing.Exponential.ease_out,h=n.Effects.Storyboard.create([window],{scrollX:f.x,scrollY:f.y},{scrollX:e.x,scrollY:e.y},function(n,t){n.scrollTo(o(t.scrollX),o(t.scrollY))},t,i,r,u||function(n){return s(n,4)});return h.begin(),this},n.ext.veil=function(t,i,r,u,f){function l(t,i){var r=parseInt(n(t).get_style(i),10);return t[h]=t[h]||{},t[h][i]=r}var e=n.Effects.Enums.Directions,h,o,s,c;return t=Math.floor(t)||e[t]||e.vertically,h="_$gimme$_veil",o={},s={},(t&e.vertically)===e.vertically&&(s.height=s.paddingTop=s.paddingBottom=l,o.height=o.paddingTop=o.paddingBottom=0),(t&e.horizontally)===e.horizontally&&(s.width=s.paddingLeft=s.paddingRight=l,o.width=o.paddingLeft=o.paddingRight=0),c=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i!=="none"}),s,o,function(n,i){var r=n.style;(t&e.vertically)===e.vertically&&(r.height=i.height+"px",r.paddingTop=i.paddingTop+"px",r.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(r.width=i.width+"px",r.paddingRight=i.paddingRight+"px",r.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),c.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden"}}),new n.Effects.Animation({startTime:c.get_duration(),elements:this,animate:function(n){n.style.display="none"}})),c.begin(),this},n.ext.unveil=function(t,i,r,u,f){function c(t,i){var r=t._$gimme$_veil;return r||(r=r||function(){var i=t.cloneNode(!0),r,u,f;return i.style.cssText="position:absolute;top:0;left:0;visibility:hidden;margin:0;padding:0;border:0;height:;width:;",i.style.display="block",t.parentNode.appendChild(i),i=n(i),r=parseInt(n(t).get_style("height"),10)||parseInt(i.get_style("height"),10),u=parseInt(n(t).get_style("width"),10)||parseInt(i.get_style("width"),10),i[0].style.padding=t.style.padding,f={height:r,width:u,paddingTop:parseInt(i.get_style("paddingTop"),10),paddingBottom:parseInt(i.get_style("paddingBottom"),10),paddingRight:parseInt(i.get_style("paddingRight"),10),paddingLeft:parseInt(i.get_style("paddingLeft"),10)},t.parentNode.removeChild(i[0]),t.style.overflow="hidden",f}()),r[i]}var e=n.Effects.Enums.Directions,o,s,h;return t=Math.floor(t)||e[t]||e.vertically,e=n.Effects.Enums.Directions,t=Math.floor(t)||e[t]||e.vertically,o={},s={},(t&e.vertically)===e.vertically&&(s.height=s.paddingTop=s.paddingBottom=0,o.height=o.paddingTop=o.paddingBottom=c),(t&e.horizontally)===e.horizontally&&(s.width=s.paddingLeft=s.paddingRight=0,o.width=o.paddingLeft=o.paddingRight=c),h=n.Effects.Storyboard.create(this.filter(function(t){var i=t.style.display||n(t).get_style("display");return i==="none"||i===null}),s,o,function(n,i){(t&e.vertically)===e.vertically&&(n.style.height=i.height+"px",n.style.paddingTop=i.paddingTop+"px",n.style.paddingBottom=i.paddingBottom+"px"),(t&e.horizontally)===e.horizontally&&(n.style.width=i.width+"px",n.style.paddingRight=i.paddingRight+"px",n.style.paddingLeft=i.paddingLeft+"px")},i,r,u,f||function(t){return n.Effects.Easing.Exponential.ease_in_out(t,4)}),h.get_animations().push(new n.Effects.Animation({startTime:0,elements:this,animate:function(n){n.style.overflow="hidden",n.style.display="block"}}),new n.Effects.Animation({startTime:h.get_duration(),elements:this,animate:function(n){n.style.overflow=""}})),h.begin(),this},n.toString=function(){return"Gimme v2.7.0 (Edmund) :: Friday, September 14, 2012 3:02:22 PM"},n.Internals.parseJSON=function(n){var t=n.length-2;return n.substring(t)===".d"?(n=n.substring(0,t),jsonObj=JSON.parse(n).d):jsonObj=JSON.parse(n),jsonObj},n}(),window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},function(){window[$MapsNamespace].Maps.Globals={disableTasks:!1,disableVenueMaps:!1,disableDirections:!1,disableSearch:!1,disableAnalytics:!1,allowCollinsBart:!0,collinsBartMinZoom:14,collinsBartMaxZoom:17,collinsBartBounds:"51.737859,-0.612711,51.219099,0.21;51.669855,0.21,51.368438,0.306658",allowOrdnanceSurvey:!0,ordnanceSurveyMinZoom:12,ordnanceSurveyMaxZoom:17,ordnanceSurveyBounds:"51.00,-6.599071,49.80,1.102680;54.84,-5.473597,51.00,2.280852;55.33,-5.875136,54.84,-1.150838;60.98,-9.358483,55.33,-1.163498",allowAerialMap:!0,allowBirdseye:!0,zoomOriginWidth:256,minMercatorZoom:1,maxMercatorZoom:20,jsonTimeStamp:new Date(1).valueOf()}}(),window[$MapsNamespace].Maps.initMapCode=function(){function i(n,t){this.x=n,this.y=t}function v(n,t,i,r){this.latitude=parseFloat(n),this.longitude=parseFloat(t),ht.isValid(r)&&(this.altitude=parseFloat(i),this.altitudeReference=r)}function rt(n,t,i){this.center=n,this.width=t,this.height=i}function iu(t){function i(){var t=f.getWidth(),i=f.getHeight();(t!==e||i!==o)&&(e=t,o=i,n.invoke(f,"resize",{width:t,height:i}))}var f=this,l=t.onresize!==s,r,e,o,h=y(t),c=y(window);this.getWidth=function(){return t.offsetWidth},this.getHeight=function(){return t.offsetHeight},this.startMonitoring=function(){l?(h.add_event("resize",i),u.useOnResize&&(t.onresize=i)):(r||(r=window.setInterval(i,1e3)),c.add_event("resize",i))},this.stopMonitoring=function(){h.remove_event("resize",i),u.useOnResize&&t.onresize===i&&(t.onresize=null),r&&(window.clearInterval(r),_timeoutId=null),c.remove_event("resize",i)},this.poll=function(){e=null,o=null,i()}}function rr(r,f){function sr(){function p(){var i=e.getImageryId(),n="dark",t=y("~.InfoboxExtension",h);switch(i){case"Aerial":case"EnhancedBirdseye":case"NativeBirdseye":v.add_class(n),t.add_class(n);break;default:v.remove_class(n),t.remove_class(n)}}var o,a,d,i,r,s;if(f=f||{},h=k(),h.className="MicrosoftMap",u.allowFocus&&(l=k("button","position:fixed;width:1px;height:1px;left:0;top:0;padding:0;font-size:0;line-height:0;border:0;background:transparent;",h),l.tabIndex=-1,u.useXHR&&y(l).set_style({display:"none"})),ht=yi(),bt=yi(),ft.appendChild(h),t.versionNotSupported===!0){i=k("div","position:absolute; width:100%; top:50%; text-align:center"),r=k("div","background: #f8f7f5; padding:10px; color: #000;"),r.innerHTML=hr.getString("L_VersionNotSupportedMessage_Text"),i.appendChild(r),e.getRootElement().appendChild(i);return}if(t.killSwitchEngaged===!0){i=k("img","position:absolute; height:100%; margin:auto"),i.src=t.killSwitchImageUrl,e.getRootElement().appendChild(i);return}if(kt=y(document),gt=y(ht),v=y(h),ti=f.restrictKeyboardListeningToMapContainer?y(ft):kt,f.theme&&(rt=f.theme,rt._attachToMap&&rt._attachToMap(e,f)),f.showHotRegions===!0&&(t.onDemandRoadUriFormat&&(t.roadUriFormat=t.onDemandRoadUriFormat),t.onDemandAerialWithLabelsUriFormat&&(t.aerialWithLabelsUriFormat=t.onDemandAerialWithLabelsUriFormat)),n.invoke(rr,"mapcreationstart",{map:e,options:f}),si=f.credentials,c.authenticate(f.credentials),typeof ot!="undefined"&&ot.authenticate(e.getCredentials),g=new iu(h),n.addHandler(g,"resize",ar),pi(f.width,f.height),t.ddCoreStylesDownloaded||rt&&!u.useXHR||(ui.downloadStyles(t.cssPath+"mapcontrol.css"),t.ddCoreStylesDownloaded=!0),o=tu(f),o.mapTypeId=o.mapTypeId||dt.auto||dt.road,o.animate=!1,e.setView(o),fi&&e.focus(),v.add_event("mousedown",e.focus).add_event("touchstart",e.focus),t.allowBirdseye===!1&&(f.disableBirdseye=!0),b.dispatch(function(){if(c){var n={showDashboard:f.showDashboard,showMapTypeSelector:f.showMapTypeSelector,showDualMapTypeSelector:f.showDualMapTypeSelector,disableBirdseye:f.disableBirdseye,showBreadcrumb:f.showBreadcrumb,showScalebar:f.showScalebar,scalebarPosition:f.scalebarPosition||"bottomRight",showLogo:f.showLogo,logoPosition:f.logoPosition||"bottomLeft",clickable:f.enableClickableLogo,enableSearch:f.enableSearchLogo,showCopyright:f.showCopyright,copyrightPosition:f.copyrightPosition||"bottomRight",copyrightStacked:f.copyrightStacked||!1};c.showOverlays(n)}}),f.showHotRegions===!0&&(b.dispatch(function(){c&&c.showHotRegions(f.disableLabels)}),f.showVenueMapsExplorer===!0&&b.dispatch(function(){c&&c.showVenueMapsExplorer()})),t.disableAnalytics||f.disableAnalytics||(a=new wu(e),e.addComponent("analyticsProxy",a),!t.frontdoorLogUrl&&t.biciLoggingService&&e.getCredentials(function(n){a.enable({sessionKey:n})})),f.fixedMapPosition===!0&&(oi=!1),d=n.addHandler(e,"imagerychanged",p),p(),u.useXHR&&t.message&&(i=k("div","position:absolute; width:100%; top:50%; text-Align:center"),r=k("div","background: #f8f7f5; padding:10px; color: #000;"),r.innerHTML=t.message,i.appendChild(r),e.getRootElement().appendChild(i)),t.updateAvailable===!0,t&&t.allowOrdnanceSurvey&&t.logOSServiceUriFormat){function w(){e.getCredentials(function(n){ui.getObjectAsyncWithNoJsonso(t.logOSServiceUriFormat.replace(/{credentials}/,n),function(){})})}if(e.getImageryId()==="OrdnanceSurvey")b.dispatch(w);else{function nt(){e.getImageryId()==="OrdnanceSurvey"&&(s&&(n.removeHandler(s),s=null),b.dispatch(w))}s=n.addHandler(e,"imagerychanged",nt)}}}function cr(t){for(var i=w.length;i--;)w[i][1]=n.addHandler(t,w[i][0],function(){var t=w[i][0];return function(i){n.invoke(e,t,i)}}());y(h).add_event("mouseenter",function(t){n.invoke(e,"mouseover",new vi(e,ni.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),y(h).add_event("mouseleave",function(t){n.invoke(e,"mouseout",new vi(e,ni.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function ai(){for(var t,i=w.length;i--;)t=w[i][1],t&&n.removeHandler(t),w[i][1]=null;y(h).remove_event("mouseenter",function(t){n.invoke(e,"mouseover",new vi(e,ni.map,e,"mouseover",t.clientX,t.clientX,0,!1,t))}),y(h).remove_event("mouseleave",function(t){n.invoke(e,"mouseout",new vi(e,ni.map,e,"mouseout",t.clientX,t.clientX,0,!1,t))})}function yi(){return k("div","z-index:0;position:absolute;left:50%;top:50%;"+u.safariRenderHack,h)}function pi(n,t){n>0&&t>0?(g.stopMonitoring(),at=!1,h.style.cssText=or.replace("{width}",n).replace("{height}",t),bi(n,t)):(h.style.cssText=er,at=!0,g.startMonitoring(),g.poll())}function bi(t,i){t=Math.round(Math.max(1,t)),i=Math.round(Math.max(1,i)),(t!==vt||i!==pt)&&(vt=t,pt=i,lr(t,i),n.invoke(e,"resize"))}function lr(n,t){setTimeout(function(){var i=y(h);t<100||n<240?i.add_class("miniscule"):(n>=240&&n<320?i.remove_class("medium large").add_class("verySmall"):n>=320&&n<600?i.remove_class("verySmall large").add_class("medium"):i.remove_class("verySmall medium").add_class("large"),i.remove_class("miniscule"))},1)}function ar(n){at&&bi(n.width,n.height)}function d(){var n,t;wt&&(n=v.get_absolute_pos(),et=n.x,st=n.y,t=gt.get_absolute_pos(),nt=t.x,tt=t.y,wt=!1,oi&&b.dispatch(nr))}function nr(){wt=!0}function tr(n){for(var t in p)if(p.hasOwnProperty(t)&&p[t].getMode()===n)return p[t];return null}function pr(t){if(o!=t){var i=o,r=tr(i),u=tr(t),f="MapTypeId_";t.activating&&t.activating(e,{credentials:si}),i&&i.deactivating&&i.deactivating(),ai(),o=t,it=null,r&&v.remove_class(f+r.getMapTypeId()),i&&i.deactivated&&i.deactivated(),u&&v.add_class(f+u.getMapTypeId()),cr(t),t.activated&&t.activated(),n.invoke(e,"modechanged"),n.invoke(e,"imagerychanged"),n.invoke(e,"copyrightchanged")}}function ii(n){var t,i;return wi!==e?!1:(t=n.target,t&&(i=t.tagName,i==="INPUT"&&(t.type==="text"||t.type==="search")||i==="TEXTAREA"||i==="SELECT"))?!1:!0}function ri(t,i){if(n.hasHandler(e,t)){var r=new vr(t,i.keyCode,i.altKey,i.ctrlKey,i.shiftKey,i.charCode);r.originalEvent=i,n.invoke(e,t,r)}}function ir(n){ii(n)&&ri("keydown",n)}function ur(n){ii(n)&&ri("keyup",n)}function fr(n){ii(n)&&ri("keypress",n)}var w;PRF.start("mapobj");var e=this,c=new fu(this),ft=r,h,at=!0,fi=window.top==window.self,vt,pt,et,st,nt,tt,g,ei="z-index:0;overflow:hidden;direction: ltr !important;background-color:"+(f&&f.backgroundColor?yt.clone(f.backgroundColor).toHex()+";":"#F4F2EE;");var er=ei+(y.Browser.is_in_quirks_mode?"position:absolute;top:0;left:0;width:100%;height:100%":"position:absolute;left:0;top:0;right:0;bottom:0"),or=ei+"position:relative;width:{width}px;height:{height}px",oi=!0,wt=!0,ht,bt,ct={min:t.minMercatorZoom,max:t.maxMercatorZoom},it=null,l,kt,gt,v,ti,o=null,si,p=[],lt=null,rt=null,a={width:null,height:null,disableUserInput:!1,disableKeyboardInput:!1,disableMouseInput:!1,disableTouchInput:!1,disableZooming:!1,disablePanning:!1,labelOverlay:ut.visible,useInertia:!0,inertiaIntensity:-1,tileBuffer:0,showBackground:null,pinFocusBehavior:yr.highlight},hi=new gi,ci={};this.addComponent=function(t,i){ci[t]=i,n.invoke(e,"componentadded",{componentName:t,component:i})},this.getComponent=function(n){return ci[n]},this.getCredentials=function(n){c?c.getCredentials(n):typeof n=="function"&&n(null)},this.getWidth=function(){return vt},this.getHeight=function(){return pt},this.getPageX=function(){return d(),et},this.getPageY=function(){return d(),st},this.getViewportX=function(){return d(),nt},this.getViewportY=function(){return d(),tt},this.getTheme=function(){return rt},this.focus=function(){a.disableUserInput||a.disableKeyboardInput||(l&&(l.offsetWidth>0||l.offsetHeight>0)&&fi?l.focus():window.focus(),wi!==e&&(wi&&wi.blur(),l&&ti.add_event("keydown",ir).add_event("keypress",fr).add_event("keyup",ur),wi=e,n.invoke(e,"focus")))},this.blur=function(){if(l){try{l.blur()}catch(t){}ti.remove_event("keydown",ir).remove_event("keypress",fr).remove_event("keyup",ur)}wi===e&&(n.invoke(e,"blur"),wi=null)},this.getRootElement=function(){return h},this.getModeLayer=function(){return ht},this.getUserLayer=function(){return bt},this.updateMapPosition=nr,this.dispose=function(){if(e){n.invoke(e,"ondispose",null),c.dispose(),e.blur(),e.entities.clear(),o&&o.deactivating&&o.deactivating(),ai(),o&&o.deactivated&&o.deactivated(),o=null,p.length=0,g.stopMonitoring(),g=null,v.remove_event("mousedown",e.focus).remove_event("touchstart",e.focus),ft.removeChild(h),h=null,ft=null,ht=null,bt=null,kt=null,gt=null,v=null,c=null;for(var t=di.length;t--;)di[t]===e&&di.splice(t,1);e=null}},this.setView=function(t){var i,r,u;e.setOptions(t),t.mapTypeId&&(i=p[t.mapTypeId],i!==lt&&(this.entities=hi,r=o,u=null,r&&(u=r.getCenter()),i.activating(),lt=i,pr(i.getMode()),i.activated(),n.invoke(e,"maptypechanged"),t.center||t.bounds||!u||r===o||(t.center=u,t.animate==null&&(t.animate=!1)))),o.setView(t)},this.setOptions=function(t){var i,r=!1;for(i in t)a[i]!==s&&t[i]!==s&&a[i]!==t[i]&&(a[i]=t[i],r=!0);r&&(a.width!==s&&a.height!==s&&pi(a.width,a.height),n.invoke(e,"optionschanged"))},this.getOptions=function(){return tu(a)},this.getCenter=function(){return o.getCenter()},this.getZoom=function(){return o.getZoom()},this.getZoomRange=function(){return it||(it={min:Math.max(t.minMercatorZoom,o.getInternalMinZoom(),ct.min),max:Math.min(t.maxMercatorZoom,o.getInternalMaxZoom(),ct.max)}),it},this.restrictZoom=function(n,i){if(n>i)throw"min zoom cannot be greater than max zoom";ct.min=n||t.minMercatorZoom,ct.max=i||t.maxMercatorZoom,it=null},this.getHeading=function(){return o.getHeading()},this.getRequestedHeading=function(){return o.getRequestedHeading()},this.getBounds=function(){return o&&o.getBounds()},this.getMetersPerPixel=function(){return o.getMetersPerPixel()},this.getTargetCenter=function(){return o.getTargetCenter()},this.getTargetZoom=function(){return o.getTargetZoom()},this.getTargetHeading=function(){return o.getTargetHeading()},this.getTargetBounds=function(){return o.getTargetBounds()},this.getTargetMetersPerPixel=function(){return o.getTargetMetersPerPixel()},this.tryLocationToPixel=function(n,t,i){var r,u,f,e,s;if(!o.tryLocationToViewport)return null;if(r=o.tryLocationToViewport(n,i),r&&t){u=0,f=0;switch(t){case li.page:d(),u=nt,f=tt;break;case li.control:d(),u=nt-et,f=tt-st}if(u||f)if(ki(r))for(s=r.length;s--;)e=r[s],e&&(e.x+=u,e.y+=f);else r.x+=u,r.y+=f}return r},this.tryPixelToLocation=function(n,t,r){var s,u,f,e;if(!o.tryViewportToLocation)return null;if(s=n,t){u=0,f=0;switch(t){case li.page:d(),u=nt,f=tt;break;case li.control:d(),u=nt-et,f=tt-st}if(u||f)if(ki(n))for(e=n.length,s=new Array(e);e--;)s[e]=new i(n[e].x-u,n[e].y-f);else s=new i(n.x-u,n.y-f)}return o.tryViewportToLocation(s,r)},this.isDownloadingTiles=function(){return o&&o.isDownloadingTiles?o.isDownloadingTiles():!1},this.getTileDownloadMetrics=function(){return o&&o.getTileDownloadMetrics?o.getTileDownloadMetrics():0},this.getImageryId=function(){return o&&o.getImageryId?o.getImageryId():""},this.isMercator=function(){return o.isMercator?o.isMercator():!1},this.isRotationEnabled=function(){return o.isRotationEnabled()},this.getCopyrights=function(n){return o&&o.getCopyrights&&o.getCopyrights(n),[]},this.getMode=function(){return o.getPublicApi?o.getPublicApi():{}},this.setMapType=function(n){this.setView({mapTypeId:n})},this.getMapTypeId=function(){return lt?lt.getMapTypeId():""},this.registerMapType=function(n){var t=n.getMapTypeId();if(p[t])throw"InvalidOperation: already registered";p.push(n),p[t]=n},this.entities=hi,w=[["viewchangestart",null],["viewchange",null],["viewchangeend",null],["targetviewchanged",null],["imagerychanged",null],["copyrightchanged",null],["tiledownloadcomplete",null],["click",null],["dblclick",null],["rightclick",null],["mousedown",null],["mouseup",null],["mousemove",null],["mousewheel",null]],sr(),di.push(e),PRF.end("MapObject instantiated","mapobj")}function hi(n,t){var i=n,r=t;this.getMapTypeId=function(){return i},this.getMode=function(){return r},this.activating=function(){},this.activated=function(){}}function vi(n,t,i,r,u,f,e,o,s){var h=n;this.pageX=u,this.pageY=f,this.eventName=r,this.targetType=t,this.target=i,this.wheelDelta=e,this.isTouchEvent=o,this.originalEvent=s,this.isPrimary=s.which===1,this.isSecondary=s.which===3,this.getX=function(){return this.pageX-h.getViewportX()},this.getY=function(){return this.pageY-h.getViewportY()}}function vr(n,t,i,r,u,f){this.eventName=n,this.keyCode=t,this.charCode=f,this.altKey=i,this.ctrlKey=r,this.shiftKey=u,this.originalEvent={}}function yt(n,t,i,r){this.a=n,this.r=t,this.g=i,this.b=r}function gi(t){function s(t){t.collection||(t.collection=r),n.invoke(r,"entitychanged",t)}function h(t){n.invoke(r,"entityadded",t)}function c(t){n.invoke(r,"entityremoved",t)}function e(t,i){var e=f.length;if(!t[u])for(t[u]=[];e--;)t[u].push(n.addHandler(t,f[e][0],f[e][1]));n.invoke(r,"entityadded",{collection:r,entity:t,index:i})}function o(t){if(t){for(var i=f.length;i--;)n.removeHandler(t[u][i]);delete t[u],n.invoke(r,"entityremoved",{collection:r,entity:t})}}var r=this,u="_ech"+pi.getNext(),f=[["entityadded",h],["entityremoved",c],["entitychanged",s]],i;this._eventsHandlers=f,i=[],this.get=function(n){return i[n]},this.getLength=function(){return i.length},this.push=function(n){i.push(n),e(n,i.length)},this.insert=function(n,t){i.splice(t,0,n),e(n,t)},this.pop=function(){var n=i.pop();return o(n),n},this.removeAt=function(n){var t=i[n];return i.splice(n,1),o(t),t},this.remove=function(n){for(var r=null,t=i.length;t--;)if(i[t]===n){r=this.removeAt(t);break}return r},this.clear=function(){while(i.length>0)this.pop()},this.indexOf=function(n){for(var t=i.length;t--;)if(i[t]===n)break;return t},this.setOptions(t)}function ru(n,t){this._location=n,this.setOptions(t,!1)}function d(n,t){d.baseConstructor.call(this,n,t),this.setOptions(t)}function nr(n,i){this._location=n,i&&typeof i.useTransform3d=="boolean"&&(this._useTransform3d=i.useTransform3d),this._icon=t.pushpinImageUrl,this.setOptions(i)}function tr(n,t){this._locations=n,this.setOptions(t)}function ir(n,t){this._locations=n,this.setOptions(t)}function ar(t){var u=this,f=!0,e=0,o=1,h={},c=fr.high,l=pr.auto,a=!0,i=1e4,v,r;this.setOptions=function(t){if(t){var r=!1;typeof t.visible=="boolean"&&(f=t.visible,r=!0),typeof t.reproject=="boolean"&&(a=t.reproject,r=!0),oi(t.tileDownloadPriority)&&(c=t.tileDownloadPriority,r=!0),oi(t.zIndex)&&(e=t.zIndex,r=!0),oi(t.opacity)&&(o=t.opacity,r=!0),t.animationDisplay&&(l=t.animationDisplay,r=!0),t.downloadTimeout!==s&&(i=t.downloadTimeout,(typeof i!="number"||i<=0)&&(i=1e4),r=!0),r&&n.invoke(u,"entitychanged",{entity:u})}},v=typeof ft!="undefined"?ft:{mercator:{}};for(r in v)t[r]instanceof wr&&(h[r]=t[r]);this.getVisible=function(){return f},this.getZIndex=function(){return e},this.getOpacity=function(){return o},this.getAnimation=function(){return l},this.getReproject=function(){return a},this.getDownloadTimeout=function(){return i},this.getTileSource=function(n){return h[n]},this.getTileDownloadPriority=function(){return c},this.setOptions(t)}function wr(n){var u=t.defaultTileSize,f=t.defaultTileSize,i,r;isFinite(n.width)&&(u=n.width),isFinite(n.height)&&(f=n.height),typeof n.uriConstructor=="string"?(i=n.uriConstructor,r=n.uriConstructor):(typeof n.uriConstructor=="function"&&(i=n.uriConstructor),typeof n.uriFormat=="string"&&(r=n.uriFormat)),this.getWidth=function(){return u},this.getHeight=function(){return f},this.getUriConstructor=function(){return i},this.getUriFormat=function(){return r}}function fu(n){this._map=n,this.dispose=function(){this._map=null}}function wu(t){function l(){f=n.addHandler(r,"ondispose",h),tt.load(e,{callback:function(){o.Analytics&&o.Analytics.AnalyticsManager&&r&&(s=!0,u=new o.Analytics.AnalyticsManager(r))}})}function i(n,t){u?u[n].apply(u,t):!s&&r&&tt.add(e,c,n,t)}function h(){i("dispose",arguments),u=r=null,n.removeHandler(f),f=null}var c=this,e="Microsoft.Maps.Analytics",r=t,f=null,u=null,s=!1;this.logClientAction=function(){i("logClientAction",arguments)},this.beginBatchedAction=function(){i("beginBatchedAction",arguments)},this.logBatchedEvent=function(){i("logBatchedEvent",arguments)},this.computeTotalDuration=function(){i("computeTotalDuration",arguments)},this.endBatchedAction=function(){i("endBatchedAction",arguments)},this.addPreProcessor=function(){i("addPreProcessor",arguments)},this.removePreProcessor=function(){i("removePreProcessor",arguments)},this.registerAction=function(){i("registerAction",arguments)},this.registerChildActions=function(){i("registerChildActions",arguments)},this.enable=function(){i("enable",arguments)},this.dispose=h,l()}function r(n,t,i){this.x=n,this.y=t,this.z=i}function pt(n,t){this.width=n,this.height=t}function ct(n,t,i,r){this.x=n,this.y=t,this.width=i,this.height=r}function wt(n,t,i,r,u,f){this.m11=n,this.m12=t,this.m21=i,this.m22=r,this.offsetX=u,this.offsetY=f}function e(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.m11=n,this.m12=t,this.m13=i,this.m14=r,this.m21=u,this.m22=f,this.m23=e,this.m24=o,this.m31=s,this.m32=h,this.m33=c,this.m34=l,this.offsetX=a,this.offsetY=v,this.offsetZ=y,this.m44=p}function fi(n,t,i,r){this.a=n,this.b=t,this.c=i,this.d=r}function ti(n,t){this.x=n,this.y=t}function it(n,t,i){this.levelOfDetail=n,this.x=t,this.y=i}function f(n,u,o,h,l,a,y,p,w,b){function tt(){var l,s,b,p;if(!ni){ft=h===0&&ot===-90&&a===0,st=ft||ct<=et,at=st&&ft?f.simpleGround:fi.fromNormal(rt,it.getUpVector(rt));var n=f.simpleWorldToFrustumNoZ,i=1/g,u=g*1e3;if(ut=it.getNadirMatrix(rt),ft||(ut=e.multiply(ut,e.rotationZ(-pt),e.rotationX(-(ot+90)),e.rotationZ(-lt))),st)ft?(n.m22=n.m11=i,n.m33=i*-.001,n.offsetX=ut.offsetX*i,n.offsetY=ut.offsetY*i):n=e.multiply(ut,e.scaling(i,i,1/u));else{var y=Math.pow(2,wt)*g,o=1/ct,w=o/y;u=Math.min(o*.99,u),l=o-u,s=o+u,n=e.multiply(ut,e.translation(bt),e.translation(0,0,o),new e(w,0,0,0,0,w,0,0,0,0,s/(s-l),1,0,0,l*s/(l-s),0),e.scaling(y/g,y/g,1)),b=n.transform(rt),n.multiplyBy(e.translation(r.multiply(b,-1)))}ft?ht=n.clone():(vt=n.invert().projectOnPlane(at),ht=vt.invert()),ft?(k=ht.clone(),k.m11*=d,k.m22*=d,k.m33*=d,k.offsetX*=d,k.offsetY*=d,p=g/d,nt=ut.clone(),nt.m11*=p,nt.m22*=p,nt.m33*=u/d,nt.offsetX*=-1,nt.offsetY*=-1):(k=e.multiply(ht,e.scaling(d)),nt=k.invert()),yt=it.toLocation(rt),kt=f.widthToMercatorZoom(g,it,rt),dt=it.unitsToMeters(rt,g)/t.zoomOriginWidth,gt=!st||Math.abs(ot+90)>et||it!==c,ni=!0}}var ti=this;var it=n,rt=u,g=o,pt=h||0,ot=l===s?-90:l,lt=a||0,ct=y||0,wt=p||0,bt=w||new r(0,0,0),ft,st,at,ut,ht,vt,k,nt,yt,kt,dt,gt,d=b||t.zoomOriginWidth,ni=!1;this.getCrs=function(){return it},this.getLookAt=function(){return rt},this.getWidth=function(){return g},this.getHeading=function(){return pt},this.getPitch=function(){return ot},this.getRoll=function(){return lt},this.getDistanceInverse=function(){return ct},this.getZoomDelta=function(){return wt},this.getPerspectiveOrigin=function(){return bt},this.getZoomOriginWidth=function(){return d},this.getGroundPlane=function(){return tt(),this.getGroundPlane=function(){return at},at},this.getWorldToViewport=function(){return tt(),this.getWorldToViewport=function(){return k},k},this.getViewportToWorld=function(){return tt(),this.getViewportToWorld=function(){return nt},nt},this.getWorldToFrustum=function(){return tt(),this.getWorldToFrustum=function(){return ht},ht},this.getFrustumToWorld=function(){return tt(),this.getFrustumToWorld=function(){return vt},vt},this.getCenter=function(){return tt(),this.getCenter=function(){return yt},yt},this.getMercatorZoom=function(){return tt(),this.getMercatorZoom=function(){return kt},kt},this.getMetersPerPixel=function(){return tt(),this.getMetersPerPixel=function(){return dt},dt},this.getNeedsElevation=function(){return tt(),this.getNeedsElevation=function(){return gt},gt},this.getAlignedCamera=function(n,t,r,u){var s,l;tt();var v=g/Math.pow(2,n),o,h=null,c=0,a=null;return t?(o=t,st||(a=e.multiply(ut,e.translation(bt)),h=a.transform(o),c=n+wt)):o=rt,s=pt,u&&(s=s+u),c=0,l=new f(it,o,v,s,ot,lt,ct,c,h,d),r&&(o=l.getViewportToWorld().transform(new i(-r.x,-r.y)),st||(h=a.transform(o)),l=new f(it,o,v,s,ot,lt,ct,c,h,d)),l}}function yi(n){var u=this,f=n,e=2,i=p+"count",t=[{}],r;t[0][i]=0,this.get=function(n,i){for(var r,f=t.length,e=!0;f--;){if(r=t[f][n],r!==s)return i&&!e&&u.insert(n,r),r;e=!1}},this.insert=function(n,o){var a,h,l,c,v;if(a=!1,h=t[t.length-1],h[n]===s){if(h[i]<f)h[i]++;else if(h={},h[i]=0,t.push(h),t.length>e&&(l=t.shift(),r))for(c in l)c!==i&&l.hasOwnProperty(c)&&(v=l[c],v!==u.get(c)&&r(v))}else a=!0;return h[n]=o,a},this.useDisposer=function(n){r=n}}function lt(n,t,i,r,u){this.nativeCamera=n,this.maxLocalZoom=i,this.minLocalZoom=0,this.tilePyramid=t,this.imageryId=r,this.copyrightProvider=u,this.needsElevation=n.getNeedsElevation()||t&&t.projectingCamera&&t.projectingCamera.getNeedsElevation()}function bt(){function kr(){var n=p.getOptions();return!(n.disablePanning||n.disableMouseInput||n.disableUserInput)}function dr(){n.invoke(h,"copyrightchanged")}function fr(n,i){var u;if(!i||!f.areEqual(e,n)){if(si&&(n=ot.adjustCameraElevation(n)),e=n,st=n,u=!1,ur<1/t.maxFPS&&(i=!1),i&&(st=f.snapSmallDifferences(ot.adjustCameraElevation(a),e),f.areEqual(st,e)&&(i=!1),i)){var r=new pt(o.width*1.2,o.height*1.2),s=ct.union(nt.getMercatorFootprint(st,r)),c=ct.union(nt.getMercatorFootprint(e,r));ct.intersect(s,c)||(i=!1)}i?(at=new Date(new Date-(h.usingCssAnimation()?0:au)),it(),i!=!0&&(bt=i)):(at=new Date(0),g=null,vi())}}function li(t,i,u,o,s,l,a){var y,g,k,ut=p.getZoomRange(),tt=i,b=f.widthToMercatorZoom(o,t,i),ft,v,rt,et,nt,w,st,ht;for(b=Math.max(b,ut.min),b=Math.min(b,ut.max),ft=2,si=!1;ft--;){for(g=t.toLocation(tt),v=null,rt=yt.length;rt--;)if(v=yt[rt].getScene(d,g.latitude,g.longitude,b,s,di),v&&v.needsElevation&&(et=ot.isElevationAvailableAtLatLon(g.latitude,g.longitude,b),si=!0,et||(v=null)),v)break;if(v=v||hr,v=ti?d:v,k&&y===v)break;if(y=v,nt=y.nativeCamera,w=b-f.widthToMercatorZoom(nt.getWidth(),nt.getCrs(),nt.getLookAt()),pr&&(w=a?Math.floor(w):Math.round(w)),w=Math.min(w,y.maxLocalZoom),w=Math.max(w,y.minLocalZoom),k=y.nativeCamera.getAlignedCamera(w,i,u),r.areAlmostEqual(tt,k.getLookAt()))break;tt=k.getLookAt()}(or(si),l&&f.areEqual(e,k)&&y===d)||(st=y.imageryId!==d.imageryId,ht=y!==d,d=y,fr(k,l),it(),ht&&(n.invoke(h,"scenechanged"),dr()),st&&n.invoke(h,"imagerychanged"))}function ni(){var n=ot.adjustCameraElevation(e);li(n.getCrs(),n.getLookAt(),null,n.getWidth(),vt!=null?vt:n.getHeading(),!0)}function vi(){var p,v,t,tt;if(b.cancelDispatch(vi),yi&&!ai){ai=!0;var s=!1,y=!0,c=!0,i,l;ft.processPendingUserInput(),pt.areEqual(cr,o)||(i=!0,l=!0),cr=o,tr&&(i=!0,l=!0,c=!1,tr=!1),at&&(p=a,v=gr(),e.getMercatorZoom()>st.getMercatorZoom()?v<yu&&(y=!1):v<vu&&(y=!1),v<=1?(a=nu(v),s=!0):(t=e.getLookAt(),dt&&(t=e.getCrs().wrap(t)),t.y<0?t.y=0:t.y>1&&(t.y=1),r.areAlmostEqual(e.getLookAt(),t)||(c=!1,e=e.getAlignedCamera(0,t)),a=e,st=e,at=null),f.areAligned(p,e)||(c=!1),i=!0),w.allowTileGridSwitch=y;var k=!nr&&i,u=nr&&!i,nt=new Date;u&&nt-wr<=br&&(u=!1,s=!0),nr=i||s,i&&(wr=nt,s=!0),f.areEqual(yr,e)||(l=!0),(l||u)&&((u||!w.canCssAnimate())&&(g=null),!h.usingCssAnimation()&&ri&&(er(),ri=!1),w.enableOrDisableCssAnimation(g,u),kt.enableOrDisableCssAnimation(g)),yr=e,w.render(o,a,d.tilePyramid,e),tt=k?0:u?2:1,kt.update(o,a,e,c,tt),l&&n.invoke(h,"targetviewchanged"),k&&n.invoke(h,"viewchangestart"),i&&n.invoke(h,"viewchange",{linear:c,userInitiated:ci}),u&&(n.invoke(h,"viewchangeend",{userInitiated:ci}),ci=!0,dr()),ai=!1,s&&it()}}function gr(){var n=0,t;return h.usingCssAnimation()?n=g.getStartTime()<at?0:g.getElapsedTimeAsPercentage():(t=new Date,n=bt>0?Math.min(1,(t-at)/bt):(t-at)/1e3/ur),n}function nu(n){var i=a,t=0;return h.usingCssAnimation()?t=g.getProgress(n):bt>0?(n>=1&&(bt=0),t=1-Math.pow(1-n,4)):t=n<=.5?Math.pow(n*2,2)*.5:Math.pow((1-n)*2,2)*-.5+1,t>=0&&t<=1&&(i=f.lerp(st,e,t)),i}function tu(){if(p){var n=p.getWidth(),t=p.getHeight();(o.width!==n||o.height!==t)&&(o=new pt(p.getWidth(),p.getHeight()),it())}}function it(){b.dispatch(vi)}function iu(n){n&&w.suspendGettingNewTiles(),ti=!0}function er(){w.allowGettingNewTiles(),ti&&(ti=!1,ni(),it())}function ru(n){var t=n.getViewportToWorld(),r=n.getCrs(),u=uu(r.toLocation(t.transform(new i(-o.width/2,-o.height/2))),r.toLocation(t.transform(new i(o.width/2,-o.height/2))),r.toLocation(t.transform(new i(o.width/2,o.height/2))),r.toLocation(t.transform(new i(-o.width/2,o.height/2))));return u.center=new v(u.center.latitude,u.center.longitude),u}function uu(){for(var f=arguments,t,i,r,u,e,o,n,h=f.length;h--;)n=f[h],isFinite(n.latitude)&&isFinite(n.longitude)&&(t=t===s||isNaN(t)?n.latitude:Math.max(t,n.latitude),i=i===s||isNaN(i)?n.latitude:Math.min(i,n.latitude),u=u===s||isNaN(u)?n.longitude:Math.max(u,n.longitude),r=r===s||isNaN(r)?n.longitude:Math.min(r,n.longitude),isFinite(n.altitude)&&ht.isValid(n.altitudeReference)&&(o=n.altitude,e=n.altitudeReference));return rt.fromEdges(t,r,i,u,o,e)}function pu(n){return f.areEqual(n.nativeCamera,lt.nativeMercatorCamera)}function fu(){var t,n;tt=p.getOptions(),ft.enableOrDisableUserInput(!0,tt),t=.9,tt.inertiaIntensity!==s&&tt.inertiaIntensity!==-1&&(t=tt.inertiaIntensity),ft.enableOrDisableInertialScrolling(tt.useInertia,t),n=tt.labelOverlay,n!==di&&ut.isValid(n)&&(di=n,ni()),tt.showBackground!==s&&w.showBackground(tt.showBackground),w.setBufferSize(tt.tileBuffer)}function or(t){t?gt||(gt=n.addThrottledHandler(h,"targetviewchanged",eu,500),b.dispatch(eu)):(su(),n.removeHandler(gt),gt=null)}function eu(){gt&&(su(),ei=ot.downloadElevationData(e,o),ei&&(ir=n.addHandler(ei,"downloaded",wu)))}function su(){n.removeHandler(ir),ir=null,ot.cancelDownload(ei)}function wu(n){tr=!n.cacheHit,ni(),it()}var h=this,yi=!1,hu="cm"+pi.getNext(),p=null,wt=null,wi=null,bi=null,ft=null,hr=lt.createMercatorScene(null,"Mercator",null),d=hr,a=d.nativeCamera,e=a,st,vt,ti,ri,bu=k(null,u.safariRenderHack),yt=[],ui=[],di=ut.visible,at,bt=0,gi=!1,g=null,o=new pt(800,600),cr,w=new ou,ai;n.addHandler(w,"tiledownloadcomplete",function(){n.invoke(h,"tiledownloadcomplete")});var lr,kt=new sr,ar=!1,vr=!1,nr=!1,yr,tr=!1,fi,tt,dt=!0,pr=!0,gt,ei,ir,si,hi,rr={Grab:"url("+t.cursorPath+"grab.cur)"+u.cursorHotspot+", move",Grabbing:"url("+t.cursorPath+"grabbing.cur)"+u.cursorHotspot+", move",SEResize:"se-resize"},au=1e3/30,ur=.3,vu=.1,yu=.4,wr=new Date(0),br=200,ci=!0;this.activating=function(t){p=t,fi=n.addHandler(t,"resize",tu),tu()},this.activated=function(){wt=p.getModeLayer(),wi=p.getRootElement(),bi=y(wi),wt.appendChild(w.getRootElement()),lr=k("div","position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack,wt),kt.activate(p,h,w,lr,hu+"_er"),ft=new cu(h,p,new lu(h,p),bi,kt,!0),fu(),n.removeHandler(hi),hi=n.addHandler(p,"optionschanged",fu),or(d.needsElevation),yi=!0,it()},this.deactivating=function(){n.removeHandler(hi),hi=null,or(!1),n.removeHandler(fi),fi=null,ft.enableOrDisableUserInput(!1,tt),fr(e,!1),kt.deactivate(),wt.removeChild(w.getRootElement()),w.disposeTiles(),ft=null,bi=null,wi=null,wt=null,p=null,yi=!1},this.getInternalMaxZoom=function(){return t.maxMercatorZoom},this.getInternalMinZoom=function(){return t.minMercatorZoom},this.setView=function(n){var p=e.getCrs(),w,t,g=null,i=n.bounds,tt=!1,it;if(n.userInitiated===!1&&(ci=n.userInitiated),i instanceof rt){if(n.center){t=n.center;var r=i.getNorthwest(),ft=new v(t.latitude*2-r.latitude,t.longitude*2-r.longitude,r.altitude,r.altitudeReference),a=i.getSoutheast(),et=new v(t.latitude*2-a.latitude,t.longitude*2-a.longitude,a.altitude,a.altitudeReference);i=uu(r,a,ft,et)}else t=p===c?nt.getMercatorCenter(i):i.center.clone();it=oi(n.padding)?new pt(Math.max(1,o.width-n.padding),Math.max(1,o.height-n.padding)):o,w=nt.locationRectToMercatorZoom(it,i),tt=!0}else n.center&&(t=n.center,g=n.centerOffset),oi(n.zoom)&&(w=n.zoom);var y=!1,b=e.getLookAt(),ut=e.getWidth(),k=e.getHeading(),d=!0;t&&(b=p.fromLocation(ot.toEllipsoid(t)),y=!0),oi(w)&&(ut=f.mercatorZoomToWidth(w,p,b),y=!0),oi(n.heading)?(k=l.normalizeDegrees(n.heading),vt=k,y=!0):vt=null,n.animate===!1&&(d=n.animate,y=!0),n.suspend!==s&&(n.suspend?iu(!0):er()),n.useCssAnimations!==s&&(gi=u.allowCssAnimations&&n.useCssAnimations),y&&(d&&h.requestCssAnimation(),li(p,b,g,ut,k,d,tt))},this.setWrapping=function(n){dt=n},this.getCenter=function(){var n=a.getCenter();return new v(n.latitude,n.longitude)},this.getZoom=function(){return a.getMercatorZoom()},this.getHeading=function(){return a.getHeading()},this.getRequestedHeading=function(){return vt},this.getBounds=function(){return ru(a)},this.getMetersPerPixel=function(){return a.getMetersPerPixel()},this.getTargetCenter=function(){var n=e.getCenter();return new v(n.latitude,n.longitude)},this.getTargetZoom=function(){return e.getMercatorZoom()},this.getTargetHeading=function(){return e.getHeading()},this.getTargetBounds=function(){return ru(e)},this.getTargetMetersPerPixel=function(){return e.getMetersPerPixel()},this.tryLocationToViewport=function(n,t){return this.internalTryLocationToViewport(a,n,t&&t.referenceLocation)},this.tryViewportToLocation=function(n,t){return this.internalTryViewportToLocation(a,n,!0,!t||t.normalizeLongitude!==!1)},this.internalTryLocationToViewport=function(n,t,i){var u,f,o=n.getCrs(),h=n.getWorldToViewport(),y=n.getDistanceInverse()<et,a=!n.getNeedsElevation(),c=n.getLookAt();if(t.latitude!==s)return u=o.fromLocation(ot.toEllipsoid(t,a)),dt&&(u=o.wrap(u,c)),f=h.transform(u),y||f.z>=-1&&f.z<=1?f:null;var e=t.length,l=new Array(e),p=null;if(!n.getPerspectiveOrigin().isZero()){var w=n.getViewportToWorld(),b=new r(0,n.getZoomOriginWidth()*6,0),v=w.transform(b),k=v.x*h.m14+v.y*h.m24+v.z*h.m34+h.m44;p=k}for(i&&(u=o.fromLocation(ot.toEllipsoid(i,a)),dt&&(c=i=o.wrap(u,c)));e--;)u=o.fromLocation(ot.toEllipsoid(t[e],a)),dt&&(u=o.wrap(u,c)),c=i||u,f=h.transform(u,p),l[e]=y||f.z>=-1&&f.z<=1?f.toPoint():null,l[e]&&(l[e].shouldUseMoveTo=t[e].shouldUseMoveTo);return l},this.internalTryViewportToLocation=function(n,t,i,u){var s=n.getCrs(),h=n.getViewportToWorld(),f,e,o,c;if(ki(t)){for(o=t.length,c=new Array(o);o--;)f=h.transform(t[o]),i&&(f=ot.rayToGround(s,f,h.transform(new r(t[o].x,t[o].y,1)))),e=s.toLocation(f),e=new v(e.latitude,u!==!1?v.normalizeLongitude(e.longitude):e.longitude),c[o]=s.toLocation(f);return c}return f=h.transform(t),i&&(f=ot.rayToGround(s,f,h.transform(new r(t.x,t.y,1)))),e=s.toLocation(f),new v(e.latitude,u!==!1?v.normalizeLongitude(e.longitude):e.longitude)},this.isDownloadingTiles=function(){return w.isDownloadingTiles()},this.getTileDownloadMetrics=function(){return w.getTileDownloadMetrics()},this.getImageryId=function(){return d.imageryId?d.imageryId:""},this.isRotationEnabled=function(){return d.imageryId==="EnhancedBirdseye"||d.imageryId==="NativeBirdseye"},this.isMercator=function(){return pu(d)},this.getCopyrights=function(n){return n&&d.copyrightProvider?d.copyrightProvider.getCopyrights(h.getBounds(),a.getMercatorZoom(),a.getHeading(),n):n&&n([]),[]},this.setSceneContributors=function(t){for(var i=ui.length;i--;)n.removeHandler(ui[i]);for(ui.length=0,i=t.length,yt.length=i;i--;)yt[i]=t[i],ui.push(n.addHandler(yt[i],"newsceneavailable",ni));yt.sort(function(n,t){return n.priority-t.priority}),it(),ni()},ai=!1,this.ensureUpdateDispatched=function(n){n?vi():it()},this.getTargetCamera=function(){return e},this.getCurrentCamera=function(){return a},this.getCameraAnimationDuration=function(){return ur},this.setAlignedCamera=function(n,t,i,r,u,f,e){vt=null,li(n,t,i,r,u,f,e)},this.setCamera=function(n,t){fr(n,t)},this.allowSceneChanges=function(){er()},this.suspendSceneChanges=function(n){iu(n)},this.requestCssAnimation=function(n){return gi&&(ri=n,g=n?ii.Flicker:ii.Transformer,g=g.duplicate(),g.isFlick=n),g},this.canUseCssAnimations=function(){return gi},this.usingCssAnimation=function(){return g!=null},this.haltCssAnimation=function(){if(h.usingCssAnimation()){var t=gr(),n=nu(t);ri=!1,li(n.getCrs(),n.getLookAt(),null,n.getWidth(),n.getHeading(),!1)}},this.getCursors=function(){var n="default";return{Grab:kr()?rr.Grab:n,Grabbing:kr()?rr.Grabbing:n,SEResize:rr.SEResize}},this.getPublicApi=function(){return{tryPixelToMercatorPoint:function(n){return h.getTargetCamera().getViewportToWorld().transform(n)},setViewChangeEndDelay:function(n){var n=parseInt(n);n>=0&&(br=n)},canReprojectTileLayers:function(){return u.animateOverlayLayers},enableOrDisableZoomLevelSnap:function(n){pr=n===!0,ft.setTouchZoomThreshold(n===!0?.1:0)},setPartialZoomBias:function(n){w&&w.setPartialZoomBias(Math.min(.5,Math.max(-.5,n)))},setOptions:function(t){var i=!1;t&&(typeof t.shouldClipPolygons=="boolean"&&(vr=t.shouldClipPolygons,i=!0),typeof t.drawShapesInSingleLayer=="boolean"&&(ar=t.drawShapesInSingleLayer,i=!0),i&&n.invoke(p,"modeoptionschanged"))},setDrawShapesInSingleLayer:function(n){this.setOptions({drawShapesInSingleLayer:n})},getDrawShapesInSingleLayer:function(){return ar},getShouldClipPolygons:function(){return vr}}}}function at(n,t,i,r){function c(n){return((s*n+e)*n+u)*n}function l(n){return((h*n+o)*n+f)*n}function a(n){return(3*s*n+2*e)*n+u}function v(n,t){for(var r,u,i=n,f=0;f<9;f++){if(r=c(i)-n,u=a(i),Math.abs(r)<t||Math.abs(u)<1e-6)break;i=i-r/u}return i}var y=this;this.cssText="cubic-bezier("+n+","+t+","+i+","+r+")";var u=3*n,f=3*t,e=3*(i-n)-u,o=3*(r-t)-f,s=1-u-e,h=1-f-o;this.getProgress=function(n,t){return l(v(n,t))}}function bu(n,t,i,r){this.animationSequence=n,this.node=t,this.isComplete=i,this.nodeHasPendingAnimations=r}function eu(n,t){this.url=n,this.timeout=t}function kt(n,t,i,r,u,f,e,o,s,h,c){var v=l.ceilLog2(Math.max(n,t)),a;this.getWidth=function(){return n},this.getHeight=function(){return t},this.getTileWidth=function(){return i},this.getTileHeight=function(){return r},this.getTileOverlap=function(){return u},this.getTileBorder=function(){return f},this.getOffsetX=function(){return e},this.getOffsetY=function(){return o},this.getMaxLevelOfDetail=function(){return v},this.getUrl=s,this.getReplacementTileId=h,a=c?c:7e3,this.getDownloadTimeout=function(){return a}}function or(r,o,s){function or(){if(nt&&nt.length){for(var t=nt.length;t--;)n.removeHandler(nt[t]),bi.removeDownloadBasket(nt[t]);nt=null}}function sr(){var fr=Math.round((c.x+y.x)/2),sr=Math.round((c.y+y.y)/2),l=[],ct=k(),ai,i,pt,e,b,vi,wt,kt,yi,r,f,o,pi,s,tr,hi,ci,br,ur,kr;for(yt=0,ti=0,ut=[],dt=[],gt={},or(),nt=[],wt=0,kt=0,r=c.y;r<=y.y;r++){wt=0,yi=!1;var hr=ot&&ot.y<=r&&st&&st.y>=r,dr=r>=lt.y&&r<=at.y,vr=r>=ft.y&&r<=et.y;for(f=c.x;f<=y.x;f++){ai=new it(c.levelOfDetail,f,r),i=null;var yr=ot&&ot.x<=f&&st&&st.x>=f,gr=f>=lt.x&&f<=at.x,pr=f>=ft.x&&f<=et.x,ui=!1,wr=!1;!si||yr&&hr||pr&&vr||(wr=!0),e=a.getUrl(ai,ii),e&&!wr&&(b=bi.getState(e),b!=vt.failed||ei?(o=gi,pi=0,f===0&&(o-=tt,o+=rt,pi=-rt),f===ir&&(o-=tt,o+=rt),s=nr,tr=0,r===0&&(s-=tt,s+=rt,tr=-rt),r===rr&&(s-=tt,s+=rt),i=k("img"),pt="width:"+o+"px;height:"+s+"px;border:0px;",ri.requireFlowLayout?(wt&&(pt+="margin-left:"+wt*d+"px;"),kt&&(pt+="margin-top:"+kt*g+"px;")):(hi=(f-c.x)*d+pi,ci=(r-c.y)*g+tr,i[p+"leftOffset"]=hi,i[p+"topOffset"]=ci,pt+="position:absolute;",pt+=u.useTransform3d?w.Attributes.transform+":translate3d("+hi+"px,"+ci+"px,0px);":"left:"+hi+"px;top:"+ci+"px"),i.style.cssText=pt,i[p+"tileId"]=ai,i[p+"tileUrl"]=e,i[p+"tileHeight"]=s,i[p+"tileWidth"]=o,i.width=o,i.height=s,i.border=0,ei&&b==vt.failed&&(i=lr(i),ui=i!=!1,i&&(e=i[p+"tileUrl"],b=bi.getState(e))),i&&(b===vt.ready||b===vt.cacheExpired&&(yr&&hr||ui)?(br=pr&&!gr&&vr&&!dr,!br||si||ui?i.src=e:(i.style.visibility="hidden",dt.push(i))):(i.style.visibility="hidden",ut.push(i)),b!=vt.ready&&(vi=new eu(e,er),vi.priority=(fr-f)*(fr-f)+(sr-r)*(sr-r),l.push(vi)),wi.push(i))):v.isOverlay||ti++,yt++),i||ui?(wt=0,yi=!0,i&&(ui?ar(i,ct):ct.appendChild(i))):wt++}yi?(kt=0,ri.requireFlowLayout&&k("br",null,ct)):kt++}if(u.useImageDisposer)for(ur=bt.length;ur--;)bt[ur].src=t.spacerImageUrl;bt.length=0,kr=bt,bt=wi,wi=kr,(u.useTransform3d||u.useTransform2d)&&(fi=this.hideWhileAnimating?ri.setExactTransformOrHide(ht,ni,v.opacity):ri.setTransformAndOpacity(ht,ni,v.opacity,{explicitOpacity:!0})),ct.style.cssText=fi,h.parentNode&&h.parentNode.replaceChild(ct,h),h=ct,oi(),li&&l.length&&(l.basketId=v,l.sort(vu),di+=l.length,nt.push(n.addHandler(l,"hasnewtiles",cr)),bi.setDownloadBasket(l,ii)),ki()}function ki(){dt.length&&b.dispatch(hr),n.invoke(v,"tilesrendered")}function hr(){var t,n;if(b.cancelDispatch(hr),v.allowTileRender)for(t=Math.min(dt.length,vr);t--;)n=dt.shift(),n.style.visibility="visible",n.src=n[p+"tileUrl"];ki()}function cr(){var f;if(li){for(var r=ut.length,u=!0,t=[];r--&&u;){var e=!0,i=ut[r],o=i[p+"tileUrl"],s=bi.getState(o);switch(s){case vt.ready:dt.push(i);break;case vt.failed:ri.requireFlowLayout?u=!1:(h.removeChild(i),yr(i,t));break;default:e=!1}e&&ut.splice(r,1)}u?(ki(),t.length&&(f=n.addHandler(t,"hasnewtiles",cr),nt.push(f),t.basketId=f,bi.setDownloadBasket(t,ii))):sr()}}function yr(n,t){if(!ei){ti++;return}var i=lr(n);i&&(i.style.visibility="hidden",ut.push(i),bt.push(i),t.push(new eu(i[p+"tileUrl"],er)),ar(i,h))}function lr(n){var r=n[p+"tileId"],h=r.toString(),c=gt[h]?gt[h]:1,i=a.getReplacementTileId(n[p+"tileId"]),l=a.getUrl(i,ii),t=!1,f;if(l){if(f=i.toString(),gt[f])t=null;else{var e=Math.pow(2,r.levelOfDetail-i.levelOfDetail),v=n[p+"tileWidth"],y=n[p+"tileHeight"],o=v*e,s=y*e,w=(i.x*e-r.x)*v+n[p+"leftOffset"],b=(i.y*e-r.y)*y+n[p+"topOffset"];t=k("img"),t[p+"leftOffset"]=w,t[p+"topOffset"]=b,t[p+"tileHeight"]=s,t[p+"tileWidth"]=o,t[p+"tileId"]=i,t[p+"tileUrl"]=l,t[p+"lod"]=i.levelOfDetail,t.style.cssText="position:absolute;left:"+w+"px;top:"+b+"px;width:"+o+"px;height:"+s+"px;border:0px;"+u.safariRenderHack,t.width=o,t.height=s,t.border=0,gt[f]=0}gt[f]+=c}else ti+=c;return t}function ar(n,t){for(var i=t.firstChild,u=n[p+"tileId"],r;i;){if(r=i[p+"lod"],!r||r>=u.levelOfDetail){t.insertBefore(n,i);break}i=i.nextSibling}i||t.appendChild(n)}var v=this,ui,oi;var h=k(),c,y,ft,et,lt,at,ot,st,si=!1,hi=0,ci,ni,fi="",di=0,yt=0,ti=0,ei=!1,li=!0,a=r,d,g,tt,rt,gi,nr,wt,ai,vi,tr,ir,rr,yi,pi,ht=e.identity(),ur,fr,bt=[],wi=[],ut=[],dt=[],gt={},nt,vr=3,ii,er=a.getDownloadTimeout();this.levelOfDetail=o,this.opacity=1,this.isOverlay=!1,this.hideWhileAnimating=!1,this.allowTileRender=!0,d=a.getTileWidth(),g=a.getTileHeight(),tt=a.getTileOverlap(),rt=a.getTileBorder(),gi=d+2*tt,nr=g+2*tt,ui=Math.pow(2,a.getMaxLevelOfDetail()-o),wt=Math.ceil(a.getWidth()/ui),ai=Math.ceil(a.getHeight()/ui),wt=Math.ceil(wt),ir=Math.ceil(wt/d)-1,rr=Math.ceil(ai/g)-1,vi=e.multiply(a.projectingCamera.getWorldToFrustum(),e.scaling(wt),e.translation(wt/2+a.getOffsetX()/ui,ai/2+a.getOffsetY()/ui,0)),tr=vi.invert(),s&&(ii=!0),this.populate=function(n,t,r,u){var s,h,w,b;if(!f.areEqual(n,ur)||!pt.areEqual(t,fr)||hi!=r){ur=n,fr=t;var l=e.multiply(n.getViewportToWorld(),vi),a=Math.ceil(t.width/2),v=Math.ceil(t.height/2),p=ct.union(l.transform(new i(-a,-v)),l.transform(new i(a,-v)),l.transform(new i(a,v)),l.transform(new i(-a,v)));s=new it(o,Math.floor(p.x/d),Math.floor(p.y/g)),h=new it(o,Math.floor(p.getRight()/d),Math.floor(p.getBottom()/g)),(!lt||!at||r>hi||lt.x>s.x||lt.y>s.y||at.x<h.x||at.y<h.y)&&(yi=null,si=u,hi=r,lt=s,at=h,ot=ft,st=et,ft=s.clone(),ft.x-=r,ft.y-=r,et=h.clone(),et.x+=r,et.y+=r,c=ft.clone(),y=et.clone(),u&&(c.x=Math.min(ot.x,c.x),c.y=Math.min(ot.y,c.y),y.x=Math.max(st.x,y.x),y.y=Math.max(st.y,y.y)),ci=e.multiply(e.translation(c.x*d,c.y*g,0),tr),w=y.x-c.x+1,b=y.y-c.y+1,ni=new pt(w*d,b*g),sr())}},this.render=function(n,t){var i,r,o;f.areEqual(n,yi)&&pi===v.opacity||(ht=e.multiply(ci.projectOnPlane(n.getGroundPlane()),n.getWorldToViewport()),t&&(ht.offsetX+=t,ht.offsetY+=t),i={explicitOpacity:!this.hideWhiteAnimating},r=this.hideWhileAnimating?ri.setExactTransformOrHide:ri.setTransformAndOpacity,u.useTransform3d||u.useTransform2d?(i.includeCommonCss=!1,i.returnStyleObject=!0,o=r(ht,ni,v.opacity,i),h.style[w.Properties.transform]=o[w.Properties.transform],v.opacity!=pi&&(h.style.opacity=v.opacity)):(fi=r(ht,ni,v.opacity,i),h.style.cssText=fi),oi()),pi=v.opacity,yi=n},this.getRootElement=function(){return h},this.getTilePyramid=function(){return a},this.getDownloadProgress=function(){return yt>0&&ut?1-ut.length/yt:1},this.getTileDownloadMetrics=function(){return di},this.getNoImageTileRatio=function(){return yt>0?ti/yt:0},this.enableOrDisableScaledTiles=function(n){ei=n&&!ri.requireFlowLayout&&!rt&&!tt&&typeof a.getReplacementTileId=="function"},this.stopDownloading=function(){li=!1,bi.removeDownloadBasket(v)},this.dispose=function(){v.stopDownloading(),or(),h&&h.parentNode&&(u.isIE8OrEarlier&&(h.innerHTML=""),h.parentNode.removeChild(h))},oi=function(){},u.useFilterReflowWorkaround&&ri.usingIEFilters&&(oi=function(){h.offsetWidth})}function ou(){function lt(n,t,i){return n&&n.getTilePyramid()===t&&n.levelOfDetail===i}function c(t){if(t){if(g!=null){var i=t.getRootElement();g.removeAnimations(i)}n.removeHandler(t.rendererHandler),t.dispose()}}function gt(){c(r),r=null,c(o),o=null,e=h.none}function tt(){var lt,t,f,dt,gt,k;b.cancelDispatch(tt);var l,pt=!1,bt=!1,ot=!1,ii=e>h.none,ni=!1,w=e===h.readyForTarget?a:it;for(d?ft&&(ht||(lt=si(),pt=lt.keepGoing,ot=lt.gridsAdded,ni=lt.shouldSwapTileGrids),kt&&hi()):(c(i),i=null,c(o),o=null,c(nt),nt=null,c(v),v=null,c(p),p=null),e<h.started&&(i&&(i.getDownloadProgress()<1&&(bt=!0),i.render(w)),o&&o.render(w),nt&&nt.render(w),r&&ii&&(r.render(w),ri(r)),v&&v.render(w,1),p&&p.render(w,1)),e===h.readyForTarget&&(r&&g.addToGroup(r.getRootElement()),i&&g.addToGroup(i.getRootElement()),v&&g.addToGroup(v.getRootElement()),p&&g.addToGroup(v.getRootElement()),i&&r&&rt.addToGroup(r.mercatorZoom>i.mercatorZoom?r.getRootElement():i.getRootElement())),ni&&(ui(r),ti(),i.mercatorZoom>o.mercatorZoom?(y(i.getRootElement()).set_style({opacity:1}),i.opacity=1):(y(o.getRootElement()).set_style({opacity:0}),o.opacity=0),rt.applyAllAnimations()),l=s.length;l--;)t=s[l],t.havePendingDownloads=!1,f=t.tileGrid,dt=or.getBestLevelOfDetail(a,t.tilePyramid,ct),k=t.tilePyramid.projectingCamera,gt=a.getHeading()!==k.getHeading()||a.getPitch()!==k.getPitch()||a.getRoll()!==k.getRoll()||a.getDistanceInverse()!==k.getDistanceInverse(),f&&(f.levelOfDetail!==dt||gt&&!u.animateOverlayLayers)&&(!t.tempDisplayGrid&&u.animateOverlayLayers?(t.tempDisplayGrid=f,t.swapping=null):f.dispose(),f=null),ft&&(!gt||u.animateOverlayLayers)&&e<h.readyForTarget&&(f||(f=wt(t.tilePyramid,dt,t.lowPriority),f.isOverlay=!0,f.hideWhileAnimating=t.animation==="s"?!1:t.animation==="h"?!0:u.animateOverlayLayers?!1:!0,f.opacity=t.opacity,ot=!0),f.populate(a,ut,et)),(f||t.tempDisplayGrid)&&(t.tempDisplayGrid?t.swapping&&f?((t.swapping!=f||ot||st)&&at(f,l),t.tempDisplayGrid.dispose(),t.tempDisplayGrid=null,t.swapping=null):(f&&e===h.allowed&&at(f,l),ei(f,t.tempDisplayGrid,.85)&&(e===h.none&&at(f,l),t.swapping=f,pt=!0)):(ot||st)&&at(f,l)),f&&(e<h.started&&f.render(w),e===h.readyForTarget&&g.addToGroup(f.getRootElement()),e>h.allowed&&(t.tempDisplayGrid?ri(f):ui(f)),f.getDownloadProgress()<1&&(t.havePendingDownloads=!0)),t.tempDisplayGrid&&(e<h.started&&t.tempDisplayGrid.render(w),e===h.readyForTarget&&g.addToGroup(t.tempDisplayGrid.getRootElement())),t.tileGrid=f;for(st=!1,!bt&&yt&&n.invoke(vt,"tiledownloadcomplete"),yt=bt,l=s.length;l--;)t=s[l],!t.havePendingDownloads&&t.hadPendingDownloadsLastUpdate&&t.tileLayer&&n.invoke(t.tileLayer,"tiledownloadcomplete"),t.hadPendingDownloadsLastUpdate=t.havePendingDownloads;pt&&b.dispatch(tt,10),nt&&a.getWidth()/it.getWidth()>.95&&(c(nt),nt=null)}function si(){var n=!1,v=!1,y=!1,b=f.areAligned(a,it)&&a.getWidth()===it.getWidth(),s=or.getBestLevelOfDetail(a,d,ct),u=e>h.none,p;return lt(i,d,s)?e<h.readyForTarget&&(c(r),r=null,p=b&&!u,i.populate(p?it:a,ut,et,u),o&&!u&&(v=ci())):(e<h.readyForTarget&&(lt(r,d,s)||(c(r),r=wt(d,s),r.enableOrDisableScaledTiles(!0),r.mercatorZoom=d.projectingCamera.getMercatorZoom()+l.log2(d.projectingCamera.getWidth()/a.getWidth())),r.populate(a,ut,et)),i==null?(i=r,r=null,w.appendChild(i.getRootElement()),n=!0):r!=null&&(c(o),o=null,i.opacity=1,c(nt),nt=null,e===h.allowed&&(ni(),n=!0),vt.allowTileGridSwitch&&(!ot||r.getDownloadProgress()>.7)&&(!u||e>h.allowed)&&(r.getNoImageTileRatio()>.5?(c(r),r=null,ht=!0):u?y=!0:ot&&bt>1/t.maxFPS?(ni(),ti(),n=!0):(w.insertBefore(r.getRootElement(),i.getRootElement()),c(i),i=r,r=null,n=!0),o&&o.stopDownloading(),_lastTileGridBlendOn=new Date))),{keepGoing:v,gridsAdded:n,shouldSwapTileGrids:y}}function hi(){var i=e>h.none,n=oi[or.getBestLevelOfDetail(a,d,ct)],t=new pt(ut.width*dt,ut.height*dt);lt(v,d,n)?e<h.readyForTarget&&v.populate(a,t,0):(p||(p=wt(d,n,!0),p.populate(a,t,0),w.childNodes[0]?w.insertBefore(p.getRootElement(),w.childNodes[0]):w.appendChild(p.getRootElement())),v?ei(p,v,.9)&&(c(v),v=p,p=null,lt(v,d,n)||b.dispatch(tt)):(v=p,p=null))}function ci(){var t=!1,r=(_lastTileGridBlendOn?new Date-_lastTileGridBlendOn:0)/1e3,n=r/bt;return i.mercatorZoom>o.mercatorZoom?(i.opacity+=n,o.opacity=1,i.opacity>=1||n>=.5?(i.opacity=1,c(o),o=null):t=!0):(o.opacity-=n,i.opacity=1,o.opacity<=0||n>=.5?(c(o),o=null):t=!0),_lastTileGridBlendOn=new Date,t}function ni(){r&&i&&(r.mercatorZoom>i.mercatorZoom?(i.getRootElement().nextSibling==null?w.appendChild(r.getRootElement()):w.insertBefore(r.getRootElement(),i.getRootElement().nextSibling),r.opacity=0):(w.insertBefore(r.getRootElement(),i.getRootElement()),r.opacity=1))}function ti(){o=i,i=r,r=null}function wt(t,i,r){var u=new or(t,i,r);return u.rendererHandler=n.addHandler(u,"tilesrendered",li),u}function li(){b.dispatch(tt,10)}function ri(n){if(n){var t=n.getRootElement();t.style.left="-10000px",t.style.top="-10000px"}}function ui(n){if(n){var t=n.getRootElement();t.style.left="0px",t.style.top="0px"}}function at(n,t){if(s[t].tempDisplayGrid){w.insertBefore(n.getRootElement(),s[t].tempDisplayGrid.getRootElement());return}for(var i=t+1;i<s.length;){if(s[i].tempDisplayGrid){w.insertBefore(n.getRootElement(),s[i].tempDisplayGrid.getRootElement());break}else if(s[i].tileGrid){w.insertBefore(n.getRootElement(),s[i].tileGrid.getRootElement());break}i++}i>=s.length&&w.appendChild(n.getRootElement())}function fi(){st=!0,s.sort(function(n,t){return n.zIndex-t.zIndex})}function ei(n,t,i){return n&&n.getDownloadProgress()>i&&(n.mercatorZoom<=t.mercatorZoom||a.getWidth()/it.getWidth()>.9)}var vt=this,bt=.5,ot=!0,i=null,o=null,r=null,v=null,p=null,oi=[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,11,11,11,14,14,14,17,17,17,20,20,20,23,23,23,23],kt=u.animateOverlayLayers,dt=u.isIOSBrowser?2:4,w=k();w.style.cssText="position:absolute;z-index:0;left:0;top:0;"+u.safariRenderHack;var d,a,it,ut,s=[],st=!0,yt=!1,ft=!0,et=0,ht=!1,nt,ct=0,e=h.none,g=null,rt=null;this.allowTileGridSwitch=!0,this.render=function(n,t,i,r,u){r!=a&&(ht=!1),i!==d&&(yt=!0,ht=!1),ot=u!=null?u:ot,ut=n,d=i,it=t,a=r,tt(),e>h.none&&e<h.started&&(e==h.readyForTarget&&g.applyAllAnimations(),e++)},this.getBaseTilePyramid=function(){return d},this.enableOrDisableCssAnimation=function(t,i){var r=t!=null,u;(r||e!==h.none)&&(g||(g=new gr,rt=new gr,rt.manageAnimations([ii.TileFader.duplicate()]),u=function(n){n.hasPendingAnimations()?e=h.pendingCompletion:gt()},n.addHandler(g,"animationscomplete",function(){u(rt)}),n.addHandler(rt,"animationscomplete",function(){u(g)})),e>h.none&&(g.removeAllAnimations(),(!i||r)&&(rt.removeAllAnimations(),gt())),r&&vt.canCssAnimate()&&(g.manageAnimations([t]),e=t.isFlick?h.readyForTarget:h.allowed))},this.canCssAnimate=function(){return i&&d?!0:!1},this.addOverlay=function(n,t,i){var r=pi.getNext();return s.push({id:r,tilePyramid:n,zIndex:t.getZIndex(),opacity:t.getOpacity(),animation:t.getAnimation(),tileLayer:t,havePendingDownloads:!1,hadPendingDownloadsLastUpdate:!0,lowPriority:i}),fi(),b.dispatch(tt,10),r},this.removeOverlay=function(n){for(var i,t=s.length;t--;)if(s[t].id===n){i=s[t].tileGrid,i&&i.dispose(),s[t].tempDisplayGrid&&(s[t].tempDisplayGrid.dispose(),s[t].tempDisplayGrid=null),s.splice(t,1),b.dispatch(tt,10);break}},this.updateOverlay=function(n,t,i){var r,u;for(_overlaysUpdated=!0,r=s.length;r--;)if(s[r].id===n){u=s[r],u.opacity=i,u.zIndex!==t&&(u.zIndex=t,fi()),s[r].tempDisplayGrid&&(s[r].tempDisplayGrid.dispose(),s[r].tempDisplayGrid=null),b.dispatch(tt,10);break}},this.suspendGettingNewTiles=function(){ft=!1,c(r),r=null,c(o),o=null,c(nt),nt=null,i&&(i.opacity=1,i.allowTileRender=!1)},this.allowGettingNewTiles=function(){i&&(i.allowTileRender=!0),ft||(ft=!0,b.dispatch(tt,10))},this.disposeTiles=function(){b.cancelDispatch(tt),c(r),r=null,c(o),o=null,c(nt),nt=null,c(i),i=null,c(v),v=null,c(p),p=null;for(var n,t,u=s.length;u--;)n=s[u],t=n.tileGrid,t&&(t.dispose(),n.tileGrid=null)},this.showBackground=function(n){n!==null&&(kt=n,n||(c(v),v=null,c(p),p=null))},this.setBufferSize=function(n){n=Math.max(0,Math.min(4,n)),n!=et&&(et=n,b.dispatch(tt))},this.getRootElement=function(){return w},this.setPartialZoomBias=function(n){ct=n},this.isDownloadingTiles=function(){return r&&r.getDownloadProgress()<1||i&&i.getDownloadProgress()<1},this.getTileDownloadMetrics=function(){var n=0;return n+=i?i.getTileDownloadMetrics():0,n+(r?r.getTileDownloadMetrics():0)}}function sr(){function oi(n){et(n.collection,n.entity,!0,!1,p.last)}function si(n){it(n.entity,!0,!1),gt(n.entity)}function hi(n){et(n.collection,n.entity,!0,!1,p.last)}function ci(){et(null,s,!1,!0,p.last)}function o(t,u,f,e){var s,h,c;t||(t=ei.getEntityForTarget(f.target)),t&&(s=t.entity,s.trueEntity&&o({entity:s.trueEntity,type:t.type},u,f,e),n.hasHandler(s,u)&&(e&&f.touches&&f.touches[0]&&(h=new i(f.touches[0].pageX,f.touches[0].pageY)),h||(h=y.Screen.get_mouse_pos(f)),c=new vi(r,t.type,s,u,h.x,h.y,0,e,f),n.invoke(s,u,c)))}function li(n,i){var r=i[t],u=r&&r.dom;if(u)try{u.focus()}catch(f){}}function et(n,i,o,l,y){var hi,ci,ki,gt,ti,li,ii,at,g,ei,ai,lt,bi,di,ni,tr,ir,d,rr,ot,rt,dt,st;if(a)if(hi=!1,ci=r.getTheme(),ci&&(ki=i[nt]=i[nt]||{},gt=ci._preRenderEntity(i,ki,{updateEntity:o,themeReferenceKey:nt}),gt&&gt!==i&&(gt.trueEntity=i,i=gt)),ti=bt.getEntityRenderer(r,i),ti)li={entityCollection:n,rootDom:s[t].shape,rootOffsetLeft:s[t].offsetLeft,rootOffsetTop:s[t].offsetTop,parentDom:n[t].shape,parentOffsetLeft:n[t].offsetLeft,parentOffsetTop:n[t].offsetTop,parentVisible:wi(n),parentRemoved:!1,update:o,linear:l,animationStart:y===p.first,animationEnd:y===p.last,currentBounds:b,actualBounds:ui,viewportSize:a,customRenderer:c},ti.shouldDraw(i,li)?(ii=ti.update(i,li),ii&&fi(ii,{entity:i,type:ii.type})):it(i,!0,o);else if(i instanceof gi){d=i[t],d?(at=d.root,g=d.shape):(at=k(null,u.safariRenderHack),g=k(null,u.safariRenderHack+";position:absolute;"),at.appendChild(g),d={root:at,shape:g,offsetTop:0,offsetLeft:0},i[t]=d,hi=!0,o=!0),o&&(ei="position:absolute;pointer-events:none;",i.getVisible()||(ei+="display:none;"),pi(n,i),ai=i.getZIndex(),typeof ai=="number"&&(ei+="z-index:"+ai+";"),at.style.cssText=ei+u.safariRenderHack);var wt,oi=d.lookAt,vi=!1,si=!1;for(l&&oi?(lt=f==h.readyForTarget?vt.getWorldToViewport().transform(oi):ht.getWorldToViewport().transform(oi),yt&&d.harmony||!(Math.abs(lt.x)>1e4||Math.abs(lt.y)>1e4)?f<h.started&&(bi=e.translation(lt.x,lt.y,0),u.useTransform3d&&!u.isIOS3?(di=ri.setTransformAndOpacity(bi,null,1,{excludeCommonCss:!0,returnStyleObject:!0}),g.style[w.Properties.transform]=di[w.Properties.transform]):(wt=ri.setTransformAndOpacity(bi,null,1,{excludeCommonCss:!u.isIOS3}),u.isIOS3||(wt="position:absolute;"+wt),g.style.cssText=wt),d.offsetLeft=lt.x,d.offsetTop=lt.y):(vi=!0,si=!0,l=!1)):vi=!0,vi&&f<h.started&&(wt="position:absolute;",d.lookAt=ht.getLookAt(),d.offsetLeft=0,d.offsetTop=0,g.style.cssText=wt),l&&oi&&f==h.readyForTarget&&ut.addToGroup(g),g.harmony&&!pt.areEqual(d.previousSize,a)&&(ni=g.harmony,ni.style.width=a.width+"px",ni.style.height=a.height+"px",ni.style.left=-(a.width/2)+"px",ni.style.top=-(a.height/2)+"px",d.previousSize=a),hi&&n[t].root.appendChild(at),si&&g.harmony&&g.harmony.style&&(g.harmony.style.display="none"),tr=i.getLength(),ot=0;ot<tr;ot++)et(i,i.get(ot),o,l&&!si,y);si&&setTimeout(function(){g&&g.harmony&&g.harmony.style&&(g.harmony.style.display="block")},1)}else if(i instanceof nr)ir=i.getVisible()&&(c||b.contains(i.getLocation())||i[t]&&i[t].dragging),ir?yi(n,i,o,l):it(i,!0,o);else if(i instanceof ar)if(n.getVisible()){if(d=i[t],d||(d={},i[t]=d),o||!d.added||v.getBaseTilePyramid()!==ct){for(d.added=!1,ct=v.getBaseTilePyramid(),rr=ct?ct.projectingCamera:ft.mercator,ot=tt.length;ot--;)st=tt[ot][0],d[st]&&(v.removeOverlay(d[st]),d[st]=null),i.getVisible()&&ft[st]===rr&&(rt=i.getTileSource(st),rt&&(dt=kt.createQuadKeyTilePyramid(rt.getWidth(),rt.getHeight(),rt.getUriConstructor(),tt[ot][1],null,i.getDownloadTimeout()),dt.projectingCamera=ft[st],d[st]=v.addOverlay(dt,i,i.getTileDownloadPriority()===fr.low),d.added=!0));!d.added&&i.getVisible()&&i.getReproject()&&(rt=i.getTileSource("mercator"),rt&&(dt=kt.createQuadKeyTilePyramid(rt.getWidth(),rt.getHeight(),rt.getUriConstructor(),tt[0][1],null,i.getDownloadTimeout()),dt.projectingCamera=ft.mercator,d[st]=v.addOverlay(dt,i,i.getTileDownloadPriority()===fr.low)),d.added=!0)}}else it(i,!0,o)}function dt(n,t,i){if(u.isIE9OrEarlier)switch(t){case"keydown":if(n.onkeydown)throw"onkeydown is already associated with a handler";else n.onkeydown=i;break;case"focus":if(n.onfocus)throw"onfocus is already associated with a handler";else n.onfocus=i;break;case"blur":if(n.onblur)throw"onblur is already associated with a handler";else n.onblur=i;break;default:throw"keydown,focus,blur are the only supported events.";}else y(n).add_event(t,i)}function yi(i,r,o,s){var a,v,d,g,nt,st,b,tt,w,ft,ct,p,et,pt,ot,wt,bt,kt,it,rt,gt;if(i[t]){if(v=r[t],v?(o=v.updateEntity||o,v.updateEntity=!1):(a=k("a",u.safariRenderHack),a[l]={entity:r,type:ni.pushpin},v={dom:a,dragAttached:!1,offsetTop:0,offsetLeft:0},r[t]=v,d=r.trueEntity||r,g=n.getHandlers(r,"focus"),g&&g.length>0&&(a.trueEntity=d,dt(a,"focus",function(n){for(var t=0;t<g.length;t++)g[t].handler.call(null,n)})),nt=n.getHandlers(r,"blur"),nt&&nt.length>0&&(a.trueEntity=d,dt(a,"blur",function(n){for(var t=0;t<nt.length;t++)nt[t].handler.call(null,n)})),a.$hasKeyDown||(dt(a,"keydown",function(n){if(n.keyCode===9){var t=d.getInfobox();t&&t.getVisible()&&t.receiveFocus({nativeEvent:n,forwardFocus:!n.shiftKey})}}),a.$hasKeyDown=!0),n.hasHandler(d,"focusreceived")||n.addHandler(d,"focusreceived",function(n){li(n,r)}),o=!0),a=v.dom,a[l]||(a[l]={entity:r,type:ni.pushpin}),a.onclick==null&&(a.onclick=function(){return!1}),a.href||(a.href="#"),o&&(st=r.getHtmlContent(),st?(a.innerHTML=st,v.isHtmlContent=!0,v.icon=v.text=null):(v.isHtmlContent&&(a.innerHTML="",v.isHtmlContent=!1),b=v.icon,tt=r.getIcon(),!b&&tt&&(b=k("img",u.safariRenderHack,a),v.icon=b,b[l]={entity:r,type:ni.pushpin},b.src=tt),b&&b.src!==tt&&(b.src=tt||""),w=v.text,ft=r.getText(),!w&&ft&&(w=k(null,u.safariRenderHack,a),w.appendChild(document.createTextNode("")),v.text=w,w[l]={entity:r,type:ni.pushpin}),w&&(ft?(w.style.cssText="position:absolute;text-align:center;width:100%;font:bold 10pt Arial,Helvetica,Sans-Serif;color:#fff;left:"+r.getTextOffset().x+"px;top:"+r.getTextOffset().y+"px;",w.replaceChild(document.createTextNode(ft),w.firstChild)):(a.removeChild(w),v.text=null)))),ct=r.getHtmlContent(),p="",!c&&f<h.started&&(p=ct?"position:absolute;cursor:inherit;":"position:absolute;cursor:inherit;overflow:hidden;pointer-events:all;"+u.safariRenderHack,!s||!v.isDrawn)){if(et=f===h.readyForTarget?lt.internalTryLocationToViewport(vt,r.getLocation()):lt.internalTryLocationToViewport(ht,r.getLocation()),et){var ii=r.getAnchor(),at=et.x-ii.x-i[t].offsetLeft,yt=et.y-ii.y-i[t].offsetTop;u.useTransform3d&&r.getUseTransform3d()?(pt=e.translation(at,yt,0),ot={excludeCommonCss:!0},o?p+=ri.setTransformAndOpacity(pt,null,1,ot):(ot.returnStyleObject=!0,wt=ri.setTransformAndOpacity(pt,null,1,ot),v.displayHidden&&(wt.display=""),y(a).set_style(wt))):o?(p+="left:"+at+"px;",p+="top:"+yt+"px;"):(a.style.left=at+"px",a.style.top=yt+"px",v.displayHidden&&(a.style.display="")),v.displayHidden=!1}else o?p+="display:none;":a.style.display="none",v.displayHidden=!0;v.displayHidden=!0}o&&(a.id=r.getId(),bt=r.getTypeName()||"",v.className!=bt&&(v.className=a.className=bt,y(a).add_class("MapPushpinBase")),kt=r.getZIndex(),typeof kt=="number"&&(p+="z-index:"+kt+";"),it=r.getWidth(),rt=r.getHeight(),ct?(it&&(p+="width:"+it+"px;"),rt&&(p+="height:"+rt+"px;")):(p+="width:"+(it?it+"px;":"auto;"),p+="height:"+(rt?rt+"px;":"auto;"),p+="line-height:0px;"),a.style.cssText=p),s||f!==h.readyForTarget||ut.addToGroup(a),(o||!v.isDrawn)&&(gt=r.getDraggable(),gt!=v.dragAttached&&ti(r,gt)),c?v.isDrawn?o&&c.updateEntity(r):(c.addEntity(r,a),v.isDrawn=!0):v.isDrawn||(i[t].shape.appendChild(a),v.isDrawn=!0)}}function it(n,i,u){var h,s,e,a,f,o,y,p,w,b;if(n)if(h=r.getTheme(),h&&(s=n[nt]=n[nt]||{},s.proxyEntity&&(n=s.proxyEntity),h._unhookFromEntity(n,s)),n[t]){if(e=n[t],n instanceof gi)for(f=e.root,a=!1,i&&f&&f.parentNode&&(d?(d.push(f),a=!0):f.parentNode.removeChild(f)),o=n.getLength();o--;)it(n.get(o),a,u);else if(n instanceof nr)ti(n,!1),ii(n),f=e.dom,f&&(f[l]=null,f.onclick=null,f.onfocus=null,f.onblur=null,f.onkeydown=null,f.removeAttribute("href"),i&&f.parentNode&&f.parentNode.removeChild(f)),e.updateEntity=e.updateEntity||u,e.isDrawn=!1,c&&c.removeEntity(n);else if(n instanceof ar)for(e.added=!1,o=tt.length;o--;)y=tt[o][0],e[y]&&v.removeOverlay(e[y])}else p=bt.getEntityRenderer(r,n),p&&(w={parentRemoved:!i,update:u,customRenderer:c},b=p.remove(n,w),fi(b,null))}function fi(n,t){if(n&&n.doms)for(var i=n.doms,r=i.length;r--;)i[r][l]=t}function gt(n){var i,u;if(n instanceof gi)for(i=n.getLength();i--;)gt(n.get(i));else n instanceof nr?(ti(n,!1),ii(n)):(u=bt.getEntityRenderer(r,n),u&&u.dispose(n));delete n[t]}function pi(n,i){n&&n[t]&&i&&i[t]&&(i[t].parentVisible=n[t].parentVisible&&n.getVisible())}function wi(n){return n&&n[t]?n[t].parentVisible&&n.getVisible():null}function ti(i,r){var u=i[t];u&&(u.dragAttached=r,r?u.dragStartHandler=n.addHandler(i,"mousedown",bi):u.dragStartHandler&&(n.removeHandler(u.dragStartHandler),delete u.dragStartHandler))}function bi(u){var o=u.target,f=o.trueEntity||o,e=o[t],s,h,c;if(e&&(u.isTouchEvent||u.originalEvent.which===1)&&(e.dragging=!0,s=r.tryLocationToPixel(f.getLocation()),s)){h=s.x-u.getX(),c=s.y-u.getY(),n.invoke(f,"dragstart",{entity:f});function l(t){t.handled=!0,t.originalEvent.preventDefault();var u=r.tryPixelToLocation(new i(t.getX()+h,t.getY()+c));u&&f.setLocation(u),n.invoke(f,"drag",{entity:f})}function a(){ii(o),n.invoke(f,"dragend",{entity:f})}e.dragAttached&&!e.dragEndHandler&&(e.dragMoveHandler=n.addHandler(r,"mousemove",l),e.dragEndHandler=n.addHandler(r,"mouseup",a))}}function ii(i){var r=i[t];r&&(r.dragging=!1,r.dragMoveHandler&&(n.removeHandler(r.dragMoveHandler),delete r.dragMoveHandler),r.dragEndHandler&&(n.removeHandler(r.dragEndHandler),delete r.dragEndHandler))}sr.ensureVmlNamespace();var ei=this,r,lt,at,c,s,v,ot,l,t,nt,a,ht,b,ui,vt,yt,rt,d,ct,f=h.none,ut=new gr,p={first:0,middle:1,last:2},g=[["entityadded",oi],["entityremoved",si],["entitychanged",hi]],wt,tt=[["mercator",st.horizontal],["enhancedBirdseyeNorthUp",st.horizontal],["enhancedBirdseyeEastUp",st.vertical],["enhancedBirdseyeSouthUp",st.horizontal],["enhancedBirdseyeWestUp",st.vertical]];this.activate=function(i,f,e,o,h,a){r=i,lt=f,at=r.getRootElement(),s=r.entities,v=e,c=a,yt=ai.isClipped(),ot=h,l=ot+"_der",t=ot+"_etr",nt=ot+"_thr",s[t]={root:o,shape:k(null,u.safariRenderHack+";position:absolute;",o),offsetTop:0,offsetLeft:0,parentVisible:!0};for(var y=g.length;y--;)g[y][2]=n.addHandler(s,g[y][0],g[y][1]);wt=n.addHandler(bt,"newEntityRenderer",ci)},this.deactivate=function(){a=null;for(var t=g.length;t--;)n.removeHandler(g[t][2]),g[t][2]=null;n.removeHandler(wt),wt=null,it(s,!0,!1),gt(s),r=null,at=null,s=null,v=null},this.enableOrDisableCssAnimation=function(n){if(u.allowCssAnimations){var t=n!=null;ut.removeAllAnimations(),f=h.none,t&&(ut.manageAnimations([n]),f=n.isFlick?h.readyForTarget:h.allowed)}},this.onMouseDown=function(n){o(null,"mousedown",n)},this.onTouchStart=function(n){d||(d=[]),o(null,"mousedown",n,!0)},this.onMouseUp=function(n){o(this.getEntityForTarget(n.captureTarget),"mouseup",n)},this.onTouchEnd=function(n){var i,r,t;if(o(this.getEntityForTarget(n.captureTarget),"mouseup",n,!0),d)for(i=d,d=null,r=i.length;r--;)t=i[r],t&&t.parentNode&&t.parentNode.removeChild(t)},this.onMouseOver=function(n){o(null,"mouseover",n)},this.onMouseOut=function(n){o(null,"mouseout",n)},this.onMouseClick=function(n){o(null,"click",n)},this.onMouseRightClick=function(n){o(null,"rightclick",n)},this.onMouseDoubleClick=function(n){o(null,"dblclick",n)},this.onTap=function(n){o(null,"click",n,!0)},this.onDoubleTap=function(n){o(null,"dblclick",n,!0)},this.onTapAndHold=function(n){o(null,"rightclick",n,!0)},this.getEntityForTarget=function(n){while(n&&!n[l]&&n!==at)n=n.parentNode;return n&&n[l]||null},this.update=function(n,t,i,u,e){a=n,ht=t,vt=i,e!=p.last&&u&&b||(b=r.getBounds(),ui=b.clone(),b.width*=3,b.height*=3),rt=e==p.last&&yt?!1:rt&&u,et(null,s,!1,rt,e),e==p.last&&(rt=!0),f>h.none&&f<h.started&&(f==h.readyForTarget&&ut.applyAllAnimations(),f++)}}function ku(t){function a(){l=f.getMode().getShouldClipPolygons(),r=f.getMode().getDrawShapesInSingleLayer()}function p(){o&&(n.removeHandler(o),o=null,n.removeHandler(s),s=null)}function w(n){return r?n.rootDom:n.parentDom}function b(n,t){var u=null,i=n[e],f,r;return i&&(f=i.harmony,f&&(r=i.path,r&&(u=r.nativeShape,f.removePath(r),i.path=null)),i.updateEntity=i.updateEntity||t.update,i.isDrawn=!1),ai.isEventsSupported()&&u?{doms:[u]}:null}function v(n){var t=n[e];return t||(t={},n[e]=t),t}function d(n){return n instanceof tr||n instanceof ir&&l}function g(n,t){for(var o=n.x,s=n.x+n.width,h=n.y,c=n.y+n.height,f=[],i=[],a=t.length,e=null,r,l,u=0;u<a;u++)r=t[u],r?(l=r.x>=o&&r.y>=h&&r.x<=s&&r.y<=c,l?(!i.length&&u&&t[u-1]&&i.push(t[u-1]),i.push(r),e=null):(i.length&&(i.push(r),f.push(i),i=[]),e&&nt(o,s,h,c,e,r)&&(i.push(e),i.push(r),f.push(i),i=[]),e=r)):(f.push(i),i=[]);return i.length&&f.push(i),f}function nt(n,t,i,r,u,f){if(f.x-u.x==0)return u.x>=n&&u.x<=t;if(f.y-u.y==0)return u.y>=i&&u.y<=r;var o=(f.y-u.y)/(f.x-u.x),s=u.y-o*u.x,e=o*n+s;return e>=i&&e<=r?!0:(e=o*t+s,e>=i&&e<=r)?!0:(o=(f.x-u.x)/(f.y-u.y),s=u.x-o*u.y,e=o*i+s,e>=n&&e<=t)?!0:!1}function y(n,t,r){var u=n.x1,f=n.y1,e=n.x2,o=n.y2,s=t.x,h=t.y,c=r.x,l=r.y,a=((u*o-f*e)*(s-c)-(u-e)*(s*l-h*c))/((u-e)*(h-l)-(f-o)*(s-c)),v=((u*o-f*e)*(h-l)-(f-o)*(s*l-h*c))/((u-e)*(h-l)-(f-o)*(s-c));return new i(a,v)}function tt(n,t){for(var e=n.x,o=n.x+n.width,s=n.y,h=n.y+n.height,p=[{x1:e,y1:s,x2:o,y2:s,isInside:function(n,t){return t>this.y1}},{x1:o,y1:s,x2:o,y2:h,isInside:function(n){return n<this.x2}},{x1:o,y1:h,x2:e,y2:h,isInside:function(n,t){return t<this.y2}},{x1:e,y1:h,x2:e,y2:s,isInside:function(n){return n>this.x1}}],u=t,f,l,v,i,a,r,c=0;c<p.length;c++)for(f=p[c],l=u,u=[],v=l.length,i=l[v-1],a=0;a<v;a++)r=l[a],f.isInside(r.x,r.y)?(f.isInside(i.x,i.y)||u.push(y(f,i,r)),u.push(r)):f.isInside(i.x,i.y)&&u.push(y(f,i,r)),i=r;return[u]}var f=t,h="cm"+pi.getNext(),e=h+"_etr",c=!0,l,r,s,o;a(),s=n.addHandler(f,"modeoptionschanged",a),o=n.addHandler(f,"ondispose",p),this.shouldDraw=function(n,t){var f,e,i,o;return t.parentVisible!==null&&(c=t.parentVisible),f=n.getVisible()&&(t.linear||t.animationEnd||u.animateShapes)&&(!r||c),f&&(e=v(n),i=e.boundingRect,(t.update||!i)&&(o=n.getLocations(),e.boundingRect=i=o?rt.fromLocations(o):null),f=i&&t.currentBounds.intersects(i)),f},this.update=function(n,t){var o=t.viewportSize,at=t.currentBounds,i=v(n),y,s,c,e,it,ut,ft,p,l,et,b,ot,st,rt,bt,kt,a,nt,ht,lt;if(t.update=i.updateEntity||t.update,i.updateEntity=!1,y=i.harmony,s=w(t),!y&&s&&(c=s.harmony,c||(c=k("div","position:absolute;width:"+o.width+"px;height:"+o.height+"px;left:"+-(o.width/2)+"px;top:"+-(o.height/2)+"px;"+u.safariRenderHack),s.harmony=c,s.firstChild?s.insertBefore(c,s.firstChild):s.appendChild(c)),y=ai.getContext(c),c.className="MicrosoftMapDrawing",i.harmony=y),e=i.path,it=!1,e&&pt.areEqual(i.previousSize,o)||(y.setSize(o.width,o.height),i.previousSize=o,it=!0),e||(e=y.createPath(),e.id=h+"path"+pi.getNext(),i.path=e,t.update=!0),t.update&&(ut=n.getStrokeColor(),e.strokeStyle=ut.toHex(),e.strokeOpacity=ut.getOpacity(),e.lineWidth=n.getStrokeThickness(),e.dashArray=n.getStrokeDashArray(),n instanceof ir?(ft=n.getFillColor(),e.fillStyle=ft.toHex(),e.fillOpacity=ft.getOpacity()):e.fillStyle="none"),(!t.linear||!i.points||it)&&(et=null,b=i.boundingRect,b&&b.width>180&&(et={referenceLocation:b.center}),i.points=f.tryLocationToPixel(n.getLocations(),null,et),i.offsetLeft=r?t.rootOffsetLeft:t.parentOffsetLeft,i.offsetTop=r?t.rootOffsetTop:t.parentOffsetTop,ot=d(n)&&(b.width>at.width||b.height>at.height),i.doClipping=ot,!ot)){for(l=i.points,st=l.length,p=l.length;p--;)l[p]||(st=!1,p=0);st||(i.points=[])}if(!t.linear||t.animationEnd||t.update||it){if(l=i.points,i.doClipping){var vt=o.width*3,yt=o.height*3,dt=r?t.rootOffsetLeft:t.parentOffsetLeft,gt=r?t.rootOffsetTop:t.parentOffsetTop,wt=new ct(-dt-vt/2,gt-yt/2,vt,yt);rt=n instanceof tr?g(wt,l):tt(wt,l)}else rt=[l];for(e.beginPath(),bt=i.offsetLeft-o.width/2,kt=i.offsetTop-o.height/2,p=rt.length;p--;)if(a=rt[p],a&&a.length)for(a[0].shouldUseMoveTo=!0,nt=0;nt<a.length;nt++)ht=a[nt].x-bt,lt=a[nt].y-kt,a[nt].shouldUseMoveTo?e.moveTo(ht,lt):e.lineTo(ht,lt);e.data||e.moveTo(0,0),e.stroke(),i.isDrawn||(y.renderPath(e),i.isDrawn=!0)}return ai.isEventsSupported()&&n.getShouldFireEvents()?{doms:[e.nativeShape],type:n instanceof tr?ni.polyline:ni.polygon}:null},this.remove=b,this.dispose=function(n){delete n[e]}}function su(n,t,i,r,u){function e(n){for(var i=[],r=n?n.split(";"):[],u=r.length,t;u--;)t=rt.fromString(r[u]),t&&i.push(t);return i}this.priority=u;var f=e(r);this.getScene=function(r,u,e,o){if(o>=t&&o<i){if(!f||!f.length)return n;for(var h=new v(u,e),s=f.length;s--;)if(f[s].contains(h))return n}return null}}function ei(n,t){var i=n;this.getCopyrights=function(n,r,u,f){t(function(t){t?hu.getCopyrights(i,n,r,u,t,f):f([gt.defaultCopyright.text])})}}function cu(r,e,o,s,h,c,l){function ot(n){n.stopPropagation(),n.preventDefault()}function oi(n,t){var r,i;if(r=n.length,t&&!n.isWired){while(r--)i=n[r],s.add_event(i[0],i[1],!1);n.isWired=!0}else if(!t&&n.isWired){while(r--)i=n[r],s.remove_event(i[0],i[1],!1);n.isWired=!1}}function ht(){return p!=null&&(p.x!=0||p.y!=0)}function nr(){bt&&ht()&&(p.x*=bt,p.y*=bt,Math.abs(p.x)<5&&Math.abs(p.y)<5&&(p.x=0,p.y=0))}function tr(n,t,i){if(n&&t&&i){var r=i.x-t.x,u=i.y-t.y;r!=0||u!=0?(st+=n,p?(p.x=.3*p.x+.7*r*1e3/st,p.y=.3*p.y+.7*u*1e3/st):p=new ti(r*1e3/st,u*1e3/st),st=0):st+=n}}function ir(n){var t=y.Screen.get_mouse_pos(n);return new i(t.x-e.getViewportX(),t.y-e.getViewportY())}function lt(){return new i(0,0)}function d(t,u,f,o){var p=!1,c,w,s,l,v;return n.hasHandler(r,u)&&(o||(f.touches&&f.touches[0]?c=new i(f.touches[0].pageX,f.touches[0].pageY):a&&a[0]&&(c=a[0])),c||(c=y.Screen.get_mouse_pos(f)),w=f.wheelDelta?f.wheelDelta:0,h&&(t&&(s=h.getEntityForTarget(t)),s||(s=h.getEntityForTarget(f.target)),s&&(l=s.type,s=s.entity)),l||(s=e,l=ni.map),v=new vi(e,l,s,u,c.x,c.y,w,!o,f),u==="click"&&(v.mouseMoved=ei&&g&&i.distance(ei,g)>5),n.invoke(r,u,v),p=v.handled),p}function sr(n){if(!n.handled){var t=!1;if(n.ctrlKey)switch(n.keyCode){case 37:o.rotate(90);break;case 39:o.rotate(-90)}else switch(n.keyCode){case 37:v.x>-1&&(v.x=-1),t=!0;break;case 39:v.x<1&&(v.x=1),t=!0;break;case 38:v.y>-1&&(v.y=-1),t=!0;break;case 40:v.y<1&&(v.y=1),t=!0;break;case 109:case 189:vt=-1;break;case 107:case 187:case 61:vt=1}r.ensureUpdateDispatched(),t&&(n.handled=!0,ot(n.originalEvent))}}function hr(n){if(!n.handled){switch(n.keyCode){case 37:case 39:v.x=0;break;case 38:case 40:v.y=0;break;case 109:case 189:case 107:case 187:case 61:vt=0}r.ensureUpdateDispatched()}}function si(){v.x=0,v.y=0,vt=0}function rr(n){if(!d(null,"dblclick",n,!0)&&!et){if(h)h.onMouseDoubleClick(n);var t=ft?lt():ir(n);o.zoomCenter(.5,t)}ot(n)}function cr(n){if(!d(null,"click",n,!0)&&h){h.onMouseClick(n);if(u.emulateDblClick){var t=y.Screen.get_mouse_pos(n);new Date-fi<yi&&t.x===dt.x&&t.y===dt.y?(dt={x:0,y:0},fi=new Date(0),rr(n)):(dt=t,fi=new Date)}}}function lr(n){if(!d(null,"rightclick",n,!0)&&h)h.onMouseRightClick(n)}function ar(n){if(!d(null,"mousewheel",n,!0)&&!et){if(nt.clearInertialScrolling(),n.wheelDelta){var t=ft?lt():ir(n);o.zoomPoint(n.wheelDelta,t)}ot(n)}}function vr(n){if(!d(null,"mousedown",n,!0)){if(si(),r.suspendSceneChanges(!1),r.haltCssAnimation(),o.startUserInput(),h)h.onMouseDown(n);ii=!et&&c&&(n.shiftKey===!0||n.which===2),g=y.Screen.get_mouse_pos(n),nt.clearInertialScrolling(),ei=it=g,y.Events.capture_mouse(this,!1),ui=!0,ii?s.set_style({cursor:r.getCursors().SEResize}):s.set_style({cursor:r.getCursors().Grabbing})}ot(n);try{document.focus()}catch(t){}}function yr(n){d(null,"mousemove",n,!0)||it&&(g=y.Screen.get_mouse_pos(n),r.ensureUpdateDispatched(),pi=new Date,ot(n))}function pr(n){ui&&ur(n)}function ur(n){var u,f;if(!d(n.captureTarget,"mouseup",n,!0)){if(r.canUseCssAnimations()&&ht()||r.allowSceneChanges(),at===!0&&(u=new Date,f=u-pi,f<bi?tt=g:nt.clearInertialScrolling()),r.ensureUpdateDispatched(),h)h.onMouseUp(n);if(ii&&it&&i.distance(it,g)>10){var l=e.getViewportX(),a=e.getViewportY(),t=ct.union(new i(it.x-l,it.y-a),new i(g.x-l,g.y-a)),v=Math.max(t.width/e.getWidth(),t.height/e.getHeight()),p=ft?lt():t.getCenter();o.zoomCenter(v,p)}}c&&(rt.style.display="none",rt.parentNode&&rt.parentNode.removeChild(rt)),s.set_style({cursor:r.getCursors().Grab}),it=null,ui=!1,y.Events.release_mouse()}function wr(n){if(!d(null,"mouseover",n,!0)&&h)h.onMouseOver(n)}function br(n){if(!d(null,"mouseout",n,!0)&&h)h.onMouseOut(n)}function hi(n){var t=e.getViewportX(),r=e.getViewportY();return n.length>1?new i((n[0].x+n[1].x)/2-t,(n[0].y+n[1].y)/2-r):n.length?new i(n[0].x-t,n[0].y-r):new i(0,0)}function kr(n){if(n.preventManipulation&&n.preventManipulation(),n.currentTarget&&n.currentTarget.msSetPointerCapture&&n.currentTarget.msSetPointerCapture(n.pointerId),n.preventMouseEvent&&n.preventMouseEvent(),si(),ci(),!d(null,"mousedown",n,!1)){if(r.suspendSceneChanges(!0),r.haltCssAnimation(),o.startUserInput(),h)h.onTouchStart(n);nt.clearInertialScrolling();var t=Math.min(2,n.touches.length);for(yt===0&&t===2&&(yt=r.getCurrentCamera().getMercatorZoom()),b.length===0&&t===1&&(w=new i(n.touches[0].pageX,n.touches[0].pageY),w.target=n.target,w.start=new Date,wt=setTimeout(tu,er));t--;)a[t]=new i(n.touches[t].pageX,n.touches[t].pageY),b[t]=a[t],ut[t]=a[t];gi=r.getCurrentCamera().getHeading()}ot(n)}function dr(n){if((n.touches.length>1||w&&(Math.abs(n.touches[0].pageX-w.x)>20||Math.abs(n.touches[0].pageY-w.y)>20))&&(li(),ci()),n.touches.length>1||!d(null,"mousemove",n,!1)){var t=b.length;if(t)for(t=n.touches.length;t--;)a[t]=new i(n.touches[t].pageX,n.touches[t].pageY)}r.ensureUpdateDispatched(),wi=new Date,ot(n)}function fr(n){var c,v,y,p,t,u,l,s,it,rt;if(n.currentTarget.msReleasePointerCapture&&n.currentTarget.msReleasePointerCapture(n.pointerId),ci(),!d(null,"mouseup",n,!1)){if(h)h.onTouchEnd(n);if(w&&(gr(),navigator.msPointerEnabled&&navigator.pointerEnabled||(pt&&new Date-pt.start<yi?(c=new i(w.x-e.getViewportX(),w.y-e.getViewportY()),nu(),li()):(pt=w,w=null))),b.length===1&&at===!0&&(v=new Date,y=v-wi,y<bi?tt=a[0]:nt.clearInertialScrolling()),b.length=0,n.touches.length&&(nt.clearInertialScrolling(),a[0]=b[0]=new i(n.touches[0].pageX,n.touches[0].pageY)),r.canUseCssAnimations()&&ht()?r.ensureUpdateDispatched():r.allowSceneChanges(),c&&!et)t=ft?lt():c,o.zoomCenter(.5,t,null,!0);else{if(ut.length>1&&r.isRotationEnabled()){var k=new ti(ut[1].x-ut[0].x,ut[1].y-ut[0].y),g=new ti(a[1].x-a[0].x,a[1].y-a[0].y),ot=Math.atan2(g.y,g.x)-Math.atan2(k.y,k.x);Math.abs(ot)>.7&&(yt=0),ut.length=0}yt!==0&&ri>0&&(t=ft?lt():hi(a),u=r.getCurrentCamera().getMercatorZoom(),l=u-yt,yt=0,s=Math.abs(l),s-=Math.floor(s),s>=ri&&s<.5&&(it=l>0?Math.ceil(u):Math.floor(u),rt=f.mercatorZoomToWidth(it,r.getCurrentCamera().getCrs(),p)/f.mercatorZoomToWidth(u,r.getCurrentCamera().getCrs(),p),o.zoomCenter(rt,t,t)))}ht()||o.endUserInput()}}function ci(){wt&&(clearInterval(wt),wt=null)}function li(){pt=null,w=null}function gr(){if(!d(null,"click",w,!1)&&h)h.onTap(w)}function nu(){if(!d(null,"dblclick",w,!1)&&h)h.onDoubleTap(w)}function tu(){if(w){if(!d(null,"rightclick",w,!1)&&h)h.onTapAndHold(w);li()}}var nt=this,rt;l=l||{},c&&(rt=k("div","display:none;z-index:0;position:absolute;border:1px dashed #000;background:#ccc"),y(rt).set_style({opacity:".5"}));var ai=.15,yi=500,er=1e3,pt,w,wt,ri=l.touchZoomThreshold!=null?l.touchZoomThreshold:.1,ui=!1,at=!0,bt=.9,p=null,kt=null,tt=null,dt={x:0,y:0},fi=new Date(0),pi=new Date(0),wi=new Date(0),bi=100,st=0,ft=!1,et=!1,or=[["dblclick",rr],["click",cr],["mousewheel",ar],["mousedown",vr],["mousemove",yr],["mouseup",ur],["losecapture",pr],["contextmenu",lr],["mouseover",wr],["mouseout",br]],ki=[["touchstart",kr],["touchmove",dr],["touchend",fr],["touchcancel",fr]],gt=[["keydown",sr,null],["keyup",hr,null],["blur",si,null]],iu=.003*u.scrollAdjustment,v=new i(0,0),vt=0,di=new Date(0),g,it,ei,ii,a=[],ut=[],gi,b=[],yt=0;nt.enableOrDisableInertialScrolling=function(n,t){n?(at=!0,typeof t=="number"&&(bt=Math.min(Math.max(t,.01),.99))):at=!1},nt.enableOrDisableUserInput=function(t,i){if(i){t=t&&!i.disableUserInput,oi(or,t&&!i.disableMouseInput),t&&!i.disableTouchInput?(navigator.pointerEnabled?s.set_style({"touch-action":"none"}):s.set_style({"-ms-touch-action":"none"}),oi(ki,!0)):(navigator.pointerEnabled?s.set_style({"touch-action":""}):s.set_style({"-ms-touch-action":""}),oi(ki,!1)),t=t&&!i.disableKeyboardInput;var u,f;if(u=gt.length,t)while(u--)f=gt[u],f[2]||(f[2]=n.addHandler(e,f[0],f[1]));else while(u--)n.removeHandler(gt[u][2]),gt[u][2]=null;ft=i.disablePanning?!0:!1,et=i.disableZooming?!0:!1,s.set_style({cursor:r.getCursors().Grab})}},nt.setTouchZoomThreshold=function(n){ri=Math.min(n,.49)},nt.clearInertialScrolling=function(){tt=null,p=null},nt.processPendingUserInput=function(){var c=new Date,l=kt?c-kt:null,y,ri,ui,f,h,u,k,d,ot,st,yt;if(kt=c,ri=r.getCurrentCamera().getWidth(),ui=r.getCurrentCamera().getLookAt(),vt&&!et&&(nt.clearInertialScrolling(),y=vt<0?2:.5),(v.x||v.y)&&!ft&&(nt.clearInertialScrolling(),f=v.x*ai*e.getWidth(),h=v.y*ai*e.getHeight(),Math.abs(v.x)>.9&&Math.abs(v.x)<3&&(v.x=v.x*1.01),Math.abs(v.y)>.9&&Math.abs(v.y)<3&&(v.y=v.y*1.01)),(y||f||h)&&(c=new Date,(kt-di)/1e3>r.getCameraAnimationDuration()/3&&(y&&o.zoom(y),(f||h)&&o.doDragXY(f,h),di=c)),it)if(ii&&!et){var wt=e.getPageX(),bt=e.getPageY(),w=ct.union(new i(it.x-wt,it.y-bt),new i(g.x-wt,g.y-bt));rt.style.left=w.x+"px",rt.style.top=w.y+"px",rt.style.width=w.width+"px",rt.style.height=w.height+"px",rt.style.display="block",s.element().appendChild(rt)}else ft||(o.doDrag(it,g),at===!0&&tr(l,it,g),it=g);else if(b.length>0){if(u=b.length,a.length>=u){switch(u){case 1:ft||(o.doDrag(b[0],a[0]),at===!0&&tr(l,b[0],a[0]));break;case 2:if(k=ft?lt():hi(b),d=ft?lt():hi(a),!a[0]||!a[1]||!b[0]||!b[1])return;if(ot=1,et||(ot=i.distance(b[0],b[1])/i.distance(a[0],a[1])),st=0,ut.length>1&&r.isRotationEnabled()){var dt=new ti(ut[1].x-ut[0].x,ut[1].y-ut[0].y),gt=new ti(a[1].x-a[0].x,a[1].y-a[0].y),fi=Math.atan2(gt.y,gt.x)-Math.atan2(dt.y,dt.x);st=gi-r.getCurrentCamera().getHeading()-fi*180/Math.PI}o.setCamera(ot,k,d,st)}while(u--)b[u]=a[u]}}else if(ht())if(yt=r.requestCssAnimation(!0),yt){for(var n=new i(tt.x,tt.y),pt=1/t.maxFPS,ni=0;ht();)n.x+=p.x*pt,n.y+=p.y*pt,ni+=pt,nr();yt.setDuration(ni),r.suspendSceneChanges(!0),o.doDrag(tt,n,!0),tt=n}else{if(tt){var n=new i(tt.x+p.x*l/1e3,tt.y+p.y*l/1e3),k=new i(Math.round(tt.x),Math.round(tt.y)),d=new i(Math.round(n.x),Math.round(n.y));o.doDrag(k,d),tt=n}nr(),ht()?r.ensureUpdateDispatched():o.endUserInput()}else o.endUserInput()}}function lu(n,t){var e=null,o=.003*u.scrollAdjustment,r=0;this.doDrag=function(r,u,f){if(r&&u&&!i.areEqual(r,u)){var e=t.getViewportX(),o=t.getViewportY(),s=new i(r.x-e,r.y-o),h=new i(u.x-e,u.y-o),c=n.getCurrentCamera().getViewportToWorld().transform(s);n.setAlignedCamera(n.getCurrentCamera().getCrs(),c,h,n.getCurrentCamera().getWidth(),n.getCurrentCamera().getHeading(),f)}},this.doDragXY=function(t,r){var u=n.getCurrentCamera().getWidth(),f=n.getCurrentCamera().getViewportToWorld().transform(new i(t,r));n.setAlignedCamera(n.getCurrentCamera().getCrs(),f,null,u,n.getCurrentCamera().getHeading(),!0)},this.zoom=function(t){var i=n.getCurrentCamera().getWidth()*t,r=n.getCurrentCamera().getLookAt();i!==n.getTargetCamera().getWidth()&&n.setAlignedCamera(n.getCurrentCamera().getCrs(),r,null,i,n.getCurrentCamera().getHeading(),!0)},this.zoomCenter=function(t,i,r,u){var e=n.getTargetCamera(),s=e.getWidth()*t,c=e.getViewportToWorld().transform(i),o,h;u&&(o=f.widthToMercatorZoom(s,e.getCrs(),e.getLookAt()),o!=Math.floor(o)&&(h=o-e.getMercatorZoom()>0?Math.floor(o):Math.ceil(o),o=h+Math.round(o-h),s=f.mercatorZoomToWidth(o,e.getCrs(),e.getLookAt()))),n.requestCssAnimation(),n.setAlignedCamera(e.getCrs(),c,r,s,e.getHeading(),!0)},this.zoomPoint=function(t,i){var a=new Date,s=a-e,c,h,l,u,v,y;e=a,c=n.getCurrentCamera().getViewportToWorld().transform(i),h=o*t*(t>0?1:.75),s>200?(s=200,r=h/s):r=(r+h/s)/2,r=Math.min(.009,r),r=Math.max(-.006,r),l=n.getCurrentCamera().getMercatorZoom(),u=l+r*(r>0?400:250),u=h>0?Math.min(n.getInternalMaxZoom(),Math.ceil(u)):Math.max(n.getInternalMinZoom(),Math.floor(u)),v=f.mercatorZoomToWidth(u,n.getCurrentCamera().getCrs(),c),y=(u-l)/r*1.5,n.setAlignedCamera(n.getCurrentCamera().getCrs(),c,i,v,n.getCurrentCamera().getHeading(),y)},this.rotate=function(t){n.setAlignedCamera(n.getTargetCamera().getCrs(),n.getTargetCamera().getLookAt(),null,n.getTargetCamera().getWidth(),n.getTargetCamera().getHeading()+t,!0)},this.setCamera=function(t,i,r,u){var f=n.getCurrentCamera().getViewportToWorld().transform(i),e=l.log2(1/t);n.setCamera(n.getCurrentCamera().getAlignedCamera(e,f,r,u),!1)},this.startUserInput=function(){},this.endUserInput=function(){}}function gu(i){function rt(n,t,i,r,u,f){var nt,s,b,d,et;if(r>=it){if(nt=ot.toEllipsoid(new v(t,i)),s=c.wrap(c.fromLocation(nt)),k(n,s,r,u,f))return n;for(var st=1<<y,tt=g.mercatorXYToTileId(s,y),p=g.tileIdToCacheKey(tt),rt=Math.round(l.normalizeDegrees(u)/h)*h%360,o=e.get(p)||[],ut=o.length,w;ut--;)if(w=o[ut],k(w,s,r,u,f))return w;b="h"+rt.toFixed(),o[b]||(o[b]=!0,e.insert(p,o),d=g.tileIdToLocation(tt),et=a.replace("{centerpoint}",d.latitude.toFixed(6)+","+d.longitude.toFixed(6)).replace("{heading}",rt.toFixed(0)),ui.getObjectAsync(et,ft,p))}return null}function ft(t,i){var f=i.userData,r,u;i.success&&t&&t.statusCode===200&&t.resourceSets&&t.resourceSets.length&&(r=t.resourceSets[0],r.resources&&r.resources.length&&(u=e.get(f)||[],et(r.resources[0],u),e.insert(f,u),n.invoke(o,"newsceneavailable")))}function et(n,i){var st;if(n.bes&&n.bes.bec&&n.bes.bei){var o=n.bes,at=o.s.toString(),h=o.bei,e=o.bec,y=p.get(at);if(!y){y=[];var it=2*Math.ceil(h.piw/(2*u)),vt=2*Math.ceil(h.pih/(2*u)),rt=it*u,k=new r(e.qcx,e.qcy,e.qcz),yt=new r(e.qdx,e.qdy,e.qdz),ti=new r(e.qex,e.qey,e.qez),g=er.toLocation(k),ii=ot.getAltitudeAtLatLon(g.latitude,g.longitude),pt=er.fromLocation(new v(g.latitude,g.longitude,ii,ht.ellipsoid)),ri=fi.fromNormal(pt,er.getUpVector(pt)),wt=ri.intersectWithLine(k,r.add(k,yt)),bt=r.subtract(wt,k).getLength(),kt=rt/h.piw*(e.ox/(2*e.ol)),si=2*Math.atan(kt),ui=2*bt*kt,oi=f.fromDirectionVector(er,wt,ui,yt,ti,1/bt),ft=oi.convertCoordinateReferenceSystem(c),dt=(h.piw-w)/rt,gt=(h.pih-w)/rt,ni=new ct(-dt/2-e.opx,-gt/2-e.opy,dt,gt),a,b,et;b=d(nt.replace("{quadkey}",o.q).replace("{runtimeindex}",o.ri),it,vt,o.l,e.opx*h.piw,e.opy*h.pih),b.projectingCamera=ft,et=ft.getAlignedCamera(l.log2(b.getWidth()/t.zoomOriginWidth)-1),a=new lt(et,b,1,"NativeBirdseye",new ei("Birdseye",s)),a.nativeBirdseyeFrustumRect=ni,a.labelOverlay=ut.hidden,y.push(a),b=d(tt.replace("{quadkey}",o.q).replace("{runtimeindex}",o.ri),it,vt,o.l,e.opx*h.piw,e.opy*h.pih),b.projectingCamera=ft,a=new lt(et,b,1,"NativeBirdseye",new ei("BirdseyeWithLabels",s)),a.nativeBirdseyeFrustumRect=ni,a.labelOverlay=ut.visible,y.push(a)}for(p.insert(at,y),st=y.length;st--;)i.push(y[st])}}function k(n,t,i,r,u){if(n&&n.nativeBirdseyeFrustumRect&&n.labelOverlay===u&&l.distanceDegrees(r,n.nativeCamera.getHeading())<h&&i>=n.nativeCamera.getMercatorZoom()-.5){var f=n.tilePyramid.projectingCamera.getWorldToFrustum().transform(t);if(n.nativeBirdseyeFrustumRect.contains(f))return!0}return!1}function d(n,t,i,r,f,e){var s=Math.ceil(t/2),h=Math.ceil(i/2),o=new kt(t*u,i*u,u,u,0,0,f,e,function(u){var f,e,c;switch(u.levelOfDetail){case o.getMaxLevelOfDetail()-1:e=s,c=h,f=r-1;break;case o.getMaxLevelOfDetail():e=t,c=i,f=r}return f&&u.x>=0&&u.x<e&&u.y>=0&&u.y<c?n.replace("{subdomain}",(u.y&1)*2+(u.x&1)).replace("{level}",f).replace("{index}",e*u.y+u.x):null});return o}var o=this,s=i.credentialsProvider,nt=i.urlFormat,tt=i.urlWithLabelsFormat,it=17.1,e=new yi(100),y=19,p=new yi(100),h=45,w=400,u=256,a=t.nativeBirdseyeMetadataUrl.replace("{zoom}","20"),b;this.priority=40,this.getScene=function(){return b||(b=!0,s(function(t){a=a.replace("{credentials}",t),o.getScene=rt,n.invoke(o,"newsceneavailable")})),null}}var o=window[$MapsNamespace].Maps,y=o.Gimme,t=o.Globals,hr,s,a,p,u,b,si,ht,dt,ut,li,n,cr,di,wi,ui,ni,ur,lr,yr,pr,fr,uu,tt,l,nt,c,er,ft,g,ot,w,h,ii,st,ai,du,hu,au;window[$MapsNamespace].Maps.Resources=new function(n){n=n||{},n.strings={},this.init=function(t){var i;for(i in t)n.strings[i]={value:t[i]}},this.getString=function(){function f(n){i.languages=[t.locale],ci&&ci.culture&&(i.languages=[ci.culture]);var r="";try{r=u.getValue(n,i).valueAsString}catch(f){}return r}function e(t){return n.strings[t]&&n.strings[t].value||""}if(window.Windows&&Windows.ApplicationModel){var r=Windows.ApplicationModel.Resources.Core,u=r.ResourceManager.current.mainResourceMap.getSubtree("/Bing.Maps.Javascript/Resources"),i=new r.ResourceContext;return f}return e}()}(this),hr=o.Resources,a={},o.InternalNamespaceForDelay=a,p="mm$",typeof PRF=="undefined"&&(PRF={add:function(){},start:function(){},end:function(){}}),a.PRF=PRF,PRF.start("mapcore");var ci=new function(){function r(n,t){var i=!1;return u(n)&&(f(n,t),i=!0),i}function u(n){return localStorage&&localStorage.getItem(n+".keys")&&!localStorage.getItem(n+".invalid")?!0:!1}function i(n,t){var r,i,u;if(localStorage.getItem(n+".keys")&&typeof t=="function")for(r=localStorage.getItem(n+".keys").split(";"),i=0,i=r.length;i>0;i--)u=r[i-1],t(u)}function f(n,t){i(n,function(i){t[i]=h(n,i)})}function e(r){localStorage.setItem(r+".invalid","true"),i(r,function(i){localStorage.removeItem(n(r,i)),localStorage.removeItem(t(r,i))}),localStorage.removeItem(r+".keys"),localStorage.removeItem(r+".invalid")}function o(n,t){var i,r;e(),i="";for(r in t)s(n,r,t[r]),i+=r+";";localStorage.setItem(n+".keys",i.substring(0,i.length-1))}function s(i,r,u){var f=typeof u;localStorage.setItem(t(i,r),f),localStorage.setItem(n(i,r),u)}function h(i,r){var f=localStorage.getItem(t(i,r)),u=localStorage.getItem(n(i,r));switch(f){case"number":return Number(u);case"boolean":return u==="true";case"string":case null:return u}}function n(n,t){return n+"."+t}function t(n,t){return n+"."+t+".type"}this.GlobalsId="globals",this.culture="en-US",this.homeRegion="US",this.UpdateCulture=function(n,t){n!==""&&(this.culture=n),t!==""&&(this.homeRegion=t),this.GlobalsId="globals"+this.culture.toLowerCase()+this.homeRegion.toLowerCase()},this.tryLoadConfigIntoObject=function(n,t){return typeof n!="string"||n===""||!t||!localStorage?!1:r(n,t)},this.writeConfig=function(n,t){typeof n=="string"&&n!==""&&t&&localStorage&&o(n,t)}},nu=new function(){function r(){i||(i=!0,PRF.end("Module initialized",t,{module:"Map Core"}),tt.done(t))}var u=this,n=window[$MapsNamespace].Maps.Globals,i=!1,t="Microsoft.Maps.Map";this.tryCachedGlobals=function(i,f){var s=!1,e=typeof f.culture=="string"?f.culture:"en-us",h=typeof f.homeRegion=="string"?f.homeRegion:"US",o;return e&&e.toLowerCase()!=="en-gb"&&(n.allowCollinsBart=!1,n.allowOrdnanceSurvey=!1),e&&e.toLowerCase()==="zh-cn"&&(n.allowAerialMap=!1,n.allowBirdseye=!1),ci.UpdateCulture(e,h),ci.tryLoadConfigIntoObject(ci.GlobalsId,n)&&(s=!0,o=tt.getRegistration(t).scriptUrls,o&&o.length>0&&ui.getObjectAsync(o[0],u.parse),r()),s},this.parse=function(i){var f,u;if(!i||typeof i.ishttpsenabled=="undefined"&&typeof i.killSwitchEngaged=="undefined"){tt.reset(t);return}if(!i.jsonTimeStamp||!n.jsonTimeStamp||i.jsonTimeStamp!=n.jsonTimeStamp){f=!n.version,i.clientVersion="7.0.20131119174407.78",i.cssPath="///Bing.Maps.JavaScript/css/",i.imagePath="///Bing.Maps.JavaScript/images/",i.jsPath="///Bing.Maps.JavaScript/js/",i.pushpinImageUrl="///Bing.Maps.JavaScript/images/poi_search.png",i.cursorPath="///Bing.Maps.JavaScript/cursors/",i.logServiceUrl&&(i.logServiceUriFormat=i.logServiceUriFormat.replace(i.version,i.clientVersion)),i.bingThemeIconUrlFormat="///Bing.Maps.JavaScript/images/BingTheme/pins/pin_{iconStyle}{imageryStyle}{state}.png",i.killSwitchImageUrl="///Bing.Maps.JavaScript/images/rr.png",i.directionsImagePath="///Bing.Maps.JavaScript/images/Directions/",i.protocol=i.ishttpsenabled?"https://":"http://",i.jsonTimeStamp=(new Date).valueOf();for(u in i)typeof i[u]=="string"&&(i[u]=i[u].replace(/{urischeme}/g,i.protocol).replace(/{version}/g,i.version).replace(/{culture}/g,i.locale).replace(/{generation}/g,i.tilegeneration).replace(/{odmgeneration}/g,i.odmtilegeneration)),f&&(n[u]=i[u]);ci.writeConfig(ci.GlobalsId,i),f&&(n.protocol=i.protocol,r())}}},pi=new function(){var n=1e3;this.getNext=function(){return n++}};a.IdGenerator=pi;var gt=new function(){this.isValidNumber=function(n){return typeof n=="number"&&isFinite(n)},this.cloneObject=function(n){var i={},t;for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i},this.createElement=function(n,t,i){var r=document.createElement(n||"div");return t&&(r.style.cssText=t),i&&i.appendChild(r),r},this.ignoreEvent=function(n){n.stopPropagation(),n.preventDefault()},this.stopPropagation=function(n){n.stopPropagation()},this.prioritySort=function(n,t){return n.priority-t.priority},this.isArray=function(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"},this.extend=function(n,t){function i(){}i.prototype=t.prototype,n.prototype=new i,n.prototype.constructor=n,n.baseConstructor=t,n.superClass=t.prototype},this.restrictLongitude=function(n,t){while(t-n>180&&t>n)t-=360;while(n-t>180&&t<n)t+=360;return t};var n=function(){function n(n,t,i){return Object.defineProperty(n,t,i)}function t(n,t,i){return n[t]=i.get(),n}try{return Object.defineProperty({},"test",{}),n}catch(i){return t}}();this.defineGetter=n,this.defaultCopyright=n({},"text",{get:function(){return hr.getString("L_microsoftcopyright_text").replace(/{year}/,(new Date).getFullYear())}})},et=1e-11,oi=gt.isValidNumber,tu=gt.cloneObject,k=gt.createElement,nf=gt.ignoreEvent,tf=gt.stopPropagation,vu=gt.prioritySort,ki=gt.isArray,yu=gt.extend,pu=gt.restrictLongitude;if(a.Common=gt,u=new function(){var n=navigator.userAgent,e=n.indexOf("MSIE"),o=n.indexOf("Firefox"),s=n.indexOf("Chrome"),p=o!==-1,w=s!==-1,r=e!==-1||typeof MSPointerEvent!="undefined"||n.toLowerCase().indexOf("trident")!==-1,t=parseInt(n.substring(e+5)),b=r&&t===6,k=r&&t===9,d=r&&t===8,g=r&&t===10,nt=w&&parseInt(n.substring(s+7))>=11,tt=p&&parseInt(n.substring(o+8))>=4,ft=document.documentMode,it=n.indexOf("Gecko"),h=it!==-1,c=n.indexOf("Trident/"),l=parseInt(n.substring(c+8)),a=c>0,v=n.indexOf("BlackBerry")!==-1,f=n.indexOf("AppleWebKit")!==-1,i=navigator.vendor==="Apple Computer, Inc."&&!v,y=i&&n.indexOf("iPhone OS 3_")!==-1,rt=f&&n.indexOf("Android")!==-1,ut=typeof WinJS!="undefined",u;this.isWebkit=f,this.cursorHotspot=f?" 10 9":"",this.allowCssAnimations=i,this.useTransform2d=a&&l>=6&&typeof document.createElement("div").style.msTransform!="undefined",this.useTransform3d=i,this.useTransform3dForTranslate=i,this.useImageDisposer=i,this.isIOSBrowser=n.indexOf("iPhone")!==-1,this.safariRenderHack=i?"-webkit-transform:translate3d(0px,0px,0px);":"",this.isIE6=b,this.isIE8=d,this.isIE9=k,this.isIE10=g,r&&(this.isIE7OrEarlier=t<8,this.isIE8OrEarlier=t<9,this.isIE9OrEarlier=t<10),this.useXHR=ut,this.isIOS3=y,u=a&&l>=5,this.useFilterReflowWorkaround=u,this.cssZoomAffectsTopLeft=function(){var n=function(){var n=document.createElement("div"),t,i;return n.style.cssText="position:absolute;top:-1000px;left:-1000px;width:100px;zoom:2;",t=document.createElement("div"),t.style.cssText="position:relative;width:10px;left:50%;",n.appendChild(t),document.body.appendChild(n),i=t.offsetLeft,n.parentNode.removeChild(n),i!==50}();return this.cssZoomAffectsTopLeft=function(){return n},n},this.animateOverlayLayers=u&&document.documentMode>8||nt||tt||i,this.animateShapes=this.animateOverlayLayers&&!y,this.canRenderOpacityAndRotationOnSemiTransparentPngs=!(r&&!u),this.scrollAdjustment=1,this.useOnResize=u,this.autoSizesElementsTooSmall=h||f,this.opacityGlitchAtBrowserEdges=h,this.emulateDblClick=v,this.isShapeEventsSupported=function(){return typeof ai!="undefined"&&ai.isEventsSupported?ai.isEventsSupported():!0},this.allowFocus=!rt},a.Quirks=u,b=new function(){function e(){i=null,n.length&&u();var r=n;for(n=t,t=r,t.sort(o);t.length;)t.shift()()}function o(n,t){return n[r]-t[r]}function u(){i||(i=f(e))}var f=y.Effects.Animation.requestAnimationFrame,i,n=[],t=[],r=p+"dispatchOrder";this.dispatch=function(t,i){t[r]=i||0;for(var f=n.length;f--;)if(n[f]===t)return;n.push(t),u()},this.cancelDispatch=function(i){for(var r=n.length;r--;)n[r]===i&&n.splice(r,1);for(r=t.length;r--;)t[r]===i&&t.splice(r,1)}},a.Dispatcher=b,i.prototype={clone:function(){return new i(this.x,this.y)},toString:function(){return"[Point "+this.x+","+this.y+"]"}},i.clone=function(n){return new i(n.x,n.y)},i.add=function(n,t){return new i(n.x+t.x,n.y+t.y)},i.distance=function(n,t){var i=n.x-t.x,r=n.y-t.y;return Math.sqrt(i*i+r*r)},i.subtract=function(n,t){return new i(n.x-t.x,n.y-t.y)},i.multiply=function(n,t){return new i(n.x*t,n.y*t)},i.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y},o.Point=i,si={fromTileId:function(n,t){var e=1,r;t&&(e=0);var i="",u=n.x,f=n.y;for(r=0;r<n.levelOfDetail;r++)i=((u&1)+2*(f&1)).toString()+i,u>>=1,f>>=1;return i},toTileId:function(n){var t=0,i=0,u=0,r;if(n!=null&&n.length>0)for(u=n.length,r=0;r<n.length;r++)switch(n.charAt(r)){case"0":t=t*2+0,i=i*2+0;break;case"1":t=t*2+1,i=i*2+0;break;case"2":t=t*2+0,i=i*2+1;break;case"3":t=t*2+1,i=i*2+1}return new it(u,t,i)},wrapX:function(n){var t=1<<n.levelOfDetail;return new it(n.levelOfDetail,(n.x%t+t)%t,n.y)},wrapY:function(n){var t=1<<n.levelOfDetail;return new it(n.levelOfDetail,n.x,(n.y%t+t)%t)},isInBounds:function(n){if(n.x<0||n.y<0)return!1;var t=1<<n.levelOfDetail;return n.x>=t||n.y>=t?!1:!0}},o.QuadKey=si,ht={ground:0,ellipsoid:1,isValid:function(n){return n===ht.ground||n===ht.ellipsoid}},o.AltitudeReference=ht,v.prototype={clone:function(){return new v(this.latitude,this.longitude,this.altitude,this.altitudeReference)},toString:function(){return"[Location "+this.latitude+","+this.longitude+(this.altitude!==s&&this.altitudeReference!==s?","+this.altitude+","+this.altitudeReference:"")+"]"}},v.normalizeLongitude=function(n){return n<-180||n>180?n-Math.floor((n+180)/360)*360:n},v.areEqual=function(n,t){return n&&t&&n.latitude===t.latitude&&n.longitude===t.longitude&&n.altitude===t.altitude&&n.altitudeReference===t.altitudeReference},o.Location=v,rt.prototype={getNorthwest:function(){return new v(this.getNorth(),this.getWest(),this.center.altitude,this.center.altitudeReference)},getSoutheast:function(){return new v(this.getSouth(),this.getEast(),this.center.altitude,this.center.altitudeReference)},getNorth:function(){return this.center.latitude+this.height/2},getSouth:function(){return this.center.latitude-this.height/2},getWest:function(){return this.width>=360?-180:v.normalizeLongitude(this.center.longitude-this.width/2)},getEast:function(){return this.width>=360?180:v.normalizeLongitude(this.center.longitude+this.width/2)},toString:function(){return"[LocationRect "+this.center.toString()+" "+this.width+","+this.height+"]"},clone:function(){return new rt(this.center.clone(),this.width,this.height)},contains:function(n){var i=Math.abs(this.center.latitude-n.latitude),t=Math.abs(this.center.longitude-n.longitude);return t>180&&(t=360-t),i<=this.height/2&&t<=this.width/2},intersects:function(n){var i=Math.abs(this.center.latitude-n.center.latitude),t=Math.abs(this.center.longitude-n.center.longitude);return t>180&&(t=360-t),i<=this.height/2+n.height/2&&t<=this.width/2+n.width/2}},rt.areEqual=function(n,t){return n&&t&&v.areEqual(n.center,t.center)&&n.height===t.height&&n.width===t.width},rt.fromEdges=function(n,t,i,r,u,f){return Math.abs(r-t)>360&&(t=-180,r=180),t=v.normalizeLongitude(t),r=v.normalizeLongitude(r),t>r&&(r+=360),new rt(new v((i+n)/2,(t+r)/2,u,f),r-t,n-i)},rt.fromCorners=function(n,t){return rt.fromEdges(n.latitude,n.longitude,t.latitude,t.longitude,n.altitude,n.altitudeReference)},rt.fromLocations=function(){for(var t=ki(arguments[0])?arguments[0]:arguments,r,u,f,e,o,h,i,l=t&&t.length?t[0].longitude:0,n,c=t.length;c--;)n=t[c],isFinite(n.latitude)&&isFinite(n.longitude)&&(r=r===s?n.latitude:Math.max(r,n.latitude),u=u===s?n.latitude:Math.min(u,n.latitude),i=pu(l,n.longitude),e=e===s?i:Math.max(e,i),f=f===s?i:Math.min(f,i),isFinite(n.altitude)&&ht.isValid(n.altitudeReference)&&(h=n.altitude,o=n.altitudeReference));return rt.fromEdges(r,f,u,e,h,o)},rt.fromString=function(n){var i=null,t=n.split(","),r,u,f,e;return t&&t.length==4&&(r=parseFloat(t[0]),u=parseFloat(t[1]),f=parseFloat(t[2]),e=parseFloat(t[3]),i=rt.fromEdges(r,u,f,e)),i},o.LocationRect=rt,dt={road:"r",aerial:"a",birdseye:"be"},o.MapTypeId=dt,ut={visible:0,hidden:1,isValid:function(n){return n===ut.hidden||n===ut.visible}},o.LabelOverlay=ut,li={viewport:0,page:1,control:2,isValid:function(n){return n===li.viewport||n===li.page||n===li.control}},o.PixelReference=li,n=new function(){var t=this,n=p+"events";this.addHandler=function(t,i,r){var u=null,f;return t&&typeof i=="string"&&typeof r=="function"&&(t[n]=t[n]||{},f=t[n][i]||[],t[n][i]=f,u={target:t,eventName:i,handler:r},f.push(u)),u},this.addThrottledHandler=function(n,i,r,u){var f=t.addHandler(n,i,r);return f.throttleInterval=u,f},this.removeHandler=function(i){var f,e,r,u;if(i&&(f=i.target,e=i.eventName,t.hasHandler(f,e)))for(r=f[n][e],u=r.length;u--;)i===r[u]&&(i.willBeInvokedBy&&window.clearInterval(i.willBeInvokedBy),r.splice(u,1))},this.hasHandler=function(n,t){return this.getHandlers(n,t)!==null},this.getHandlers=function(t,i){var r=t&&t[n]&&t[n][i]&&t[n][i];return r&&r.length>0?r:null},this.invoke=function(i,r,u){var e;if(t.hasHandler(i,r)){var o=new Date,h=i[n][r],c=h.length,f;for(u=u||{},u.eventName===s&&(u.eventName=r);c--;)f=h[c],f.handler&&(f.throttleInterval?f.willBeInvokedBy?f.willBeInvokedWithArgs=u:(e=f.throttleInterval-(o-(f.lastInvokedAt||new Date(0))),e<=0?(f.lastInvokedAt=o,f.handler(u)):(f.willBeInvokedWithArgs=u,f.willBeInvokedBy=window.setTimeout(function(){var n=f;return function(){var t=n.willBeInvokedWithArgs;delete n.willBeInvokedBy,delete n.willBeInvokedWithArgs,n.lastInvokedAt=new Date,n.handler&&n.handler(t)}}(),e))):f.handler(u))}}},o.Events=n,a.ElementSizeHelper=iu,cr={singleByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<2;i++)t="0"+t;return t},twoByteHex:function(n){var t,i;if(!n)return"";for(t=n.toString(16),i=t.length;i<4;i++)t="0"+t;return t},encodeHtml:function(n){var t,u,i,r;if(n==null)return"";for(u=n.length,i=new Array(u),r=0;r<u;r++)t=n.charCodeAt(r),t>96&&t<123||t>64&&t<91||t==32||t>47&&t<58||t==46||t==44||t==45||t==95?i.push(String.fromCharCode(t)):i.push("&#"+t+";");return i.join("")},encodeUrl:function(n){var t,u,i,r;if(!n)return"";for(u=n.length,i=new Array(u),r=0;r<u;++r)t=n.charCodeAt(r),t>96&&t<123||t>64&&t<91||t>47&&t<58||t==46||t==45||t==95?i.push(String.fromCharCode(t)):t>127?(i.push("%u"),i.push(cr.twoByteHex(t))):(i.push("%"),i.push(cr.singleByteHex(t)));return i.join("")}},a.IOSec=cr,di=[],rr.getAllInstances=function(){return di},rr.getVersion=function(){return t.version},o.Map=rr,a.MapType=hi,ui=new function(){function f(i,r,u){b.dispatch(function(){if(i&&!r&&(r=t),r){var f=n[r];f&&(delete n[r],f.timeoutId&&window.clearTimeout(f.timeoutId),f.callback(i,{requestId:r,success:u===200?!0:!1,userData:f.userData,httpStatus:u}),h(f.elScript))}})}function e(t){if(t){var i=n[t];i&&(delete n[t],i.callback(null,{requestId:t,success:!1,userData:i.userData}),h(i.elScript))}}function l(n,t){function i(n,i){f(n,t,i)}o.Gimme.Ajax.request_json(n,i)}function r(n,t){l(n,t)}function a(n,t,i){var u,r;return u=v(),u?(r=document.createElement("link"),r.rel=t?"alternate stylesheet":"stylesheet",i&&(r.media=i),r.type="text/css",r.rev="stylesheet",r.href=n,u.appendChild(r),r):void 0}function v(){if(!i){var n=document.getElementsByTagName("head");n.length>0&&(i=n[0])}return i}function y(n,t,i){function r(n){t(n,i)}o.Gimme.Ajax.request_json(n,r)}function h(n){n&&(n.src&&(n.src=""),n.parentNode&&n.parentNode.removeChild(n))}var p=this,u=5e3,i,c=1,t,n={};window.microsoftMapsNetworkCallback=f,this.downloadScript=function(n){return r(n)},this.downloadStyles=function(n,t,i){a(n,t,i)},this.getObjectAsync=function(t,i,f,o,s){var h=s;return h||(h="r"+ ++c,t=t.replace("{jsono}",h)),(typeof o!="number"||o<=0)&&(o=u),n[h]={callback:i,userData:f,elScript:r(t,h),timeoutId:window.setTimeout(function(){e(h)},o)},h},this.getObjectAsyncWithNoJsonso=function(i,f,o,s){t="_logCallbackRequest",(typeof s!="number"||s<=0)&&(s=u),n[t]={callback:f,userData:o,elScript:r(i,t),timeoutId:window.setTimeout(function(){e(t)},s)}},this.isRequestCompleted=function(t){return n[t]?!1:!0},this.abortRequest=function(t){n[t]&&delete n[t]},this.getObjectAsyncCacheFriendly=function(n,t,i){y(n,t,i)}},a.Network=ui,ni={map:"map",pushpin:"pushpin",polyline:"polyline",polygon:"polygon",infobox:"infobox"},vi.prototype={handled:!1,toString:function(){return"[MouseEventArgs]"}},a.MouseEventArgs=vi,a.EventTargetType=ni,vr.prototype={handled:!1,toString:function(){return"[KeyEventArgs]"}},a.KeyEventArgs=vr,yt.prototype={clone:function(){return new yt(this.a,this.r,this.g,this.b)},getOpacity:function(){return isFinite(this.a)?this.a/255:1},toHex:function(){var n=this.r,t=this.g,i=this.b;return"#"+(n<16?"0":"")+Number(n).toString(16)+(t<16?"0":"")+Number(t).toString(16)+(i<16?"0":"")+Number(i).toString(16)},toString:function(){return"[Color "+this.toHex()+"]"}},yt.clone=function(n){return new yt(n.a,n.r,n.g,n.b)},yt.fromHex=function(n){var i=null,t=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return t&&t.length==4&&(i=new yt(255,parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16))),i},o.Color=yt,gi.prototype={_visible:!0,_zIndex:null,setOptions:function(t,i){var r=!1;return t&&(typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.zIndex!="undefined"&&(this._zIndex=t.zIndex,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},toString:function(){return"[EntityCollection]"}},o.EntityCollection=gi,ur={standard:"Infobox",mini:"MiniInfobox2",expanded:"Infobox2"},o.InfoboxType=ur,ru.prototype={_width:256,_height:126,_showCloseButton:!0,_offset:new i(0,0),_htmlContent:null,_id:null,_typeName:ur.standard,_visible:!0,_zIndex:null,_options:null,_calculatedSize:null,_clip:!0,_shouldFireEvents:!0,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setCalculatedSize:function(n){this._calculatedSize=n},measure:function(){return this._calculatedSize||{width:0,height:0}},setOptions:function(t,r){if(t){var u=!1;this._options=t,(t.width>0||t.width===null||t.width==="auto")&&(this._width=t.width===null?"auto":t.width,u=!0),(t.height>0||t.height===null)&&(this._height=t.height,u=!0),typeof t.showCloseButton=="boolean"&&(this._showCloseButton=t.showCloseButton,u=!0),t.offset&&(this._offset=i.clone(t.offset),u=!0),typeof t.htmlContent=="string"&&(this._htmlContent=t.htmlContent,u=!0),typeof t.id=="string"&&(this._id=t.id,u=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,u=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,u=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,u=!0),typeof t.clip=="boolean"&&(this._clip=t.clip,u=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,u=!0)}return u&&(r===null||!r)&&n.invoke(this,"entitychanged",{entity:this}),u},getWidth:function(){return this._width},getHeight:function(){return this._height},getShowCloseButton:function(){return this._showCloseButton},getOffset:function(){return this._offset},getOptions:function(){return this._options},getShouldFireEvents:function(){return this._shouldFireEvents},setHtmlContent:function(t){var i=this._htmlContent!=t;this._htmlContent=t,this._showPointer=!1,i&&n.invoke(this,"entitychanged",{entity:this})},getHtmlContent:function(){return this._htmlContent},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},getClip:function(){return this._clip},receiveFocus:function(t){n.invoke(this,"focusreceived",{entity:this,nativeEvent:t.nativeEvent,forwardFocus:t.forwardFocus})},toString:function(){return"[InfoboxBase]"}},yu(d,ru),o.Infobox=d,d.prototype._title=null,d.prototype._titleAction=null,d.prototype._description=null,d.prototype._titleClickHandler=null,d.prototype._showPointer=!0,d.prototype._actions=[],d.prototype._pushpin=null,d.prototype._polygon=null,d.prototype.setOptions=function(t,i){if(t){var r=d.superClass.setOptions.call(this,t,!1);(typeof t.title=="string"||t.title===null)&&(this._title=t.title,r=!0),typeof t.titleIsPlaintext=="boolean"&&(this._titleIsPlaintext=t.titleIsPlaintext,r=!0),(typeof t.description=="string"||t.description&&t.description.innerHTML)&&(this._description=t.description,r=!0),typeof t.showPointer=="boolean"&&(this._showPointer=t.showPointer,r=!0),(typeof t.actions=="object"||t.actions===null)&&(this._actions=t.actions||[],r=!0),(typeof t.titleAction=="object"||t.titleAction===null)&&(this._titleAction=t.titleAction,r=!0),(typeof t.titleClickHandler=="function"||t.titleClickHandler===null)&&(this._titleClickHandler=t.titleClickHandler,r=!0),t.pushpin&&t.pushpin instanceof o.Pushpin&&(this._pushpin=t.pushpin,this._pushpin.getInfobox()!=this&&this._pushpin.setOptions({infobox:this}),r=!0),t.polygon&&t.polygon instanceof o.Polygon&&(this._polygon=t.polygon,this._polygon.getInfobox()!=this&&this._polygon.setOptions({infobox:this}),r=!0),(this._typeName===ur.mini||typeof this._htmlContent=="string")&&(this._showPointer=!1),r&&(i===null||!i)&&n.invoke(this,"entitychanged",{entity:this})}},d.prototype.getActions=function(){return this._actions},d.prototype.getTitle=function(){return this._title},d.prototype.getTitleIsPlaintext=function(){return this._titleIsPlaintext},d.prototype.getTitleAction=function(){return this._titleAction},d.prototype.getTitleClickHandler=function(){return this._titleClickHandler},d.prototype.getDescription=function(){return this._description},d.prototype.getShowPointer=function(){return this._showPointer},d.prototype.getPushpin=function(){return this._pushpin},d.prototype.getPolygon=function(){return this._polygon},d.prototype.getAnchor=function(){var n,t=this._calculatedSize&&this._calculatedSize.height||0,r;return this._showPointer?this._typeName!==ur.standard?(n=10,new i(20+n/2,t)):(n=28,r=38,new i(20+n/2,this.getHeight()+r)):t!==0?new i(0,t):new i(0,this.getHeight()||0)},d.prototype.getOptions=function(){return d.superClass.getOptions.call(this)},d.prototype.toString=function(){return"[Infobox]"},lr={highlighted:2,selected:1,none:0},yr={none:0,highlight:1,zoom:2},nr.getDefaultIcon=function(){return{width:25,height:39,anchor:new i(13,39),textOffset:new i(0,5),url:t.pushpinImageUrl}},nr.prototype={_width:25,_height:39,_draggable:!1,_anchor:null,_calculatedAnchor:new i(13,39),_htmlContent:null,_text:null,_textOffset:new i(0,5),_id:null,_typeName:null,_visible:!0,_zIndex:null,_useTransform3d:!0,_infobox:null,_state:lr.none,setLocation:function(t){this._location=t,n.invoke(this,"entitychanged",{entity:this})},getLocation:function(){return this._location},setOptions:function(t,r){var u=!1;return t&&(typeof t.icon=="string"&&(this._icon=t.icon,u=!0),t.width!==s&&(this._width=t.width>0?t.width:0,u=!0),t.height!==s&&(this._height=t.height>0?t.height:0,u=!0),typeof t.draggable=="boolean"&&(this._draggable=t.draggable,u=!0),t.anchor&&(this._anchor=i.clone(t.anchor),u=!0),typeof t.htmlContent=="string"&&(this._htmlContent=t.htmlContent,u=!0),typeof t.text=="string"&&(this._text=t.text,u=!0),t.textOffset&&(this._textOffset=i.clone(t.textOffset),u=!0),typeof t.id=="string"&&(this._id=t.id,u=!0),typeof t.typeName=="string"&&(this._typeName=t.typeName,u=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,u=!0),isFinite(t.zIndex)&&(this._zIndex=t.zIndex,u=!0),t.infobox&&t.infobox instanceof d&&(this._infobox=t.infobox,this._infobox.getPushpin()!=this&&this._infobox.setOptions({pushpin:this}),u=!0),typeof t.state=="number"&&(this._state=t.state,u=!0),u&&!r&&(this._calculatedAnchor=this._anchor?this._anchor:new i(Math.ceil(this._width/2),this._height),n.invoke(this,"entitychanged",{entity:this}))),u},getIcon:function(){return this._icon},getWidth:function(){return this._width},getHeight:function(){return this._height},getDraggable:function(){return this._draggable},getAnchor:function(){return this._calculatedAnchor},getHtmlContent:function(){return this._htmlContent},getText:function(){return this._text},getTextOffset:function(){return this._textOffset},getId:function(){return this._id},getTypeName:function(){return this._typeName},getVisible:function(){return this._visible},getZIndex:function(){return this._zIndex},getUseTransform3d:function(){return this._useTransform3d},getInfobox:function(){return this._infobox},getState:function(){return this._state},receiveFocus:function(){n.invoke(this,"focusreceived",{entity:this})},toString:function(){return"[Pushpin]"}},o.EntityState=lr,o.PinFocusBehavior=yr,o.Pushpin=nr,tr.prototype={_strokeColor:new yt(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_visible:!0,_id:null,_shouldFireEvents:!0,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t,i){var r=!1;return t&&(t.strokeColor&&(this._strokeColor=yt.clone(t.strokeColor),r=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,r=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,r=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.id=="string"&&(this._id=t.id,r=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getVisible:function(){return this._visible},getId:function(){return this._id},getShouldFireEvents:function(){return this._shouldFireEvents},toString:function(){return"[Polyline]"}},o.Polyline=tr,ir.prototype={_strokeColor:new yt(255,255,0,0),_strokeThickness:3,_strokeDashArray:"none",_fillColor:new yt(255,0,0,255),_visible:!0,_infobox:null,_shouldFireEvents:!0,_state:lr.none,_id:null,setLocations:function(t){this._locations=t,n.invoke(this,"entitychanged",{entity:this})},getLocations:function(){return this._locations},setOptions:function(t,i){var r=!1;return t&&(t.strokeColor&&(this._strokeColor=yt.clone(t.strokeColor),r=!0),isFinite(t.strokeThickness)&&(this._strokeThickness=t.strokeThickness,r=!0),typeof t.strokeDashArray=="string"&&(this._strokeDashArray=t.strokeDashArray,r=!0),t.fillColor&&(this._fillColor=yt.clone(t.fillColor),r=!0),typeof t.visible=="boolean"&&(this._visible=t.visible,r=!0),typeof t.id=="string"&&(this._id=t.id,r=!0),t.infobox&&t.infobox instanceof o.Infobox&&(this._infobox=t.infobox,this._infobox.getPolygon()!=this&&this._infobox.setOptions({polygon:this}),r=!0),typeof t.shouldFireEvents=="boolean"&&(this._shouldFireEvents=t.shouldFireEvents,r=!0),typeof t.state=="number"&&(this._state=t.state,r=!0),r&&!i&&n.invoke(this,"entitychanged",{entity:this})),r},getStrokeColor:function(){return this._strokeColor},getStrokeThickness:function(){return this._strokeThickness},getStrokeDashArray:function(){return this._strokeDashArray},getFillColor:function(){return this._fillColor},getVisible:function(){return this._visible},getInfobox:function(){return this._infobox},getShouldFireEvents:function(){return this._shouldFireEvents},getState:function(){return this._state},toString:function(){return"[Polygon]"}},o.Polygon=ir,pr={show:"s",hide:"h",auto:"a"},fr={low:0,high:1},ar.prototype={toString:function(){return"[TileLayer]"}},o.AnimationVisibility=pr,o.TileLayer=ar,o.TileDownloadPriority=fr,wr.prototype={toString:function(){return"[TileSource]"}},o.TileSource=wr,o.Globals.disableGeoLocation||(uu=function(n){function y(n,i,r){if(t&&r===t&&n&&n.coords){var u=new v(n.coords.latitude,n.coords.longitude,n.coords.altitude);(!i||i&&i.showAccuracyCircle!=!1)&&f.addAccuracyCircle(u,n.coords.accuracy,h,{displayOnMap:!0}),(!i||i&&i.updateMapView!=!1)&&w(n),i&&i.successCallback&&i.successCallback({center:u,position:n})}t=0}function p(n,i,r){t&&r===t&&i.errorCallback&&i.errorCallback({internalError:n,errorCode:n.code}),t=0}function w(t){if(t)if(t.coords.accuracy<300)n.setView({center:new v(t.coords.latitude,t.coords.longitude,t.coords.altitude),zoom:16});else{var f=e(t.coords.latitude,t.coords.longitude,0,t.coords.accuracy),i=(f.latitude-t.coords.latitude)*2,r=n.getHeight(),u=n.getWidth(),o=r>u?r:u;n.setView({bounds:new rt(new v(t.coords.latitude,t.coords.longitude,t.coords.altitude),i,i),padding:o/3})}}function e(n,t,r,f){for(var a=l,b=a.degreesToRadians(r),p=(1-u)*Math.tan(a.degreesToRadians(n)),k=Math.cos(b),et=Math.sin(b),y=1/Math.sqrt(1+p*p),d=y*et,ot=d*d,g=1-ot,nt=Math.atan2(p,Math.cos(b)),c=g*((s*s-i*i)/(i*i)),st=1+c/16384*(4096+c*(-768+c*(320-175*c))),tt=c/1024*(256+c*(-128+c*(74-47*c))),e=f/(i*st),ht=2*Math.PI,o=Math.sin(e),it=2*nt+e,h=Math.cos(it),rt;Math.abs(e-ht)>1e-12;){it=2*nt+e,h=Math.cos(it),rt=h*h,o=Math.sin(e);var lt=Math.cos(e)*(-1+2*rt),at=tt/6*h*(-3+4*o*o)*(-3+4*rt),vt=tt*o*(h+tt/4*(lt-at));ht=e,e=f/(i*st)+vt}h=Math.cos(2*nt+e),o=Math.sin(e);var w=Math.cos(e),ut=p*y,ct=ut*o-y*w*k,yt=Math.atan2(ut*w+y*o*k,(1-u)*Math.sqrt(ot+ct*ct)),pt=Math.atan2(o*et,y*w-ut*o*k),ft=u/16*g*(4+u*(4-3*g)),wt=e+ft*o*(h+ft*w*(-1+2*h*h)),bt=pt-(1-ft)*u*d*wt,kt=(a.degreesToRadians(t)+bt+3*Math.PI)%(2*Math.PI)-Math.PI;return new v(a.radiansToDegrees(yt),a.radiansToDegrees(kt))}var r=null,h=128,c=new yt(150,0,163,239),a=new yt(25,0,163,239),t=0,o=navigator&&navigator.geolocation,f=this,s=nt.earthRadiusInMeters,i=nt.earthMinorAxisRadiusInMeters,u=nt.flatteningOfEllipsoidWGS84;this.getCurrentPosition=function(n){if(f.removeAccuracyCircle(),o&&t===0)t=Math.random(),navigator.geolocation.getCurrentPosition(function(i){y(i,n,t)},function(i){p(i,n,t)},n);else if(n&&n.errorCallback){var i=o?4:5;n.errorCallback({internalError:null,errorCode:i})}},this.cancelCurrentRequest=function(){t=0},this.addAccuracyCircle=function(t,i,u,o){var h=null,s,w,b,k,d;if(t&&u&&i&&t instanceof v&&oi(u)&&oi(i)){var l=[],y=t.latitude,p=t.longitude;for(s=0;s<u;s++)w=s/u*360,b=e(y,p,w,i),l.push(b);k=e(y,p,0,i),l.push(k),d=o.polygonOptions||{fillColor:a,strokeColor:c},h=new ir(l,d),o&&o.displayOnMap!=!1&&(f.removeAccuracyCircle(),r=h,n.entities.push(r))}return h},this.removeAccuracyCircle=function(){r&&(n.entities.remove(r),r=null)}},o.GeoLocationProvider=uu),a.DelayMap=fu,tt=new function(){function i(t,r,u){var f,o,s,e;if(f=t[r],f)for(o=f.length;o--;)s=f[o],e=n[s],e&&(e[u]=[],i(e,r,u))}function r(t,r){var u=n[t],v,s,y,l,e,h,c;if(u)if(v=u.downloadScript,u.downloadScript=!1,i(u,"suppliesCssFor","styleUrls"),i(u,"suppliesJsFor","scriptUrls"),u.loaded)f(t,r);else{if(r)for(u.queue.push(r),e=0;e<u.scriptUrls.length;e++)for(s in r)typeof r[s]=="string"&&(y=new RegExp(s+"=[^&]+"),u.scriptUrls[e]=u.scriptUrls[e].replace(y,s+"="+r[s]));if(v&&u.loadOverrideCallback(t,r)!==!0){for(o.InternalNamespaceForDelay=a,l=u.scriptUrls,e=0;e<l.length;e++)h=l[e],h&&(u.jsonDownloadCallback?ui.getObjectAsync(h,u.jsonDownloadCallback):ui.downloadScript(h));for(c=u.styleUrls,e=0;e<c.length;e++)c[e]&&ui.downloadStyles(c[e])}}}function u(n,t){for(var i=n.length;i--;)n[i].indexOf("/")==-1&&(n[i]=t+n[i])}function f(n,t){typeof t.callback=="function"?t.callback(n):t.obj&&t.obj[t.name].apply(t.obj,t.args)}var n={};this.register=function(i,r,f,e){var o=f?f:{},s=n[i]={key:i,downloadScript:!0,loaded:!1,queue:[],scriptUrls:(o.extraScripts||[]).concat(r),styleUrls:o.styleUrls?o.styleUrls:[],jsonDownloadCallback:typeof o.jsonDownloadCallback=="function"?o.jsonDownloadCallback:null,loadOverrideCallback:typeof o.loadOverrideCallback=="function"?o.loadOverrideCallback:function(){return!1},suppliesCssFor:o.suppliesCssFor,suppliesJsFor:o.suppliesJsFor};e!==!1&&(u(s.scriptUrls,t.jsPath),u(s.styleUrls,t.cssPath))},this.add=function(n,t,i,u){r(n,t?{obj:t,name:i,args:u}:null)},this.load=function(n,t){PRF.start(n),r(n,t||{})},this.getRegistration=function(t){return n[t]},this.reset=function(t){var i=n[t];i.downloadScript=!0,i.queue=[],i.loaded=!1},this.done=function(t){var r=n[t],u,i,s,e,h;if(r){for(r.loaded=!0,u=r.queue,i=0;i<u.length;i++)s=u[i],f(t,s);e=0;for(h in n)n.hasOwnProperty(h)&&++e;e===0&&delete o.InternalNamespaceForDelay}}},o.loadModule=tt.load,o.registerModule=function(n,t,i){tt.register(n,t,i,!1)},o.moduleLoaded=tt.done,a.Dynamic=tt,o.Globals.disableDirections===!1&&tt.register("Microsoft.Maps.Directions","veapiDirections.js",{styleUrls:["mapDirections.css"]}),o.Globals.disableStreetside===!1&&tt.register("Microsoft.Maps.Streetside","veapistreetside.js",{styleUrls:["mapstreetside.css"]}),o.Globals.disableVenueMaps===!1&&tt.register("Microsoft.Maps.VenueMaps","veapiVenueMaps.js",{styleUrls:["venuemaps.css"]}),o.Globals.disableMicroPOI===!1&&tt.register("Microsoft.Maps.MicroPOI","veapiMicroPOI.js",{styleUrls:["veapiMicroPOI.css"]}),o.Globals.disableAnalytics===!1&&tt.register("Microsoft.Maps.Analytics","veapiAnalytics.js"),o.Globals.disableSearch===!1&&tt.register("Microsoft.Maps.Search","veapiSearch.js",{styleUrls:["search.css"]}),o.Globals.disableTasks===!1&&(tt.register("Microsoft.Maps.Tasks","veapiTasks.js"),tt.register("Microsoft.Maps.LocalScout","veapiLocalScout.js",{styleUrls:["search.css"]})),o.Globals.disableMyPlaces===!1&&tt.register("Microsoft.Maps.MyPlaces","veapiMyPlaces.js"),o.Globals.jsonTimeStamp){var br="en-us",kr="US",dr="http://ecn.dev.virtualearth.net/mapcontrol/mapconfiguration.ashx?name=wwa&v=7.0.2wwa&culture={culture}&homeRegion={homeRegion}";u.useXHR&&(br=Windows.ApplicationModel.Resources.Core.ResourceManager.current.defaultContext.languages[0],kr=Windows.System.UserProfile.GlobalizationPreferences.homeGeographicRegion),ci.UpdateCulture(br,kr),dr=dr.replace("{culture}",br).replace("{homeRegion}",kr),tt.register("Microsoft.Maps.Map",dr,{jsonDownloadCallback:nu.parse,loadOverrideCallback:nu.tryCachedGlobals})}tt.register("Microsoft.Maps.Traffic","veapiTraffic.js",{styleUrls:["traffic.css"]}),tt.register("Microsoft.Maps.Overlays.Style","veapiOverlayStyleV2.js",{styleUrls:["veapiOverlayStyleV2.css"],version:"v2"}),tt.register("Microsoft.Maps.Themes.BingTheme","veapiBingTheme.js",{styleUrls:["veapiBingTheme.css"],suppliesCssFor:["Microsoft.Maps.Overlays"]}),tt.register("Microsoft.Maps.AdvancedShapes","veapiAdvancedShapes.js"),l={LOGE2:Math.log(2),ILOGE2:1/Math.log(2),degreesPerRadian:180/Math.PI,radiansPerDegree:Math.PI/180,log2:function(n){return Math.log(n)/l.LOGE2},ceilLog2:function(n){return Math.ceil(Math.log(n)*l.ILOGE2)},lerpDouble:function(n,t,i){return n+i*(t-n)},normalizeDegrees:function(n){return(n%360+360)%360},distanceDegrees:function(n,t){var i=l.normalizeDegrees(n-t);return Math.min(i,360-i)},lerpAngle:function(n,t,i){var r=l.normalizeDegrees(n-t);return r>180&&(r=r-360),t+(1-i)*r},degreesToRadians:function(n){return n*l.radiansPerDegree},radiansToDegrees:function(n){return n*l.degreesPerRadian}},a.VectorMath=l,r.prototype={normalize:function(){var t=this.getLength(),n;return t===0?point:(n=1/t,new r(this.x*n,this.y*n,this.z*n))},isZero:function(){return this.x===0&&this.y===0&&this.z===0},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},toPoint:function(){return new i(this.x,this.y)},clone:function(){return new r(this.x,this.y,this.z)},toString:function(){return"[Point3D "+this.x+","+this.y+","+this.z+"]"}},r.add=function(n,t){return new r(n.x+t.x,n.y+t.y,n.z+t.z)},r.subtract=function(n,t){return new r(n.x-t.x,n.y-t.y,n.z-t.z)},r.multiply=function(n,t){return new r(t*n.x,t*n.y,t*n.z)},r.dot=function(n,t){return n.x*t.x+n.y*t.y+n.z*t.z},r.cross=function(n,t){return new r(n.y*t.z-n.z*t.y,n.z*t.x-n.x*t.z,n.x*t.y-n.y*t.x)},r.distanceSquared=function(n,t){var i=n.x-t.x,r=n.y-t.y,u=n.z-t.z;return i*i+r*r+u*u},r.lerp=function(n,t,i){return new r(n.x+(t.x-n.x)*i,n.y+(t.y-n.y)*i,n.z+(t.z-n.z)*i)},r.areEqual=function(n,t){return n&&t&&n.x===t.x&&n.y===t.y&&n.z===t.z},r.areAlmostEqual=function(n,t){return n&&t&&Math.abs(n.x-t.x)<et&&Math.abs(n.y-t.y)<et&&Math.abs(n.z-t.z)<et},a.Point3D=r,pt.prototype={clone:function(){return new pt(this.width,this.height)},toString:function(){return"[Size "+this.width+","+this.height+"]"}},pt.clone=function(n){return new pt(n.width,n.height)},pt.areEqual=function(n,t){return n&&t&&n.width===t.width&&n.height===t.height},a.Size=pt,ct.prototype={getRight:function(){return this.x+this.width},getBottom:function(){return this.y+this.height},getCenter:function(){return new i(this.x+this.width/2,this.y+this.height/2)},contains:function(n){return n.x>=this.x&&n.y>=this.y&&n.x<=this.getRight()&&n.y<=this.getBottom()},clone:function(){return new ct(this.x,this.y,this.width,this.height)},toString:function(){return"[Rect "+this.x+","+this.y+" "+this.width+","+this.height+"]"}},ct.union=function(){for(var u=ki(arguments[0])?arguments[0]:arguments,t=u[0],i=t.x,r=t.y,f=t.x+(t.width?t.width:0),e=t.y+(t.height?t.height:0),o=u.length,n;o--;)n=u[o],i=Math.min(i,n.x),r=Math.min(r,n.y),f=Math.max(f,n.x+(n.width?n.width:0)),e=Math.max(e,n.y+(n.height?n.height:0));return new ct(i,r,f-i,e-r)},ct.intersect=function(n,t){return!(n.getRight()<t.x||t.getRight()<n.x||n.getBottom()<t.y||t.getBottom()<n.y)},ct.areEqual=function(){return},a.Rect=ct,wt.prototype={transform:function(n){return new i(n.x*this.m11+n.y*this.m21+this.offsetX,n.x*this.m12+n.y*this.m22+this.offsetY)},invert:function(){var n=this.m11*this.m22-this.m12*this.m21;if(n===0)throw"matrix cannot be inverted";return new wt(this.m22/n,-1*this.m12/n,-1*this.m21/n,this.m11/n,(this.offsetY*this.m21-this.offsetX*this.m22)/n,(this.offsetX*this.m12-this.offsetY*this.m11)/n)},clone:function(){return new wt(this.m11,this.m12,this.m21,this.m22,this.offsetX,this.offsetY)},toString:function(){return"[Matrix "+this.m11+", "+this.m12+", "+this.m21+", "+this.m22+", "+this.offsetX+", "+this.offsetY+"]"}},wt.multiply=function(n,t){return new wt(n.m11*t.m11+n.m12*t.m21,n.m11*t.m12+n.m12*t.m22,n.m21*t.m11+n.m22*t.m21,n.m21*t.m12+n.m22*t.m22,n.offsetX*t.m11+n.offsetY*t.m21+t.offsetX,n.offsetX*t.m12+n.offsetY*t.m22+t.offsetY)},wt.unitToPoints=function(n,t,i){return new wt(t.x-n.x,t.y-n.y,i.x-n.x,i.y-n.y,n.x,n.y)},wt.conversion=function(n,t,i,r,u,f){var e=wt.unitToPoints(n,t,i).invert(),o=wt.unitToPoints(r,u,f);return wt.multiply(e,o)},a.Matrix=wt,e.prototype={multiplyBy:function(n){var t=this.m11,i=this.m12,r=this.m13,u=this.m14,f=this.m21,e=this.m22,o=this.m23,s=this.m24,h=this.m31,c=this.m32,l=this.m33,a=this.m34,v=this.offsetX,y=this.offsetY,p=this.offsetZ,w=this.m44;this.m11=t*n.m11+i*n.m21+r*n.m31+u*n.offsetX,this.m12=t*n.m12+i*n.m22+r*n.m32+u*n.offsetY,this.m13=t*n.m13+i*n.m23+r*n.m33+u*n.offsetZ,this.m14=t*n.m14+i*n.m24+r*n.m34+u*n.m44,this.m21=f*n.m11+e*n.m21+o*n.m31+s*n.offsetX,this.m22=f*n.m12+e*n.m22+o*n.m32+s*n.offsetY,this.m23=f*n.m13+e*n.m23+o*n.m33+s*n.offsetZ,this.m24=f*n.m14+e*n.m24+o*n.m34+s*n.m44,this.m31=h*n.m11+c*n.m21+l*n.m31+a*n.offsetX,this.m32=h*n.m12+c*n.m22+l*n.m32+a*n.offsetY,this.m33=h*n.m13+c*n.m23+l*n.m33+a*n.offsetZ,this.m34=h*n.m14+c*n.m24+l*n.m34+a*n.m44,this.offsetX=v*n.m11+y*n.m21+p*n.m31+w*n.offsetX,this.offsetY=v*n.m12+y*n.m22+p*n.m32+w*n.offsetY,this.offsetZ=v*n.m13+y*n.m23+p*n.m33+w*n.offsetZ,this.m44=v*n.m14+y*n.m24+p*n.m34+w*n.m44},transform:function(n,t){var u=n.x*this.m11+n.y*this.m21+this.offsetX,f=n.x*this.m12+n.y*this.m22+this.offsetY,e=n.x*this.m13+n.y*this.m23+this.offsetZ,i;return n.z&&(u+=n.z*this.m31,f+=n.z*this.m32,e+=n.z*this.m33),(this.m14!==0||this.m24!==0||this.m34!==0||this.m44!==1)&&(i=n.x*this.m14+n.y*this.m24+(n.z?n.z:0)*this.m34+this.m44,t&&(i=Math.max(t,i)),u/=i,f/=i,e/=i),new r(u,f,e)},invert:function(){var s=this.m11,a=this.m12,v=this.m13,y=this.m14,h=this.m21,p=this.m22,w=this.m23,b=this.m24,c=this.m31,k=this.m32,d=this.m33,g=this.m34,l=this.offsetX,nt=this.offsetY,tt=this.offsetZ,it=this.m44,t=v*b-w*y,i=v*g-d*y,r=v*it-tt*y,u=w*g-d*b,f=w*it-tt*b,o=d*it-tt*g,ut=p*i-k*t-a*u,ft=a*f-p*r+nt*t,et=k*r-nt*i-a*o,ot=p*o-k*f+nt*u,rt=l*ut+c*ft+h*et+s*ot;if(rt===0||!isFinite(rt))throw"InvalidOperation: Matrix3D.invert";var st=s*u-h*i+c*t,ht=h*r-l*t-s*f,ct=s*o-c*r+l*i,lt=c*f-l*u-h*o;t=s*p-h*a,i=s*k-c*a,r=s*nt-l*a,u=h*k-c*p,f=h*nt-l*p,o=c*nt-l*k;var at=v*u-w*i+d*t,vt=w*r-tt*t-v*f,yt=v*o-d*r+tt*i,pt=d*f-tt*u-w*o,wt=b*i-g*t-y*u,bt=y*f-b*r+it*t,kt=g*r-it*i-y*o,dt=b*o-g*f+it*u,n=1/rt;return new e(ot*n,et*n,ft*n,ut*n,lt*n,ct*n,ht*n,st*n,dt*n,kt*n,bt*n,wt*n,pt*n,yt*n,vt*n,at*n)},projectOnPlane:function(n){var t=this,f=n.a*t.m11+n.b*t.m12+n.c*t.m13-n.d*t.m14,o=n.a*t.m21+n.b*t.m22+n.c*t.m23-n.d*t.m24,r=n.a*t.m31+n.b*t.m32+n.c*t.m33-n.d*t.m34,s=n.a*t.offsetX+n.b*t.offsetY+n.c*t.offsetZ-n.d*t.m44,i,u;if(r===0)throw"InvalidOperation: Matrix3D.projectOnPlane";return i=-1/r,u=new e(1,0,f*i,0,0,1,o*i,0,0,0,1,0,0,0,s*i,1),e.multiply(u,this)},clone:function(){return new e(this.m11,this.m12,this.m13,this.m14,this.m21,this.m22,this.m23,this.m24,this.m31,this.m32,this.m33,this.m34,this.offsetX,this.offsetY,this.offsetZ,this.m44)},toString:function(){return"[Matrix3D "+this.m11+","+this.m12+","+this.m13+","+this.m14+", "+this.m21+","+this.m22+","+this.m23+","+this.m24+", "+this.m31+","+this.m32+","+this.m33+","+this.m34+", "+this.offsetX+","+this.offsetY+","+this.offsetZ+","+this.m44+"]"}},e.multiply=function(){for(var i=arguments.length,t=arguments[0].clone(),n=1;n<i;n++)t.multiplyBy(arguments[n]);return t},e.identity=function(){return new e(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},e.translation=function(n){var t=arguments.length==3;return new e(1,0,0,0,0,1,0,0,0,0,1,0,t?arguments[0]:n.x,t?arguments[1]:n.y,t?arguments[2]:n.z,1)},e.scaling=function(n,t,i){var r=new e(n,0,0,0,0,n,0,0,0,0,n,0,0,0,0,1);return arguments.length==3&&(r.m22=t,r.m33=i),r},e.rotationX=function(n){var t=n*l.radiansPerDegree,i=Math.sin(t),r=Math.cos(t);return new e(1,0,0,0,0,r,i,0,0,-i,r,0,0,0,0,1)},e.rotationY=function(n){var t=n*l.radiansPerDegree,i=Math.sin(t),r=Math.cos(t);return new e(r,0,-i,0,0,1,0,0,i,0,r,0,0,0,0,1)},e.rotationZ=function(n){var t=n*l.radiansPerDegree,i=Math.sin(t),r=Math.cos(t);return new e(r,i,0,0,-i,r,0,0,0,0,1,0,0,0,0,1)},a.Matrix3D=e,fi.prototype={intersectWithLine:function(n,t){var i=r.subtract(t,n),f=this.d-this.a*n.x-this.b*n.y-this.c*n.z,u=this.a*i.x+this.b*i.y+this.c*i.z;if(u===0)throw"InvalidOperation: Plane3D.intersectWithLine";return r.add(n,r.multiply(i,f/u))},clone:function(){return new fi(this.a,this.b,this.c,this.d)},toString:function(){return"[Plane3D]"}},fi.fromPoints=function(n,t,i){var f=r.subtract(i,t),e=r.subtract(t,n),u=r.cross(f,e);return u=u.normalize(),fi.fromNormal(n,u)},fi.fromNormal=function(n,t){return new fi(t.x,t.y,t.z,r.dot(t,n))},fi.areEqual=function(n,t){return n.a===t.a&&n.b===t.b&&n.c===t.c&&n.d===t.d},a.Plane3D=fi,ti.prototype={dot:function(n){return this.x*n.x+this.y*n.y},perp:function(){return new ti(this.y,-this.x)},normalize:function(){var n,t;return(n=this.length(),n<MathHelper.zeroTolerance)?new ti(0,0):(t=1/n,new ti(this.x*t,this.y*t))},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSquared:function(){return this.x*this.x+this.y*this.y},add:function(n){return new ti(this.x+n.x,this.y+n.y)},subtract:function(n){return new ti(this.x-n.x,this.y-n.y)},multiplyScalar:function(n){return new ti(this.x*n,this.y*n)},equals:function(n){return this.x===n.x&&this.y===n.y},toString:function(){return"["+this.x+", "+this.y+"]"}},a.Vector2=ti,nt={earthRadiusInMeters:6378137,earthCircumferenceInMeters:12756274*Math.PI,northUpHeading:0,eastUpHeading:90,southUpHeading:180,westUpHeading:270,enhancedBirdseyePitch:-l.degreesPerRadian*Math.asin(180/256),earthMinorAxisRadiusInMeters:6356752.3142,flatteningOfEllipsoidWGS84:1/298.2572235631,snapToCardinalHeading:function(n){var t=Math.round(n/90);return t=(t%4+4)%4,t*90},locationRectToMercatorZoom:function(n,i){var r=i.width/360,u=Math.abs(c.latitudeToY(i.getNorth())-c.latitudeToY(i.getSouth())),f=Math.min(n.width/(t.zoomOriginWidth*r),n.height/(t.zoomOriginWidth*u));return l.log2(f)},getMercatorCenter:function(n){var t=n.center;return new v(c.yToLatitude((c.latitudeToY(n.getNorth())+c.latitudeToY(n.getSouth()))/2),t.longitude,t.altitude,t.altitudeReference)},getMercatorFootprint:function(n,t){for(var r=t.width/2,u=t.height/2,f=[new i(-r,-u),new i(r,-u),new i(r,u),new i(-r,u)],h=n.getViewportToWorld(),s=n.getCrs(),e,o=f.length;o--;)e=h.transform(f[o]),f[o]=s===c?e:c.fromLocation(s.toLocation(e));return f}},a.MapMath=nt,c={latitudeLimit:85.051128,invFourPi:1/(4*Math.PI),unitsPerMeterAtEquator:1/nt.earthCircumferenceInMeters,toLocation:function(n){var t=c.yToLatitude(n.y);return new v(t,(n.x-.5)*360,n.z?c.unitsToMetersAtLatitude(t,n.z):0,ht.ellipsoid)},fromLocation:function(n){return new r(n.longitude/360+.5,c.latitudeToY(n.latitude),c.metersToUnitsAtLatitude(n.latitude,n.altitude))},wrap:function(n,t){var i=n.x,u=t?t.x:.5;return new r(i<u-.5||i>u+.5?i-Math.floor(i-u+.5):i,n.y,n.z)},getUpVector:function(){return new r(0,0,1)},getNadirMatrix:function(n){return new e(1,0,0,0,0,1,0,0,0,0,-1,0,-n.x,-n.y,n.z,1)},unitsToMeters:function(n,t){var i=c.yToLatitude(n.y);return c.unitsToMetersAtLatitude(i,t)},metersToUnits:function(n,t){var i=c.yToLatitude(n.y);return c.metersToUnitsAtLatitude(i,t)},changeAltitude:function(n,t){var i=c.yToLatitude(n.y),u=c.metersToUnitsAtLatitude(i,t);return new r(n.x,n.y,u)},unitsToMetersAtLatitude:function(n,t){return t===0?0:t*Math.cos(n*l.radiansPerDegree)/c.unitsPerMeterAtEquator},metersToUnitsAtLatitude:function(n,t){return t===0?0:t*c.unitsPerMeterAtEquator/Math.cos(n*l.radiansPerDegree)},yToLatitude:function(n){return 90-2*Math.atan(Math.exp((n*2-1)*Math.PI))*l.degreesPerRadian},latitudeToY:function(n){if(n>=c.latitudeLimit)return 0;if(n<=-c.latitudeLimit)return 1;var t=Math.sin(n*l.radiansPerDegree);return.5-Math.log((1+t)/(1-t))*this.invFourPi}},a.MercatorCube=c,er=new function(){var t=1/298.257222101,i=t*(2-t),u=1/(1-i),n=nt.earthRadiusInMeters,f=new r(0,0,-n);this.toLocation=function(r){var p=r.x,w=r.y,e=r.z,b,k,c,a,y,o,s=Math.sqrt(p*p+w*w),f=e,u,h,d;for(k=Math.atan2(w,p),u=s*(1-t),h=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),a=f*h,y=u*h,o=n,c=s>1?s/y-o:e>0?e-n*(1-t):-e-n*(1-t),d=3;d--;)u=s*(1-i*o/(o+c)),h=1/Math.sqrt(f*f+u*u),b=Math.atan2(f,u),a=f*h,y=u*h,o=n/Math.sqrt(1-i*a*a),c=s>1?s/y-o:e>0?e-n*(1-t):-e-n*(1-t);return new v(b*l.degreesPerRadian,k*l.degreesPerRadian,c,ht.ellipsoid)},this.fromLocation=function(t){var o=t.latitude*l.radiansPerDegree,s=t.longitude*l.radiansPerDegree,u=t.altitude,f=Math.sin(o),h=Math.cos(o),c=Math.sin(s),a=Math.cos(s),e=n/Math.sqrt(1-i*f*f);return new r((e+u)*h*a,(e+u)*h*c,(e*(1-i)+u)*f)},this.wrap=function(){return wrap.clone()},this.getUpVector=function(n){return new r(n.x,n.y,n.z*u).normalize()},this.getNadirMatrix=function(n){var t,i=this.getUpVector(n),o=r.multiply(i,-1),s=r.cross(i,r.subtract(f,n)),u;return t=s.isZero()?new r(1,0,0):r.cross(s,i).normalize(),u=r.cross(i,t),e.multiply(e.translation(-n.x,-n.y,-n.z),new e(u.x,t.x,o.x,0,u.y,t.y,o.y,0,u.z,t.z,o.z,0,0,0,0,1))},this.unitsToMeters=function(n,t){return t},this.metersToUnits=function(n,t){return t},this.changeAltitude=function(n,t){var i=self.toLocation(n);return i.altitude=t,self.fromLocation(i)}},it.prototype={getParent:function(){return new it(this.levelOfDetail-1,Math.floor(this.x/2),Math.floor(this.y/2))},clone:function(){return new it(this.levelOfDetail,this.x,this.y)},getSibling:function(n,t){var r=1<<this.levelOfDetail,u=this.x+n,i;return u<0?u+=r:u>=r&&(u-=r),i=this.y+t,i<0?i=0:i>=r&&(i=r-1),new it(this.levelOfDetail,u,i)},toString:function(){return"[TileId "+this.levelOfDetail+" "+this.x+","+this.y+"]"}},it.areEqual=function(n,t){return n&&t&&n.levelOfDetail===t.levelOfDetail&&n.x===t.x&&n.y===t.y},a.TileId=it,f.prototype={convertCoordinateReferenceSystem:function(n){if(n!==this.getCrs()){var t=n.fromLocation(this.getCrs().toLocation(this.getLookAt()));return new f(n,t,n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),this.getWidth())),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse()<et?0:1/n.metersToUnits(t,this.getCrs().unitsToMeters(this.getLookAt(),1/this.getDistanceInverse())),s,s,this.getZoomOriginWidth())}return this.clone()},clone:function(){return new f(this.getCrs(),this.getLookAt().clone(),this.getWidth(),this.getHeading(),this.getPitch(),this.getRoll(),this.getDistanceInverse(),this.getZoomDelta(),this.getPerspectiveOrigin().clone(),this.getZoomOriginWidth())},toString:function(){return"[MapCamera]"}},f.smallWidthRatioDiff=.1,f.smallAngle=1,f.smallPixelDistance=2,f.simpleGround=new fi(0,0,1,0),f.simpleWorldToFrustumNoZ=e.identity(),f.fromDirectionVector=function(n,t,i,u,o,s){var y,a;var p=n.getNadirMatrix(t),h=p.transform(r.add(t,u)).normalize(),c=0;(h.x!==0||h.y!==0)&&(directionXY=new r(h.x,h.y,0).normalize(),c=Math.acos(r.dot(directionXY,new r(0,-1,0)))*l.degreesPerRadian,directionXY.x<0&&(c=360-c));var w=(Math.PI/2-Math.acos(r.dot(h,new r(0,0,-1))))*l.degreesPerRadian,a=0,b=e.multiply(p,e.rotationZ(-c),e.rotationX(-(w+90))),v=b.transform(r.add(t,o));return(v.x!=0||v.y!=0)&&(y=new r(v.x,v.y,0).normalize(),a=Math.acos(r.dot(y,new r(0,-1,0)))*l.degreesPerRadian,y.x<0&&(a=360-a)),new f(n,t,i,c,w,a,s)},f.mercatorZoomToWidth=function(n,t,i){var r=1/Math.pow(2,n);return t===c?r:t.metersToUnits(i,c.unitsToMeters(c.fromLocation(t.toLocation(i)),r))},f.widthToMercatorZoom=function(n,t,i){var r=t===c?n:c.metersToUnits(c.fromLocation(t.ToLocation(i)),t.unitsToMeters(i,n));return l.log2(1/r)},f.snapSmallDifferences=function(n,i){n.getCrs()!==i.getCrs()&&(n=i.convertCoordinateReferenceSystem(i.getCrs()));var s=Math.max(n.getWidth(),i.getWidth())/t.zoomOriginWidth,u=s*f.smallPixelDistance,e=u*u,o=new f(n.getCrs(),r.distanceSquared(i.getLookAt(),n.getLookAt())>e?n.getLookAt():i.getLookAt(),Math.abs(i.getWidth()/n.getWidth()-1)>f.smallWidthRatioDiff?n.getWidth():i.getWidth(),Math.abs(n.getHeading()-i.getHeading())>f.smallAngle?n.getHeading():i.getHeading(),Math.abs(n.getPitch()-i.getPitch())>f.smallAngle?n.getPitch():i.getPitch(),Math.abs(n.getRoll()-i.getRoll())>f.smallAngle?n.getRoll():i.getRoll(),Math.abs(n.getDistanceInverse()-i.getDistanceInverse())>et?n.getDistanceInverse():i.getDistanceInverse(),Math.abs(n.getZoomDelta()-i.getZoomDelta())>f.smallWidthRatioDiff?n.getZoomDelta():i.getZoomDelta(),r.distanceSquared(i.getPerspectiveOrigin(),n.getPerspectiveOrigin())>e?n.getPerspectiveOrigin():i.getPerspectiveOrigin(),n.getZoomOriginWidth());return f.areEqual(o,n)?n:o},f.lerp=function(n,t,i){var u=i,e=t.getWidth()/n.getWidth();return Math.abs(e-1)>f.smallWidthRatioDiff&&(u=(Math.pow(e,i)-1)/(e-1)),new f(t.getCrs(),r.lerp(n.getLookAt(),t.getLookAt(),u),l.lerpDouble(n.getWidth(),t.getWidth(),u),l.lerpAngle(n.getHeading(),t.getHeading(),i),l.lerpAngle(n.getPitch(),t.getPitch(),i),l.lerpAngle(n.getRoll(),t.getRoll(),i),l.lerpDouble(n.getDistanceInverse(),t.getDistanceInverse(),i),l.lerpDouble(n.getZoomDelta(),t.getZoomDelta(),i),r.lerp(n.getPerspectiveOrigin(),t.getPerspectiveOrigin(),u),n.getZoomOriginWidth())},f.areAligned=function(n,t){return n&&t&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()},f.areEqual=function(n,t){return n&&t&&(n===t||r.areEqual(n.getLookAt(),t.getLookAt())&&n.getWidth()===t.getWidth()&&n.getHeading()===t.getHeading()&&n.getPitch()===t.getPitch()&&n.getRoll()===t.getRoll()&&n.getDistanceInverse()===t.getDistanceInverse()&&n.getZoomDelta()===t.getZoomDelta()&&r.areEqual(n.getPerspectiveOrigin(),t.getPerspectiveOrigin()))},a.MapCamera=f,ft={mercator:new f(c,new r(.5,.5,0),1),enhancedBirdseyeNorthUp:new f(c,new r(.5,.5,0),1,nt.northUpHeading,nt.enhancedBirdseyePitch),enhancedBirdseyeEastUp:new f(c,new r(.5,.5,0),1,nt.eastUpHeading,nt.enhancedBirdseyePitch),enhancedBirdseyeSouthUp:new f(c,new r(.5,.5,0),1,nt.southUpHeading,nt.enhancedBirdseyePitch),enhancedBirdseyeWestUp:new f(c,new r(.5,.5,0),1,nt.westUpHeading,nt.enhancedBirdseyePitch)},a.StandardMapCameras=ft,a.MemoryCache=yi,g={tileIdToCacheKey:function(n){return n.levelOfDetail+"~"+n.x+"~"+n.y},latLonToMercatorXY:function(n,t){var r=t/360+.5;return r-=Math.floor(r),new i(r,c.latitudeToY(n))},mercatorXYToTileId:function(n,t){var i=1<<t;return new it(t,Math.floor(n.x*i),Math.floor(n.y*i))},mercatorXYToCacheKey:function(n,t){return g.tileIdToCacheKey(g.mercatorXYToTileId(n,t))},latLonToTileId:function(n,t,i){var r=g.latLonToMercatorXY(n,t);return g.mercatorXYToTileId(r,i)},latLonToCacheKey:function(n,t,i){return g.tileIdToCacheKey(g.latLonToTileId(n,t,i))},tileIdToMercatorXY:function(n){var t=1<<n.levelOfDetail;return new i((n.x+.5)/t,(n.y+.5)/t)},tileIdToLocation:function(n){var t=g.tileIdToMercatorXY(n);return c.toLocation(t)},normalizeMercatorBounds:function(n){n.width<1?n.x-=Math.floor(n.x):(n.x=0,n.width=1);var t=Math.min(n.getBottom(),1);n.y=Math.max(n.y,0),n.height=t-n.y}},a.SpatialCache=g,ot=new function(){function h(){var h,c,v;if(f.length&&k<1&&a){var u=f.shift(),t=u.topLeft,i=u.bottomRight,l=!0,w=t.x,b=i.x,d=t.y,nt=i.y,r=new it(t.levelOfDetail,0,0);for(h=d;h<=nt;h++){for(c=w;c<=b;c++)if(r.x=c,r.y=h,r=si.wrapX(r),e.get(g.tileIdToCacheKey(r))===s){l=!1;break}if(!l)break}if(l)n.invoke(u.requestHandle,"downloaded",{cacheHit:!0});else{v=1<<t.levelOfDetail,t.x-=o,t.y=Math.max(0,t.y-o),i.x+=o,i.y=Math.min(v-1,i.y+o);var y=g.tileIdToLocation(t),p=g.tileIdToLocation(i),tt=a.replace("{north}",y.latitude.toFixed(6)).replace("{west}",y.longitude.toFixed(6)).replace("{south}",p.latitude.toFixed(6)).replace("{east}",p.longitude.toFixed(6)).replace("{cols}",i.x-t.x+1).replace("{rows}",i.y-t.y+1);k++,ui.getObjectAsync(tt,at,{topLeft:t,bottomRight:i,requestHandle:u.requestHandle})}}}function at(t,i){var o,s;if(i.success){var f=i.userData.topLeft,l=i.userData.bottomRight,a=f.x,v=l.x,y=f.y,p=l.y,c=t.alt;if(c&&c.length===(p-y+1)*(v-a+1)){var r=new it(f.levelOfDetail,0,0),u,b=0,w=0;for(o=y;o<=p;o++)for(s=a;s<=v;s++)for(w+=c[b++],r.x=s,r.y=o,r=si.wrapX(r),u=r;u.levelOfDetail>=f.levelOfDetail-rt;){if(e.insert(g.tileIdToCacheKey(u),w))break;u=u.getParent()}d++,n.invoke(i.userData.requestHandle,"downloaded",{cacheHit:!1})}}k--,h()}function ot(n){return Math.floor(Math.min(n+y,tt))}var u=this,a,y=l.log2(t.zoomOriginWidth/64),w=10+y,tt=20+y,rt=6,e=new yi(5e3),f=[],k=0,d=0,o=4,st=3,lt=new r(0,0,1),ut=p+"ellipsoid",ft;this.authenticate=function(n){ft||(ft=!0,n(function(n){n&&(a=t.elevationServiceUrl.replace("{credentials}",n),h())}))},this.getAltitudeAtLatLon=function(n,t){return u.getAltitudeAtMercatorXY(g.latLonToMercatorXY(n,t))},this.getAltitudeForTile=function(n){return e.get(g.tileIdToCacheKey(n))},this.getApproximateAltitudeForTile=function(n){var t=e.get(g.tileIdToCacheKey(n)),i,r;if(t!==s)return t;for(i=-1;i<2;i++)for(r=-1;r<2;r++)if(t=e.get(g.tileIdToCacheKey(n.getSibling(i,r)),!1),t!==s)return t},this.getAltitudeAtMercatorXY=function(n){for(var r=g.mercatorXYToTileId(n,tt),f,i;r.levelOfDetail>=1;){if(f=u.getApproximateAltitudeForTile(r),f!==s){var e=r.levelOfDetail,k=1<<e,t=n.x*k-.5,h=n.y*k-.5,c=Math.floor(t),l=Math.ceil(t),y=Math.floor(h),p=Math.ceil(h),w=u.getAltitudeForTile(new it(e,c,y)),a=u.getAltitudeForTile(new it(e,l,y)),b=u.getAltitudeForTile(new it(e,c,p)),v=u.getAltitudeForTile(new it(e,l,p)),o;return w!==s?o=a!==s?w*(l-t)+a*(t-c):w:a!==s&&(o=a),b!==s?i=v!==s?b*(l-t)+v*(t-c):b:v!==s&&(i=v),o!==s?f=i!==s?o*(p-h)+i*(h-y):o:i!==s&&(f=i),f}r=r.getParent()}return 0},this.rayToGround=function(n,t,i){if(Math.abs(t.x-i.x)<=et&&Math.abs(t.y-i.y)<=et)return n.changeAltitude(t,u.getAltitudeAtMercatorXY(t));for(var e,r,o,f=t,s=st;s--;){if(r=u.getAltitudeAtMercatorXY(f),Math.abs(e-r)<1)break;e=r,o=fi.fromNormal(n.changeAltitude(f,r),lt),f=o.intersectWithLine(t,i)}return f},this.toEllipsoid=function(n,t){var i,r,f;return n.altitudeReference===ht.ellipsoid?n:t?new v(n.latitude,n.longitude,0,ht.ellipsoid):(i=n[ut],i&&i.latitude===n.latitude&&i.longitude===n.longitude&&i.forAltitude===n.altitude&&i.forAltitudeReference===n.altitudeReference&&i.forGeneration===d)?i:(r=u.getAltitudeAtLatLon(n.latitude,n.longitude),f=n.altitudeReference===ht.ground?n.altitude+r:r,i=new v(n.latitude,n.longitude,f,ht.ellipsoid),i.forAltitude=n.altitude,i.forAltitudeReference=n.altitudeReference,i.forGeneration=d,n[ut]=i,i)},this.isElevationAvailableAtLatLon=function(n,t,i){var f=ot(i),r,e;if(f<w)return!0;for(r=g.latLonToTileId(n,t,f),e=rt;e--;){if(u.getApproximateAltitudeForTile(r)!==s)return!0;r=r.getParent()}return!1},this.adjustCameraElevation=function(n){var t=n.getLookAt(),i=u.rayToGround(n.getCrs(),t,n.getViewportToWorld().transform(new r(0,0,1)));return r.areAlmostEqual(t,i)?n:n.getAlignedCamera(0,i)},this.downloadElevationData=function(n,t){var u,r;if(u=ot(n.getMercatorZoom()),u>=w){r=ct.union(nt.getMercatorFootprint(n,t)),g.normalizeMercatorBounds(r);var o=g.mercatorXYToTileId(r,u),s=g.mercatorXYToTileId(new i(r.getRight(),r.getBottom()),u),e={};return f.push({topLeft:o,bottomRight:s,requestHandle:e}),b.dispatch(h),e}},this.downloadElevationDataForLocationRect=function(n,t){if(t=t||19,t>=w){var r=n.getNorth(),u=n.getWest(),e=n.getSouth(),o=n.getEast(),s=g.latLonToTileId(r,u,t),c=g.latLonToTileId(e,o,t),i={};return f.push({topLeft:s,bottomRight:c,requestHandle:i}),b.dispatch(h),i}},this.cancelDownload=function(n){if(n)for(var t=f.length;t--;)f[t].requestHandle===n&&f.splice(t,1)}},a.ElevationService=ot,lt.nativeMercatorCamera=ft.mercator.getAlignedCamera(t.minMercatorZoom),lt.createMercatorScene=function(n,i,r,u){var f=null;return n&&(f=kt.createQuadKeyTilePyramid(t.defaultTileSize,t.defaultTileSize,n,st.horizontal,u),f.projectingCamera=ft.mercator),new lt(lt.nativeMercatorCamera,f,t.maxMercatorZoom-t.minMercatorZoom,i,r)},a.CompositeModeScene=lt,bt.entityRenderers=[],bt.registerEntityRenderer=function(t,i){var r={getRenderer:t,priority:i?i.priority:null};bt.entityRenderers.push(r),bt.entityRenderers._key="k"+pi.getNext(),i&&i.priority!==null&&bt.entityRenderers.sort(function(n,t){var u=0,i=n.priority,r=t.priority;return(i!==null||r!==null)&&(u=i!==null&&r!==null?i-r:i!==null?-1:1),u}),n.invoke(bt,"newEntityRenderer")},bt.getEntityRenderer=function(n,t){var f=bt.entityRenderers._key,i=t._cmRd,u,r;if(t._cmRdk!==f){for(i=null,u=bt.entityRenderers,r=0;r<u.length&&!i;r++)i=u[r].getRenderer(n,t);t._cmRd=i,t._cmRdk=f}return i},a.CompositeMode=bt,w=new function(){function r(){for(var u=k(),r=t.length,f,e,h;r--;){var o=t[r],c=y.Style.camelize(o),l=y.Style.get_camelized_style_name(o,u);u.style[l]!==s&&(n.Properties[c]=l,n.Attributes[c]=y.Style.get_css_style_name(o,u))}for(r=0;r<i.length;r++){f=i[r];for(e in f)if(e in u.style)for(h in f[e])n.Events[h]=f[e][h]}}var n=this,t,i;this.Properties={},this.Attributes={},this.Events={},t=["transform","transform-origin","transition","transition-delay","transition-property","transition-duration"],i=[{webkitTransition:{transitionEnd:"webkitTransitionEnd"}},{MozTransition:{transitionEnd:"MozTransitionEnd"}}],r()},h={none:0,allowed:1,readyForTarget:2,started:3,pendingCompletion:4},at.Default=new at(.25,.1,.25,1),at.Linear=new at(0,0,1,1),at.EaseIn=new at(.42,0,1,1),at.EaseOut=new at(0,0,.58,1),at.EaseInOut=new at(.42,0,.58,1),at.EaseOutIn=new at(0,.42,1,.58),at.Flick=new at(.2,.5,.35,1),ii=function(){function i(n){var i;if(!n[t]){for(newKey=(new Date).getTime();newKey in r;)newKey++;n[t]=newKey}return i=r[n[t]]||[],r[n[t]]=i,i}function u(n,t,r){for(var e=i(n),u=!1,o=e.length;o--&&!u;)u=e[o]===t,u&&r&&(e.splice(o,1),f(n));return u}function f(n){for(var f=i(n),e=f.length,h=new Date,r="",u="",o=!0,t,s;e--;)t=f[e],s=h-t.getStartTime(),o||(r+=", ",u+=" "),r+=t.getProperty()+" "+t.getDuration()+"s "+t.getTimingFunction().cssText,u+="-"+s+"ms",o=!1;n.style[w.Properties.transition]=r,n.style[w.Properties.transitionDelay]=u}function e(t,r,e){function p(){var n=t&&r&&e;!n}var o=this,c=t,v=e,l=r,a=new Date(0),s=0,h=null;this.getStartTime=function(){return a},this.getProperty=function(){return c},this.getTimingFunction=function(){return v},this.getDuration=function(){return l},this.setDuration=function(n){s==0&&(l=n)},this.applyAnimation=function(n){n&&!u(n,o)&&(i(n).push(o),s==0&&(a=new Date),s++,y(n).add_event(w.Events.transitionEnd,function(n){n.propertyName==c&&(y(this).remove_event(w.Events.transitionEnd,arguments.callee,!1),o.removeAnimation(this))},!1),f(n))},this.removeAnimation=function(t){t&&t!=h&&u(t,o,!0)&&(s--,h=t,n.invoke(t,"animationsequenceprogress",new bu(o,t,s>0,i(t).length>0)),h=null)},p()}var r={},t=p+"CssAnimationSequenceId";return e}(),ii.prototype={getElapsedTimeAsPercentage:function(){return(new Date-this.getStartTime())/(this.getDuration()*1e3)},getProgress:function(n){n==null&&(n=this.getElapsedTimeAsPercentage());var t=1/(400*this.getDuration());return this.getTimingFunction().getProgress(n,t)},duplicate:function(n,t,i){return new ii(n?n:this.getProperty(),t?t:this.getDuration(),i?i:this.getTimingFunction())}},ii.Transformer=u.allowCssAnimations&&new ii(w.Attributes.transform,.3,at.EaseInOut),ii.Flicker=u.allowCssAnimations&&ii.Transformer.duplicate(null,null,at.Flick),ii.TileFader=u.allowCssAnimations&&new ii("opacity",.3,at.Linear);var gr=function(){function i(){function f(n){if(r&&r.length)for(var t=r.length,i=!1;!i&&t--;)i=n(r[t])}function c(n){return n?n[u]:null}function l(n){n&&n.animationSequence&&!o&&f(function(t){if(t===n.animationSequence)return s(c(n.node),t),!0})}function s(t,r){t&&r&&i[t]&&i[t].remaining&&(o=!0,r.removeAnimation(i[t].node),o=!1,i[t].remaining--,i[t].remaining||(n.removeHandler(i[t].handler),i[t].node=null,i[t].handler=null,delete i[t],--e==0&&n.invoke(h,"animationscomplete",!1)))}var h=this,u=p+"CssAnimationGroupId"+ ++t,r=null,i={},e=0,o=!1;this.manageAnimations=function(n){var t,i;if(r&&h.removeAllAnimations(),r=n,t=r instanceof Array&&r.length>0,t)for(i=r.length;i--&&t;)t=r[i]instanceof ii;if(!t)throw"Must pass in a non-empty array of CssAnimationSequence objects";},this.addToGroup=function(t){var f,o;if(t){if(!t[u]){for(f=(new Date).getTime();f in i;)f++;t[u]=f}o=t[u],i[o]||(e++,i[o]={node:t,handler:n.addHandler(t,"animationsequenceprogress",l),remaining:r.length})}},this.applyAllAnimations=function(){f(function(n){for(var t in i)n.applyAnimation(i[t].node)})},this.removeAllAnimations=function(){f(function(n){for(var t in i)s(t,n)})},this.removeAnimations=function(n){f(function(t){s(c(n),t)})},this.hasPendingAnimations=function(){return e>0}}var t=0;return i}(),ri=new function(){function p(){var n=null,i=k(),t=w.Properties.transform,r;if(t&&t in a){r=a[t];try{i.style[t]="matrix(1,0,0,1,0,0)",l=r.p,n=r.f}catch(u){}}"opacity"in i.style&&(v=!0),n==null&&"filter"in i.style&&(n=b,c.requireFlowLayout=!0,y=!0,c.usingIEFilters=!0),n==null&&(n=g),c.setTransformAndOpacity=n}function h(n){if(n.offsetZ){for(var i=n.invert(),t=3;t--;)s[t]=i.transform(o[t]);return wt.conversion(s[0],s[1],s[2],o[0],o[1],o[2])}return n.m44==1?n:new wt(n.m11/n.m44,n.m12/n.m44,n.m21/n.m44,n.m22/n.m44,n.offsetX/n.m44,n.offsetY/n.m44)}function r(n){var t={};return t.position="absolute",t["white-space"]="nowrap",t["line-height"]="0",n&&(t.width=n.width.toFixed(0)+"px",t.height=n.height.toFixed(0)+"px"),t}function f(n){var t=[];for(styleKey in n)t.push(styleKey,":",n[styleKey],";");return t.join("")}function b(i,e,o,s){var k,d,a;s=s||{};var c=h(i),y=Math.round(c.m11*n)/n,g=Math.round(c.m22*n)/n,nt=Math.round(c.m12*n)/n,tt=Math.round(c.m21*n)/n,l=s.excludeCommonCss?{}:r(e),v=null,p,w;if(y==1&&nt==0&&tt==0&&g==1)p=c.offsetX.toFixed(0),w=c.offsetY.toFixed(0);else if(u.cssZoomAffectsTopLeft()||y!=g||nt!=0||tt!=0)k=Math.round(e.width/2),d=Math.round(e.height/2),p=-k,w=-d,a=wt.multiply(c,new wt(1,0,0,1,k,d)),v="progid:DXImageTransform.Microsoft.Matrix(FilterType=nearest,  M11="+a.m11.toFixed(t)+", M21="+a.m12.toFixed(t)+", M12="+a.m21.toFixed(t)+", M22="+a.m22.toFixed(t)+", dX="+a.offsetX.toFixed(0)+", dY="+a.offsetY.toFixed(0)+")";else{var b=Math.abs(y-1)>.02?Math.round(y*1e4)/1e4:1,it=c.invert(),rt=it.offsetX,ut=it.offsetY,p=-rt*b,w=-ut*b;b!=1&&(l.zoom=b)}return l.left=p+"px",l.top=w+"px",o<.01?l.display="none":(l.display="block",o<.99&&(v=(v==null?"":v+", ")+"alpha(opacity = "+(o*100).toFixed(0)+")")),v&&(l.filter=v),s.returnStyleObject?l:f(l)}function e(t,i,e,o){var s,y;o=o||{};var k=h(t),a=Math.round(k.m11*n)/n,v=Math.round(k.m22*n)/n,g=Math.round(k.m12*n)/n,d=Math.round(k.m21*n)/n,p=Math.round(k.offsetX*n)/n,b=Math.round(k.offsetY*n)/n,c=o.excludeCommonCss?{}:r(i);return a===1&&g===0&&d===0&&v===1?u.useTransform2d?(c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+p+"px,"+b+"px)"):(c.left=p+"px",c.top=b+"px"):(i&&u.isIE9&&a&&v&&d===0&&Math.abs(a-v)<.01&&(s=a-1,y=v-1,s<=.0102&&s>=-.009998&&(s<=.0079&&s>=-.0075?(p+=i.width*s*.5,b+=i.height*y*.5,a+=s*.2,v+=y*.2):s<=.009175&&s>=-.009086?(a+=s*.17,v+=y*.17,s>0&&a<1.0100995||s<0&&a>.99?(p+=i.width*s*.5,b+=i.height*y*.5):(p+=i.width*s*-.09,b+=i.height*y*-.09)):(p+=i.width*s*-.05,b+=i.height*y*-.05,a+=s*.1,v+=y*.1))),c[o.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",c[o.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix("+a+","+g+","+d+","+v+","+p+l+","+b+l+")"),e>=.01?(e<=.99&&(c.opacity=e.toFixed(2)),c.display="block"):c.display="none",o.returnStyleObject?c:f(c)}function d(t,i,u,e){e=e||{};var s=e.excludeCommonCss?{}:r(i),o=t.m44,h=Math.round(t.m11*n/o)/n,c=Math.round(t.m12*n/o)/n,l=Math.round(t.m14*n/o)/n,a=Math.round(t.m21*n/o)/n,v=Math.round(t.m22*n/o)/n,y=Math.round(t.m24*n/o)/n,p=Math.round(t.m31*n/o)/n,b=Math.round(t.m32*n/o)/n,k=Math.round(t.m34*n/o)/n,d=Math.round(t.offsetX/o),g=Math.round(t.offsetY/o);return h===1&&c===0&&l===0&&a===0&&v===1&&y===0&&p===0&&b===0&&k===0?(s[e.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+d+"px,"+g+"px,0px)"):(s[e.returnStyleObject?w.Properties.transformOrigin:w.Attributes.transformOrigin]="0 0",s[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="matrix3d("+h+","+c+",0,"+l+","+a+","+v+",0,"+y+","+p+","+b+",1,"+k+","+d+","+g+",0,1)"),u>=.01||e.explicitOpacity?((u<=.99||e.explicitOpacity)&&(s.opacity=u.toFixed(2)),s.display="block"):s.display="none",e.returnStyleObject?s:f(s)}function g(n,t,i,u){u=u||{};var o=h(n).invert(),e=u.excludeCommonCss?{}:r(t);return e.left=(-o.offsetX).toFixed(0)+"px",e.top=(-o.offsetY).toFixed(0)+"px",e.display=i>.1?"block":"none",u.returnStyleObject?e:f(e)}var c=this,a={transform:{p:"",f:e},msTransform:{p:"",f:e},webkitTransform:{p:"",f:u.useTransform3d?d:e},MozTransform:{p:"px",f:e},OTransform:{p:"",f:e}},l,t=6,n=Math.pow(10,t),o=[new i(0,0),new i(128,128),new i(-128,128)],s=[],v=!1,y=!1;this.setExactTransformOrHide=function(n,t,i,e){var o,s,c,l;return e=e||{},o=e.excludeCommonCss?{}:r(t),s=h(n).invert(),Math.abs(s.m11-1)<et&&Math.abs(s.m12-0)<et&&Math.abs(s.m21-0)<et&&Math.abs(s.m22-1)<et&&i>=.01?(c=-Math.round(s.offsetX)+"px",l=-Math.round(s.offsetY)+"px",o.display="block",u.useTransform3dForTranslate?o[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate3d("+c+","+l+",0px)":u.useTransform2d?o[e.returnStyleObject?w.Properties.transform:w.Attributes.transform]="translate("+c+","+l+")":(o.left=c,o.top=l),i<=.99&&(v?o.opacity=i.toFixed(2):y&&(o.filter="alpha(opacity = "+(i*100).toFixed(0)+")"))):o.display="none",e.returnStyleObject?o:f(o)},p()},bi=new function(){function w(){for(var e,h,u,s=0;s<i.length;s++){for(e=i[s],h=0;h<e.length;h++){var c=e[h],l=c.url,v=a.getState(l);switch(v){case vt.none:case vt.timedout:case vt.cacheExpired:o<t.maxConcurrentTileDownloads&&(c.basket=e,r[l]||(o++,u=k("img"),r[l]=u,u[f]=c,u.onload=g,u.onerror=d,u.onabort=d,u[y]=window.setTimeout(function(){var n=u;return function(){nt.call(n)}}(),c.timeout),u.src=l));break;case vt.downloading:break;default:e.hasNewTiles=!0}}e.hasNewTiles&&(n.invoke(e,"hasnewtiles"),e.hasNewTiles=!1)}}function g(){if(!this[e]){var n=this[f].url;l(this,n),v.insert(n,!0),h.insert(n,this)}}function d(){if(!this[e]){var n=this[f].url;l(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),c.insert(n,vt.failed)}}function nt(){if(!this[e]){var n=this[f].url;l(this,n),u.useImageDisposer&&(this.src=t.spacerImageUrl),c.insert(n,vt.timedout)}}function l(n,t){var s,i,u;for(n[e]=!0,n.onload=null,n.onerror=null,n.onabort=null,window.clearTimeout(n[y]),s=n[f],i=s.basket,i.hasNewTiles=!0,u=i.length;u--;)i[u]===s&&i.splice(u,1);o--,delete r[t],b.dispatch(w,-10)}var a=this,i=[],o=0,r={},h=new yi(50),c=new yi(30),v=new yi(200);u.useImageDisposer&&h.useDisposer(function(n){n&&n.src&&(n.src=t.spacerImageUrl)});var f=p+"downloadRequest",y=p+"timeoutid",e=p+"processed";this.getState=function(n){if(h.get(n))return vt.ready;if(v.get(n))return vt.cacheExpired;var t=c.get(n);return t!==s?t:r[n]?vt.downloading:vt.none},this.setDownloadBasket=function(n,t){a.removeDownloadBasket(n.basketId),n.length>0&&(t?i.push(n):i.unshift(n),b.dispatch(w,-10))},this.removeDownloadBasket=function(n){for(var t=0;t<i.length;)i[t].basketId===n?i.splice(t,1):t++}},vt={none:0,downloading:1,ready:2,failed:3,timedout:4,cacheExpired:5};kt.createQuadKeyTilePyramid=function(n,i,r,u,f,e){var o=Math.pow(2,t.maxMercatorZoom);return new kt(n*o,i*o,n,i,0,0,0,0,kt.createMercatorQuadKeyUrlRetriever(r,n,u,f),kt.createQuadkeyTileReplacementHandler(),e)},kt.createMercatorQuadKeyUrlRetriever=function(n,i,r,u){return kt.createQuadKeyUrlRetriever(n,u,i,r,t.minMercatorZoom,t.maxMercatorZoom)},kt.createQuadKeyUrlRetriever=function(n,i,r,u,f,e,o){var a=l.ceilLog2(r),s,h,c;return typeof n=="string"?(s=n,h=i?i:s):c=n,function(n,i){function p(n){return(n.indexOf("key="+t.credentials)>-1||n.indexOf("key={key}")>-1)&&n.indexOf("stl=fb")===-1&&(n=n.replace(/(key=)[^\&]+/,"$1"+t.sessionId)),n}var y=n.levelOfDetail-a,r,l,v;if(y>=f&&y<=e&&(r=new it(y,n.x,n.y),u&st.horizontal&&(r=si.wrapX(r)),u&st.vertical&&(r=si.wrapY(r)),si.isInBounds(r))){if(c)return c(r);if(r.levelOfDetail===0)if(o)l=si.fromTileId(r,!0),v=o;else return null;else l=si.fromTileId(r,!1),v=l.charAt(l.length-1);return(t.sessionId&&t.credentials&&(s=p(s),h=p(h)),i)?h.replace("{quadkey}",l).replace("{subdomain}",v):s.replace("{quadkey}",l).replace("{subdomain}",v)}return null}},kt.createQuadkeyTileReplacementHandler=function(){var n=new yi(200);return function(t){var e=t.toString(),i=n[e],u,f,r;if(i){for(u=i.toString();n[u];)i=n[u],u=i.toString();for(f=n[e],r=f.toString();n[r];)f=n[r],n[r]=i,r=f.toString()}else i=t.getParent(),n[e]=i;return i}},st={none:0,horizontal:1,vertical:2},a.TilePyramid=kt,a.TilePyramidWrapMethod=st,or.getBestLevelOfDetail=function(n,t,i){var r,u,f;return r=t.getMaxLevelOfDetail()-l.log2(t.getWidth()/t.projectingCamera.getWidth()/(n.getZoomOriginWidth()/n.getWidth())),u=Math.ceil(r),f=Math.floor(r),u!=f&&(i&&(r=r+i),r=Math.round(r),r=Math.min(u,Math.max(f,r))),Math.min(r,t.getMaxLevelOfDetail())},a.TileRenderer=ou,ai=new function(){function r(){o()?(i=1,n=!0,t=!0):s()?(i=2,n=!1,t=!0):h()&&(i=3,n=!0,t=!1),r=function(){}}function o(){var n=!1,t;return document.implementation&&document.implementation.hasFeature?n=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"):document.createElementNS&&(t=document.createElementNS(ns,"svg"),n=typeof t.createSVGRect!="undefined"),o=function(){return n},n}function s(){var t=document.createElement("v:shape"),n;return t.style.behavior="url(#default#VML)",n=typeof t.strokecolor!="undefined",s=function(){return n},n}function h(){var n=document.createElement("canvas"),t=n.getContext&&n.getContext("2d")!==null;return h=function(){return t},t}function e(n){function t(n){this._surface=n,this._paths=[]}return t.prototype={setSize:function(n,t){this._width=n,this._height=t},createPath:function(){},renderPath:function(){},removePath:function(n){for(var t=this._paths.length;t--;)if(this._paths[t]===n){this._surface.removeChild(n.nativeShape),this._paths.splice(t,1);break}},clear:function(){for(var n=this._paths.length;n--;)this._surface.removeChild(this._paths[n].nativeShape);this._paths=[]}},new t(n)}function c(n){function t(){}function i(){function n(){var r=this,n=document.createElement("v:shape"),t,i;n.style.position="absolute",t=document.createElement("v:stroke"),n.appendChild(t),i=document.createElement("v:fill"),n.appendChild(i),this._stroke=t,this._fill=i,this._initialize(n)}return n.prototype=f,n.prototype.stroke=function(){this.data==null||this.data.length&&this.data.charAt(this.data.length-1)==="E"||(this.data+="E");var n=this.nativeShape;n.strokecolor=this.strokeStyle,n.strokeweight=this.lineWidth+"pt",this.lineCap&&(this._stroke.endcap=this.lineCap.toLowerCase()==="butt"?"flat":path.lineCap,this._stroke.dashstyle=this.dashArray,this._stroke.opacity=this.strokeOpacity),this.fillStyle&&this.fillStyle!=="none"?(this._fill.color=this.fillStyle,this._fill.opacity=this.fillOpacity*100+"%"):n.filled=!1,n.path=this.data},new n}return t.prototype=new e(n),t.prototype.createPath=function(){return new i},t.prototype.renderPath=function(n){var i="url(#default#VML)",r=this._height!=null?this._height:this._surface.offsetHeight,u=this._width!=null?this._width:this._surface.offsetWidth,t=n.nativeShape;this._surface.appendChild(t),t.style.height=r+"px",t.style.width=u+"px",t.style.behavior=i,t.coordsize=u+","+r,n._stroke.style.behavior=i,n._fill.style.behavior=i,this._paths.push(n)},new t}function l(n){function i(){}function o(){function n(){var t=this,n=document.createElementNS(r,"path");n.style.pointerEvents="visiblePainted",this._initialize(n)}return n.prototype=f,n.prototype.stroke=function(){var n=this.nativeShape;n.setAttribute("stroke",this.strokeStyle),n.setAttribute("stroke-width",this.lineWidth),n.setAttribute("stroke-linecap",this.lineCap),n.setAttribute("stroke-dasharray",this.dashArray),n.setAttribute("fill",this.fillStyle),n.setAttribute("fill-opacity",this.fillOpacity),n.setAttribute("fill-rule","evenodd"),n.setAttribute("stroke-opacity",this.strokeOpacity),n.setAttribute("d",this.data)},new n}var r="http://www.w3.org/2000/svg",t=document.createElementNS(r,"svg");return u.safariRenderHack&&(t.style.cssText=u.safariRenderHack),t.setAttribute("width","100%"),t.setAttribute("height","100%"),n.appendChild(t),i.prototype=new e(t),i.prototype.createPath=function(){return new o},i.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new i(n)}function a(n){function t(){}function i(t,i){function r(){var f=this,r=document.createElement("canvas"),u;r.style.cssText="position:absolute;",n.appendChild(r),u=r.getContext("2d"),u.beginPath(),this.context=u,this._initialize(r),this.setSize(t,i)}function o(n,t){if(n.length==7){var i=/^#(\w{2})(\w{2})(\w{2})$/.exec(n);return"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+","+t+")"}return""}var u,e;return r.prototype=f,r.prototype.setSize=function(n,t){u=n,e=t,this.nativeShape.setAttribute("width",u),this.nativeShape.setAttribute("height",e)},r.prototype.beginPath=function(){this.context.beginPath()},r.prototype.moveTo=function(n,t){this.context.moveTo(n,t)},r.prototype.lineTo=function(n,t){this.context.lineTo(n,t)},r.prototype.curveTo=function(n,t,i,r,u,f){this.context.bezierCurveTo(n,t,i,r,u,f)},r.prototype.stroke=function(){var n=this.context;n.clearRect(0,0,u,e),this.fillStyle&&this.fillStyle!=="none"&&(n.fillStyle=o(this.fillStyle,this.fillOpacity),n.fill()),n.strokeStyle=o(this.strokeStyle,this.strokeOpacity),n.lineWidth=this.lineWidth,n.stroke(),this.drawn=!0},new r}return t.prototype=new e(n),t.prototype.setSize=function(n,t){if(this._width!==n||this._height!==t){this._width=n,this._height=t;for(var i=this._paths.length;i--;)this._paths[i].setSize(n,t)}},t.prototype.createPath=function(){var n=this._height?this._height:this._surface.offsetHeight,t=this._width?this._width:this._surface.offsetWidth;return new i(t,n)},t.prototype.renderPath=function(n){var t=n.nativeShape;this._surface.appendChild(t),this._paths.push(n)},new t(n)}var n,t,i,f;this.isClipped=function(){return r(),n},this.isEventsSupported=function(){return r(),t},this.getContext=function(n){if(!n.harmonyContext){r();var t;switch(i){case 1:t=new l(n);break;case 2:t=new c(n);break;case 3:t=new a(n)}n.harmonyContext=t}return n.harmonyContext},this.destroyContext=function(n){n.harmonyContext&&(n.harmonyContext.clear(),n.harmonyContext=null)},f={nativeShape:null,_events:null,id:null,data:"",strokeStyle:"#000",strokeOpacity:"1",dashArray:"solid",fillStyle:"#000",fillOpacity:"1",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"#000000ff",beginPath:function(){this.data=""},moveTo:function(n,t){this.data+="M"+Math.round(n)+","+Math.round(t)+" "},lineTo:function(n,t){this.data+="L"+Math.round(n)+","+Math.round(t)+" "},curveTo:function(n,t,i,r,u,f){this.data+="C"+Math.round(n)+","+Math.round(t)+" "+Math.round(i)+","+Math.round(r)+" "+Math.round(u)+","+Math.round(f)+" "},stroke:function(){},onMouseDown:function(n){this._events.mousedown.push(n)},onMouseUp:function(n){this._events.mouseup.push(n)},onClick:function(n){this._events.click.push(n)},onMouseMove:function(n){this._events.mousemove.push(n)},onMouseOver:function(n){this._events.mouseover.push(n)},onMouseOut:function(n){this._events.mouseout.push(n)},_dispatchEvent:function(n,t){for(var i=this._events[n].length;i--;)this._events[n][i].call(this,t)},_initialize:function(n){function i(n){n=n||window.event,t._dispatchEvent(n.type,n)}var t=this;t._events={mousedown:[],mouseup:[],mousemove:[],mouseover:[],mouseout:[],click:[]},n.onmousedown=n.onmouseup=n.onclick=n.onmousemove=n.onmouseover=n.onmouseout=i,this.nativeShape=n}}},a.Harmony=ai,sr.ensureVmlNamespace=function(){sr.ensureVmlNamespace=function(){};try{document.namespaces&&document.namespaces.add&&document.namespaces.add("v","urn:schemas-microsoft-com:vml")}catch(n){}},a.CompositeModeEntityRenderer=sr,new function(){var n=[],t=[],i=function(i,r){var u=null,f;if(r instanceof tr||r instanceof ir){for(f=n.length;f--;)n[f]===i&&(u=t[f]);u||(u=new ku(i),n.push(i),t.push(u))}return u};bt.registerEntityRenderer(i)},du=new function(){function r(t,r){var s=r.userData,e=null,h,o,f,l,u,a;if(r&&r.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders){for(e=[],h=t.resourceSets[0].resources[0].imageryProviders,u=h.length;u--;){for(var v=h[u],c=v.coverageAreas,y={attribution:v.attribution,coverageAreas:[]},p=c?c.length:0;p--;)o=c[p],f=o.bbox,y.coverageAreas.push({zoomMax:o.zoomMax,zoomMin:o.zoomMin,boundingBox:rt.fromEdges(f[2],f[1],f[0],f[3])});e.push(y)}i[s]=e}for(l=n[s],delete n[s],u=l.length;u--;)a=l[u],a.callback(e,a.userData)}var i={},n={};this.getCachedImageryProviders=function(n){return i[n]},this.getImageryProviders=function(u,f,e,o){if(i[u])e(i[u],o);else if(n[u])n[u].push({callback:e,userData:o});else if(t.imageryMetadataUrl){n[u]=[],n[u].push({callback:e,userData:o});var s=t.imageryMetadataUrl.replace(/{imagerySet}/,u).replace(/{credentials}/,f);ui.getObjectAsync(s,r,u)}else e(null,o)}},hu=new function(){function u(t,i){var u,f,o,e;i&&i.success&&t&&t.resourceSets&&t.resourceSets[0]&&t.resourceSets[0].resources&&t.resourceSets[0].resources[0]&&t.resourceSets[0].resources[0].imageryProviders&&(u=i.userData,f=t.resourceSets[0].resources[0],r=f.displayCombinedLogo,o=[gt.defaultCopyright.text].concat(f.imageryProviders),n[u]&&(e=n[u].callback,delete n[u],n[u]=null,e&&e(o,r)))}var i=0,n=[],r=!1;this.getCopyrights=function(f,e,o,s,h,c){if(f&&e&&o&&h&&c){var l=t.imageryCopyrightUrl.replace(/{imagerySet}/,f).replace(/{zoom}/,parseInt(o)).replace(/{minLat}/,e.getSouth()).replace(/{minLon}/,e.getWest()).replace(/{maxLat}/,e.getNorth()).replace(/{maxLon}/,e.getEast()).replace(/{heading}/,parseInt(s)).replace(/{credentials}/,h);n[i]={callback:c},ui.getObjectAsync(l,u,i),i=++i%10}else c([gt.defaultCopyright.text],r)}},a.ModeEventHandler=cu,a.ModeEventHandlerComposite=lu,au=new function(){function n(n,u,f,e,o,s){var h=kt.createQuadKeyTilePyramid(i,r,u,f,s);return h.projectingCamera=n,new lt(n.getAlignedCamera(t.minMercatorZoom),h,t.maxMercatorZoom-t.minMercatorZoom,"EnhancedBirdseye",e)}var u=this,i=256,r=180;this.createContributor=function(t){var s=t.credentialsProvider,r=t.urlFormat,f=t.urlWithLabelsFormat,e=new ei("Synth",s),o=new ei("SynthWithLabels",s),u={},i;return i={},u[nt.northUpHeading]=i,i[ut.hidden]=n(ft.enhancedBirdseyeNorthUp,r.replace("{dir}","dir_n"),st.horizontal,e),i[ut.visible]=n(ft.enhancedBirdseyeNorthUp,f.replace("{dir}","dir_n"),st.horizontal,o,r.replace("{dir}","dir_n")),i={},u[nt.westUpHeading]=i,i[ut.hidden]=n(ft.enhancedBirdseyeWestUp,r.replace("{dir}","dir_w"),st.vertical,e),i[ut.visible]=n(ft.enhancedBirdseyeWestUp,f.replace("{dir}","dir_w"),st.vertical,o,r.replace("{dir}","dir_w")),i={},u[nt.southUpHeading]=i,i[ut.hidden]=n(ft.enhancedBirdseyeSouthUp,r.replace("{dir}","dir_s"),st.horizontal,e),i[ut.visible]=n(ft.enhancedBirdseyeSouthUp,f.replace("{dir}","dir_s"),st.horizontal,o,r.replace("{dir}","dir_s")),i={},u[nt.eastUpHeading]=i,i[ut.hidden]=n(ft.enhancedBirdseyeEastUp,r.replace("{dir}","dir_e"),st.vertical,e),i[ut.visible]=n(ft.enhancedBirdseyeEastUp,f.replace("{dir}","dir_e"),st.vertical,o,r.replace("{dir}","dir_e")),{priority:30,minZoomLevel:0,getScene:function(n,t,i,r,f,e){return r>this.minZoomLevel?u[nt.snapToCardinalHeading(f)][e]:null}}}},dt.mercator="m",t.allowAerialMap&&(dt.auto="auto"),t.allowOrdnanceSurvey&&(dt.ordnanceSurvey="os"),t.allowCollinsBart&&(dt.collinsBart="cb"),n.addHandler(rr,"mapcreationstart",function(n){var u=n.map,o=n.options,r=o&&o.credentials?function(n){return n.replace(/{key}/,o.credentials)}:function(n){return n.replace(/&key={key}/,"")},f=u.getCredentials,i=new bt,ot=lt.createMercatorScene(r(t.roadUriFormat),"Road",new ei("Road",f),r(t.roadUnlabeledUriFormat)),s={priority:10,getScene:function(){return ot}},k=new hi(dt.mercator,i),l,d,a,g,v,h,y,p,it,rt,ft,w,et,b;if(k.activated=function(){i.setSceneContributors([])},l=new hi(dt.road,i),l.activated=function(){i.setSceneContributors([s])},t.allowCollinsBart&&(d=new su(lt.createMercatorScene(r(t.collinsBartUriFormat),"CollinsBart",new ei("CollinsBart",f)),t.collinsBartMinZoom-.5,t.collinsBartMaxZoom+.5,t.collinsBartBounds,15),a=new hi(dt.collinsBart,i),a.activated=function(){i.setSceneContributors([s,d])},u.registerMapType(a)),t.allowOrdnanceSurvey&&(g=new su(lt.createMercatorScene(r(t.ordnanceSurveyUriFormat),"OrdnanceSurvey",new ei("OrdnanceSurvey",f)),t.ordnanceSurveyMinZoom-.5,t.ordnanceSurveyMaxZoom+.5,t.ordnanceSurveyBounds,15),v=new hi(dt.ordnanceSurvey,i),v.activated=function(){i.setSceneContributors([s,g])},u.registerMapType(v)),t.allowAerialMap){h={},h[ut.hidden]=lt.createMercatorScene(r(t.aerialUriFormat),"Aerial",new ei("Aerial",f)),h[ut.visible]=lt.createMercatorScene(r(t.aerialWithLabelsUriFormat),"Aerial",new ei("AerialWithLabels",f),r(t.aerialUriFormat));var e={priority:20,maxZoomLevel:4.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevel?h[f]:null}},c=au.createContributor({credentialsProvider:f,urlFormat:r(t.enhancedBirdseyeUriFormat),urlWithLabelsFormat:r(t.enhancedBirdseyeWithLabelsUriFormat)}),nt=new gu({credentialsProvider:f,urlFormat:r(t.nativeBirdseyeUriFormat),urlWithLabelsFormat:r(t.nativeBirdseyeWithLabelsUriFormat)}),tt=new hi(dt.aerial,i);tt.activated=function(){e.maxZoomLevel=1e3,i.setSceneContributors([e])},y=new hi(dt.auto,i),y.activated=o.disableBirdseye!==!0&&t.defaultAerialTiltOn===!0?function(){e.maxZoomLevel=4.5,c.minZoomLevel=16.5,i.setSceneContributors([s,e,c,nt])}:function(){var n={priority:20,maxZoomLevelBand1:4.5,minZoomLevelBand2:16.5,getScene:function(n,t,i,r,u,f){return r<this.maxZoomLevelBand1||r>this.minZoomLevelBand2?h[f]:null}};i.setSceneContributors([n,s])},p=new hi(dt.birdseye,i),p.activated=function(){o.disableBirdseye!==!0?(e.maxZoomLevel=1e3,c.minZoomLevel=12.5,i.setSceneContributors([e,c,nt])):(e.maxZoomLevel=1e3,i.setSceneContributors([e]))},u.registerMapType(y),u.registerMapType(tt),u.registerMapType(p)}u.registerMapType(k),u.registerMapType(l),t.weatherLightUriFormat&&(it=lt.createMercatorScene(r(t.weatherLightUriFormat),"Road",new ei("Road",f)),ft={priority:10,getScene:function(){return it}},w=new hi("wl",i),w.activated=function(){i.setSceneContributors([ft])},u.registerMapType(w)),t.weatherDarkUriFormat&&(rt=lt.createMercatorScene(r(t.weatherDarkUriFormat),"Aerial",new ei("Aerial",f)),et={priority:10,getScene:function(){return rt}},b=new hi("wd",i),b.activated=function(){i.setSceneContributors([et])},u.registerMapType(b))}),delete window[$MapsNamespace].Maps.initMapCode,PRF.end("Map core initialized","mapcore")},window[$MapsNamespace].Maps.Globals&&window[$MapsNamespace].Maps.initMapCode&&window[$MapsNamespace].Maps.initMapCode(),window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.initMapDelayCode=function(){function fr(e,o,s){function lt(){d&&(n.removeHandler(d),n.removeHandler(st),n.removeHandler(ct),d=null,v.remove_event("mousedown",g).remove_event("dblclick",i).remove_event("touchstart",g).remove_event("keydown",bt).remove_event("keyup",kt),t(y).remove_event("click",dt),t(p).remove_event("click",gt),a.parentNode.removeChild(a),a=null,y=null,l=null,p=null)}function vt(n){var n=e.isRotationEnabled();n!==k&&(k=n,et.set_style(k?{visibility:"visible"}:{visibility:"hidden"}),n||(l.className="NavBar_compass NavBar_compassFlat",rt=null),yt())}function yt(){var t,n;if(k&&(t=e.getTargetHeading(),t!==rt)){n="";switch(ht.snapToCardinalHeading(t)){case ht.northUpHeading:n="NavBar_compassN";break;case ht.eastUpHeading:n="NavBar_compassE";break;case ht.southUpHeading:n="NavBar_compassS";break;case ht.westUpHeading:n="NavBar_compassW"}l.className="NavBar_compass "+n,rt=t}}function pt(n){var i=t.Screen.get_mouse_pos(n),r;isNaN(i.x)&&(i=new f(n.touches[0].pageX,n.touches[0].pageY)),c=new f(i.x-it.x-w.x,i.y-it.y-w.y),r=Math.sqrt(c.x*c.x+c.y*c.y),r<b&&(c.x=c.x/b*ft,c.y=c.y/b*ft)}function wt(){if(Math.abs(c.x)<=1&&(c.x=0),Math.abs(c.y)<=1&&(c.y=0),c.x||c.y){var n=e.tryPixelToLocation(c);n&&e.setView({center:n,animate:!1})}}function g(n){n.preventMouseEvent&&n.preventMouseEvent(),n.which===1&&(i(n),h(e,n),t(document).add_event("mousemove",nt,!0).add_event("mouseup",tt,!0).add_event("touchmove",nt,!0).add_event("touchend",tt,!0).add_event("contextmenu",i,!0),v.add_event("selectstart",i,!0),w=new f(l.offsetWidth/2,l.offsetHeight/2),b=Math.min(w.x,w.y),it=v.get_absolute_pos(),pt(n),wt(),ut=window.setInterval(wt,100))}function bt(t){t.stopPropagation();var i=new ui("keydown",t.keyCode,t.altKey,t.ctrlKey,t.shiftKey,t.charCode);i.originalEvent=t,n.invoke(e,"keydown",i)}function kt(t){t.stopPropagation();var i=new ui("keyup",t.keyCode,t.altKey,t.ctrlKey,t.shiftKey);i.originalEvent=t,n.invoke(e,"keyup",i)}function nt(n){n.preventMouseEvent&&n.preventMouseEvent(),i(n),pt(n)}function tt(n){n.preventMouseEvent&&n.preventMouseEvent(),n.which===1&&(i(n),t(document).remove_event("mousemove",nt,!0).remove_event("mouseup",tt,!0).remove_event("touchmove",nt,!0).remove_event("touchend",tt,!0).remove_event("contextmenu",i,!0),v.remove_event("selectstart",i,!0),window.clearInterval(ut))}function dt(n){i(n),h(e,n),ni(90)}function gt(n){i(n),h(e,n),ni(-90)}function ni(n){e.setView({heading:e.getTargetHeading()+n})}var ti=this,a,l,v,it,w,b,ut,c,ft=15,k,rt,y,p,et,st,ct,d;a=r("div",s.getClassName()),ot(a),y=at("NavBar_rotateLeft",u.getString("L_rotateLeftTooltip_Text")),t(y).add_event("click",dt).set_attr("uici","NB.CS.RotateLeft"),l=r("a"),l.href="#",l.onclick=function(){return!1},l.appendChild(document.createTextNode(u.getString("L_compassNorthLabel_Text"))),v=t(l),l.title=u.getString("L_compassTooltip_Text"),p=at("NavBar_rotateRight",u.getString("L_rotateRightTooltip_Text")),t(p).add_event("click",gt).set_attr("uici","NB.CS.RotateRight"),et=t([y,p]),v.add_event("mousedown",g).add_event("dblclick",i).add_event("touchstart",g).add_event("keydown",bt).add_event("keyup",kt).set_attr("uici","NB.CS.PanControl"),s.getRotateVisible()&&a.appendChild(y),s.getCompassVisible()&&a.appendChild(l),s.getRotateVisible()&&a.appendChild(p),o.appendChild(a),s.getDomElement=function(){return a},st=n.addHandler(e,"imagerychanged",vt),ct=n.addHandler(e,"targetviewchanged",yt),vt(),d=n.addHandler(e,"ondispose",lt),this.dispose=lt}function hi(i,u,f){function et(n){var t=n.keyCode;t in ft&&(l+=ft[t]||0,l===w.length?l=0:l<0&&(l=w.length-1),v===this&&(l=0,nt(),n.stopPropagation()),w[l].receiveFocus(),n.preventDefault())}function nt(){if(tt(),rt=new Date,c||(o(e,"show"),c=!0,it.appendChild(y),t(it).add_class("activeMenu"),t(document).add_event("keydown",e.hideMenu,!0)),h.style.visibility==="hidden"){var f=s.offsetHeight,n=t(s).get_relative_pos().x,l=t(s).get_absolute_pos(),r=i.getRootElement(),u=t(r).get_absolute_pos().x+r.offsetWidth-(l.x+h.offsetWidth);u<0&&(n+=u),h.style.top=f+"px",h.style.left=n+"px",h.style.visibility="visible"}}function b(n){if(tt(),c&&(o(e,"hide"),c=!1,y.parentNode.removeChild(y),t(it).remove_class("activeMenu"),h.style.visibility="hidden",n)){try{v.focus()}catch(i){}t(document).remove_event("keydown",e.hideMenu,!0)}}function tt(){k&&(window.clearTimeout(k),k=null),d&&(window.clearTimeout(d),d=null)}var e=this,it=u,p,c=!1,w=[],rt=new Date(0),ot=300,k,d,l=0,ft={38:-1,104:-1,40:1,98:1},s=r("span","NavBar_button NavBar_typeButton"+(f?" "+f:"")),ut=t(s),a,g,st,v,ht,y,h;ut.add_event("mouseenter",function(n){o(e,"mouseenter",n)}).add_event("mouseleave",function(n){o(e,"mouseleave",n)}).add_event("touchstart",function(n){o(e,"touchstart",n)}),a=r("a","NavBar_typeButtonLabel",s),a.href="#",a.appendChild(document.createTextNode("")),g=t(a),g.add_event("click",function(n){o(e,"clicklabel",n)}).add_event("mouseenter",function(n){o(e,"mouseenterlabel",n)}).add_event("mouseleave",function(n){o(e,"mouseleavelabel",n)}),st=r("span","separator",s),v=r("a","NavBar_dropIconContainer",s),v.href="#",t(v).add_event("click",function(n){o(e,"clickicon",n)}).add_event("keydown",et).add_event("mouseenter",function(n){o(e,"mouseentericon",n)}).add_event("mouseleave",function(n){o(e,"mouseleaveicon",n)}),ht=r("span","NavBar_dropIcon",v),u.appendChild(s),y=r("div","NavBar_ModeSelectorControl"),t(y).add_event("keydown",et),h=r("ul","MicrosoftMap_NavBar_typeMenu",y),h.style.cssText="position:absolute;visibility:hidden",t(h).add_event("mouseenter",function(n){o(e,"mouseenter",n)}).add_event("mouseleave",function(n){o(e,"mouseleave",n)}),this.dispose=function(){s&&(b(),s.parentNode.removeChild(s),s=null)},this.isShown=function(){return c},this.addMenuItem=function(t,i){t&&(w.push(t),n.addHandler(t,"click",function(t){n.invoke(e,"clickitem",t)})),h.appendChild(i)},this.getItems=function(){return w},this.setMapType=function(n){p&&g.remove_class("NavBar_MapType_"+p),p=n,n&&g.add_class("NavBar_MapType_"+p)},this.getMapType=function(){return p},this.updateLabel=function(n){a.replaceChild(document.createTextNode(n),a.firstChild)},this.setSelected=function(n){n?ut.add_class("NavBar_buttonSel"):ut.remove_class("NavBar_buttonSel")},this.toggleMenu=function(){c?new Date-rt>ot&&b():(nt(),rt=new Date(0))},this.showMenu=function(){nt()},this.showMenuDelay=function(n){tt(),c||(k=window.setTimeout(nt,n))},this.hideMenu=function(n){n&&/keydown$/.test(n.type)?n.keyCode===27&&b(!0):b()},this.hideMenuDelay=function(n){tt(),d=window.setTimeout(b,n)}}function ci(u,f,e){var a=this,c=ut[u],s=r("li","NavBar_menuitem"+(f?" NavBar_menuItemSel":"")),o=r("a","NavBar_itemContainer NavBar_itemContainer_"+u,s),l;o.style.cssText="display:block;",o.href="#",t(o).add_event("click",function(t){i(t),n.invoke(a,"click",t),e(u)});var y=r("div","NavBar_typePreview NavBar_typePreview_"+u,o),h=r("div","NavBar_typeContent",o),v=r("div","NavBar_typeTitle",h);v.appendChild(document.createTextNode(c.title)),l=r("div","NavBar_typeDesc",h),l.appendChild(document.createTextNode(c.description)),this.getTypeId=function(){return u},this.getElement=function(){return s},this.receiveFocus=function(){try{o.focus()}catch(n){}},this.getContent=function(){return h},this.setSelected=function(n){s.className="NavBar_menuitem"+(n?" NavBar_menuItemSel":"")}}function er(f,e,s,c){function rt(){var e=f.getOptions(),n,t,i,r,u;if(l=f.getMapTypeId(),l===d?(v=!1,b.disableBirdseye!==!0&&(l=a)):l===a&&(b.disableBirdseye===!0?l=d:v=!0),ut.hasOwnProperty(l)){for(n=w.getItems(),t=n.length;t--;)i=n[t],r=i.getTypeId(),i.setSelected(r==l||it(l)&&it(r));u=ut[l],w.updateLabel(u.title),w.setMapType(f.getMapTypeId())}p=e.labelOverlay!==tt.hidden,g&&(g.checked=p),nt&&(nt.checked=v)}function ft(n){n===a&&(n=b.disableBirdseye!==!0&&v?a:d),f.setView({mapTypeId:n,labelOverlay:p||n===ot?tt.visible:tt.hidden});var t=f.getComponent("analyticsProxy");t&&t.logClientAction({uici:"NB.MT.SetMapType",customData:{mt:n}})}function it(n){return n===d||n===a}function st(n){p=!p,ct(n,g,p)}function ht(n){v=!v,ct(n,nt,v)}function ct(n,t,i){n.stopPropagation(),h(f,n),n.currentTarget.tagName==="SPAN"&&t&&(t.checked=i),it(l)&&ft(a),vt&&w.hideMenuDelay(1e3)}function yt(t){var i=new hi(f,e),v,u,s,c,r;for(i.mapTypes=t,i.updateLabel(ut[t[0]].title),i.setMapType(t[0]),v=[],i.events=v,r=0;r<t.length;r++)u=t[r],u&&(s=new ci(u,l===u,ft),i.addMenuItem(s,s.getElement()),(u===a||u===d&&b.disableBirdseye===!0)&&pt(s.getContent()));for(c=[["clicklabel",function(n){h(f,n),i.toggleMenu()}],["clickicon",function(n){h(f,n),i.toggleMenu()}],["clickitem",function(n){h(f,n),i.hideMenu()}],["mouseenter",function(){i.showMenu()}],["mouseleave",function(){i.hideMenuDelay(1e3)}],["show",function(){o(et,"showmaptypemenu",{menuPosition:0})}],["hide",function(){o(et,"hidemaptypemenu",{menuPosition:0})}]],r=c.length;r--;)v.push(n.addHandler(i,c[r][0],c[r][1]));return i}function pt(n){var s=r("div","NavBar_checkControls"),o=r("div","NavBar_checkControl",s),f=r("input"),e;f.id="LabelCB_"+kt.getNext(),f.setAttribute("type","checkbox"),t(f).add_event("click",st),g=f,o.appendChild(f),f.checked=!0,e=r("span","",o),e.appendChild(document.createTextNode(u.getString("L_aerialShowLabels_Text"))),t(e).add_event("click",function(n){i(n),st(n)}),b.disableBirdseye!==!0&&(o=r("div","NavBar_checkControl",s),f=r("input"),f.id="TiltCB_"+kt.getNext(),f.setAttribute("type","checkbox"),t(f).add_event("click",ht),nt=f,o.appendChild(f),f.checked=!0,e=r("span","",o),e.appendChild(document.createTextNode(u.getString("L_aerialEnableTilt_Text"))),t(e).add_event("click",function(n){i(n),ht(n)})),n.appendChild(s)}var et=this,ot=k.auto,a=k.birdseye,d=k.aerial,l=f.getMapTypeId(),b=c,p=!0,v=y.defaultAerialTiltOn===!0,g=null,nt=null,w=yt([k.road,y.allowCollinsBart?k.collinsBart:null,y.allowOrdnanceSurvey?k.ordnanceSurvey:null,b.disableBirdseye!==!0||y.allowAerialMap?ot:null,b.disableBirdseye!==!0?a:y.allowAerialMap?d:null]),lt=n.addHandler(f,"maptypechanged",rt),at=n.addHandler(f,"optionschanged",rt);rt(),this.dispose=function(){for(var t=w.events,i=t.length;i--;)n.removeHandler(t[i]);w.dispose(),n.removeHandler(lt),n.removeHandler(at)},this.showMenu=function(){w.showMenu()},this.hideMenu=function(){w.hideMenu()},this.getAerialViewSettings=function(){return{showLabels:p,enableTilt:v}},this.setAerialViewSettings=function(n,t){p=n,v=t,it(l)&&ft(a)}}function or(i,f,e,s){function g(){var h=i.getOptions(),r,u,n,s;if(l=i.getMapTypeId(),ut.hasOwnProperty(l))for(r=c.length;r--;){for(var t=c[r],f=!1,e=t.getItems(),o=e.length;o--;)u=e[o],n=u.getTypeId(),u.setSelected(n==l),n==l&&(f=!0,s=ut[n],t.updateLabel(s.title),t.setMapType(n));t.setSelected(f)}!d&&nt(l)&&v&&(a=h.labelOverlay!==tt.hidden,v.checked=a),d=!1}function p(n){var u=i.getOptions(),r=n==rt||a,t;d=u.labelOverlay!==tt.hidden!==r,i.setView({mapTypeId:n,labelOverlay:r?tt.visible:tt.hidden}),t=i.getComponent("analyticsProxy"),t&&t.logClientAction({uici:"NB.MT.SetMapType",customData:{mt:n}})}function nt(n){return n===w||n===b}function ft(){for(var n=c.length;n--;)c[n].hideMenu()}function et(n){n.stopPropagation(),h(i,n),a=!a,v&&(v.checked=a),nt(l)&&p(l),vt&&c[1].hideMenuDelay(1e3)}function ot(t,r){var b=c.length,u=new hi(i,f,r),a,e,s,v;for(u.mapTypes=t,u.updateLabel(ut[t[0]].title),u.setMapType(t[0]),a=[],u.events=a,e=0;e<t.length;e++)s=t[e],s&&(v=new ci(s,l===s,p),u.addMenuItem(v,v.getElement()));for(var y=!1,w=[["clicklabel",function(n){h(i,n),ft(),p(u.getMapType())}],["clickicon",function(n){h(i,n),u.toggleMenu()}],["clickitem",function(n){h(i,n),ft()}],["mouseentericon",function(){u.showMenu()}],["mouseleaveicon",function(){u.hideMenuDelay(1)}],["mouseenterlabel",function(){y=!0}],["mouseleavelabel",function(){y=!1}],["mouseenter",function(){u.isShown()&&!y&&u.showMenu()}],["mouseleave",function(){u.hideMenuDelay(1e3)}],["show",function(){for(var n=c.length;n--;)u!=c[n]&&c[n].hideMenu();o(it,"showmaptypemenu",{menuPosition:b})}],["hide",function(){o(it,"hidemaptypemenu",{menuPosition:b})}]],e=w.length;e--;)a.push(n.addHandler(u,w[e][0],w[e][1]));return u}function lt(n){var f=r("div","NavBar_checkControl"),i=r("input"),e;return i.setAttribute("type","checkbox"),t(i).add_event("click",et),f.appendChild(i),i.checked=!0,e=r("span","",f),e.appendChild(document.createTextNode(u.getString("L_aerialShowLabels_Text"))),t(e).add_event("click",et),n.addMenuItem(null,f),i}var it=this,rt=k.auto,b=k.birdseye,w=k.aerial,l=i.getMapTypeId(),st=s,c=[],a,v;c.push(ot([k.road,y.allowCollinsBart?k.collinsBart:null,y.allowOrdnanceSurvey?k.ordnanceSurvey:null,rt],"NavBar_DropDownMenu_0")),a=!0,v=null,y.allowAerialMap&&(c.push(ot(st.disableBirdseye!==!0?[b,w]:[w],"NavBar_DropDownMenu_1")),v=lt(c[1]));var ht=n.addHandler(i,"maptypechanged",g),ct=n.addHandler(i,"optionschanged",g),d=!1;g(),this.dispose=function(){for(var t=c.length;t--;){for(var i=c[t],r=i.events,u=r.length;u--;)n.removeHandler(r[u]);i.dispose()}n.removeHandler(ht),n.removeHandler(ct)},this.showMenu=function(n){c[n].showMenu()},this.hideMenu=function(n){c[n].hideMenu()},this.getAerialViewSettings=function(){return{showLabels:a}},this.setAerialViewSettings=function(n,t){a=n,nt(l)&&(t?p(b):p(w))}}function sr(e,o,s){function ct(n){i(n),t.Events.capture_mouse(l),y=!0}function nt(n){d();var t=Math.min(1,n.touches.length);ht||n.touches.length!==1||(p=new f(n.touches[0].pageX,n.touches[0].pageY),p.target=n.target,p.start=new Date),k=new f(n.touches[0].pageX,n.touches[0].pageY),ht=k,y=!0,i(n)}function lt(n){if(i(n),y){var r=w(t.Screen.get_mouse_pos(n).y);l.style.top=r+"px",b(r,!0)}}function tt(n){if(d(),yt(),k=new f(n.touches[0].pageX,n.touches[0].pageY),y){var t=w(k.y);l.style.top=t+"px",b(t,!0)}i(n)}function at(n){i(n),y&&(t.Events.release_mouse(),y=!1,b(w(t.Screen.get_mouse_pos(n).y),!1),ut(),h(e,n))}function it(n){d(),p?(bt(n),h(e,n)):y&&(y=!1,b(w(k.y),!1),ut(),h(e,n)),yt()}function vt(n){i(n),b(w(t.Screen.get_mouse_pos(n).y)),h(e,n)}function bt(n){n.target===a&&b(w(p.y))}function yt(){p=null}function rt(){var n=e.getZoomRange();c&&c.min==n.min&&c.max==n.max||(c=n),ut()}function w(n){var i=a.offsetHeight-l.offsetHeight;return n-=t(a).get_absolute_pos().y+l.offsetHeight/2,n=Math.max(n,0),Math.min(n,i)}function b(n,t){var i=l.offsetHeight/2,r=a.offsetHeight-i,u=n+i,f=Math.round(c.max+(u-i)*-(c.max-c.min)/(r-i));e.setView({zoom:f,suspend:t})}function kt(n,t){if(c){var i=l.offsetHeight/2,r=a.offsetHeight-i,u=Math.round(i+(r-i)*(t-c.max)/-(c.max-c.min));n.style.top=u-n.offsetHeight/2+"px"}}function ut(){kt(l,e.getTargetZoom())}function pt(){g&&(window.clearTimeout(g),g=null)}function d(){pt(),ft&&(g=window.setTimeout(dt,5e3))}function dt(){pt(),o.style.display="none"}var gt=this,v,a,wt,l,ft=s,et,st,y,c,p,k,ht,g;v=r("div","NavBar_zoom"),ot(v),a=r("div","NavBar_zoomBar",v),a.style.cssText="position:absolute;overflow:hidden",t(a).add_event("click",vt).add_event("touchstart",nt).add_event("touchmove",tt).add_event("touchend",it),wt=r("div","NavBar_zoomBarBg",a),l=r("div","NavBar_zoomSlider",a),l.title=u.getString("L_zoomSliderTooltip_Text"),t(l).add_event("mousedown",ct).add_event("mouseup",at).add_event("mousemove",lt).add_event("click",i).add_event("touchstart",nt).add_event("touchmove",tt).add_event("touchend",it),t(v).add_event("mousedown",i).add_event("mouseup",i).add_event("mousemove",i).add_event("click",i).add_event("touchstart",i).add_event("touchmove",i).add_event("touchend",i),o.appendChild(v),et=n.addHandler(e,"targetviewchanged",rt),st=n.addHandler(e,"imagerychanged",rt),ft&&d(),this.getDomElement=function(){return v},this.dispose=function(){v&&(t(a).remove_event("click",vt).remove_event("touchstart",nt).remove_event("touchmove",tt).remove_event("touchend",it),t(l).remove_event("mousedown",ct).remove_event("mouseup",at).remove_event("mousemove",lt).remove_event("click",i).remove_event("touchstart",nt).remove_event("touchmove",tt).remove_event("touchend",it),t(v).remove_event("mousedown",i).remove_event("mouseup",i).remove_event("mousemove",i).remove_event("click",i).remove_event("touchstart",i).remove_event("touchmove",i).remove_event("touchend",i),n.removeHandler(et),n.removeHandler(st),v.parentNode.removeChild(v),a=null,l=null,v=null)},this.show=function(){rt()},this.resetZoomBarTimer=d}function hr(u,f,e){function w(){s&&(n.removeHandler(a),n.removeHandler(s),s=null,v.removeNavigationBar(u))}function y(){var i=f.getDomElement(),r,n;i&&(r=i.offsetWidth,n="",r<=665?n="narrow":r<=774&&(n="medium"),n!==l&&(t(i).remove_class(l).add_class(n),l=n))}function p(n){var t,i,u;if(t=c[n],i=f.getDomElement(),!t){t=r("div","NavBar_clientRegion NavBar_clientRegion_"+b.getName(n));switch(n){case b.left:u=c[b.middle],i.insertBefore(t,u?u.nextSibling:e.getDomElement().nextSibling);break;case b.middle:t=e.getDomElement();break;case b.right:i.appendChild(t)}c[n]=t,y()}return t}var c={},o={},l="",s,a;v.registerNavigationBar(u,this),s=n.addHandler(u,"ondispose",w),a=n.addHandler(u,"resize",y),this.addClientButton=function(n,r,f,e,s){var l=p(n),c=typeof f=="string"?at(e,f):f;return l.appendChild(c),o[r]=c,t(c).add_event("click",function(n){typeof f=="string"&&i(n),h(u,n),s&&s(r)}).set_attr("uici","NB.TB."+f),c},this.updateClientButton=function(n,i,r){var u=o[n];u&&(u.className="NavBar_button NavBar_toolButton "+(r||""),u.title=i||"",t(u).set_attr("uici","NB.TB."+i))},this.removeClientButton=function(n,t){var r=p(n),i=o[t];i&&(delete o[t],r.removeChild(i))}}function cr(f,o,s){function di(){n.removeHandler(at),at=null,wi=f.getTargetCenter(),bi=f.getTargetZoom()}function pt(){ui&&(f.entities.remove(ui),ui=null),c.current.style.display!=="none"&&(c.current.style.display="none",c.currentDelim.style.display="none",g=p[d],y())}function gi(){c.current.style.display==="none"&&(l.currentZoom=f.getTargetZoom(),l.currentCenter=f.getTargetCenter(),c.current.style.display="inline-block",c.currentDelim.style.display="inline",y())}function tu(n){ti=n,y()}function nr(){ft=ti!==null?ti:iu()}function iu(){var r=c.breadcrumbContainer,u=c.breadcrumb,n,i;return u&&r?(n=t(u),i=r.offsetWidth-parseInt(n.get_style("paddingLeft"))-parseInt(n.get_style("paddingRight")),i>0?i:0):0}function ru(){y()}function uu(){var t,n,i;if(nr(),ft<=0){c.breadcrumb&&(c.breadcrumb.style.display="none");return}if(c.breadcrumb&&(c.breadcrumb.style.display="block"),t=c.breadcrumbBar.offsetWidth,t>=ft)for(n=0,i=p.length-1;n<i;n++)if(c[p[n]].firstChild.nodeValue="...",c[p[n]].setAttribute("title",l[p[n]]),t=c.breadcrumbBar.offsetWidth,t<ft)break;fu()}function fu(){var t,n,i;if(nr(),ft<=0){c.breadcrumb&&(c.breadcrumb.style.display="none");return}if(c.breadcrumb&&(c.breadcrumb.style.display="block"),t=c.breadcrumbBar.offsetWidth,t>=ft)for(n=0,i=w.length;n<i;n++)if(a[w[n].name].firstChild.nodeValue="...",a[w[n].name].setAttribute("title",w[n].value),t=c.breadcrumbBar.offsetWidth,t<ft)break;vr(it)}function tr(){c.breadcrumb&&(yi(c.breadcrumbContainer),c.breadcrumbContainer.parentNode.removeChild(c.breadcrumbContainer),c.breadcrumbContainer=null,c.breadcrumb=null)}function eu(t){var u=a[t+"Delim"],f,i,r;u&&(u.parentNode.removeChild(u),a[t+"Delim"]=null),f=lt(t),f.type==="group"?(i=t+"Click",n.removeHandler(b[i]),b[i]=null,i=t+"MouseEnter",n.removeHandler(b[i]),b[i]=null,i=t+"MouseLeave",n.removeHandler(b[i]),b[i]=null,f===it&&ut(!0),r=a[t+"Container"],a[t+"Container"]=null,a[t]=null,a[t+"ListSign"]=null,r.parentNode.removeChild(r)):(i=t+"Click",n.removeHandler(b[i]),b[i]=null,r=a[t],a[t]=null,r.parentNode.removeChild(r))}function ou(t){var i,r,u;g=t,y();switch(t){case"world":case"country":case"state":case"county":case"city":case"neighborhood":gi();break;case"current":pt();break;default:n.invoke(v,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:lt(t).value});return}i={animate:gr},f.isStreetside&&f.isStreetside()&&(i.mapTypeId=k.road),r=l[t+"Bounds"],r?(u=dt.fromEdges(r[2],r[1],r[0],r[3]),i.bounds=u):t==="current"?(i.center=l.currentCenter,i.zoom=l.currentZoom):(i.center=l.currentCenter,i.zoom=l[t+"Zoom"]),yu(i),n.invoke(v,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:l[t]})}function ir(){ou(this.attributes.pathNodeLevel.value)}function rr(){var h,n,u,e;c.root||(c.root=f.getRootElement(),h=r("div","pathContainer"),c.breadcrumb=h,h.setAttribute("onselectstart","return false;"),n=r("div",s.getClassName(),o),s.getDomElement=function(){return n},ot(n),c.breadcrumbContainer=n,n.appendChild(c.breadcrumb),u=document.createElement("div"),u.className="unlockButton",e=t(u),e.add_event("click",hr),e.add_event("touchstart",i),e.add_event("touchend",hr),c.root.appendChild(u),c.breadcrumbUnlock=u,su())}function su(){var f,i,r,o,e,n;if(c.breadcrumb){f=document.createElement("span"),f.className="path";for(i in et)r=document.createElement("span"),i!=="world"?(i==="current"&&(o=document.createElement("span"),f.appendChild(o),c.breadcrumbExtension=o),e="•",r.className="pathNodeDelim",r.style.display="none"):(e="",r.className="pathHeight",r.style.display="inline-block"),r.appendChild(document.createTextNode(e)),f.appendChild(r),c[i+"Delim"]=r,i==="current"?(n=document.createElement("a"),n.className="currentIcon",n.href="#",n.title=u.getString("L_currentIconTooltip_Text")):(n=document.createElement("a"),n.href="#",n.className="pathNode",i!=="world"?n.appendChild(document.createTextNode("")):n.appendChild(document.createTextNode(l[i]))),i!=="world"&&(n.style.display="none"),t(n).add_event("click",ir),n.setAttribute("pathNodeLevel",i),n.setAttribute("uici","BC.PN."+i),f.appendChild(n),c[i]=n;c.breadcrumbBar=f,c.breadcrumb.appendChild(f)}}function ur(){h.country=null,h.state=null,h.county=null,h.city=null,h.neighborhood=null,h.street=null,h.current=null,h.countryBounds=null,h.stateBounds=null,h.countyBounds=null,h.cityBounds=null,h.neighborhoodBounds=null,h.streetBounds=null,h.currentBounds=null,h.countryEntityId=null,h.stateEntityId=null,h.countyEntityId=null,h.cityEntityId=null,h.neighborhoodEntityId=null,h.streetEntityId=null,h.currentEntityId=null}function fr(){c.breadcrumbUnlock.style.display="block"}function er(){c.breadcrumbUnlock.style.display="none"}function hu(n,t,i,r,u){var f={type:n,name:t,value:i,values:r,isVisible:u};w.push(f),cu(f)}function cu(n){var u=document.createElement("span"),r,f,i;u.className="pathNodeDelim",u.style.display="none",u.appendChild(document.createTextNode("•")),a[n.name+"Delim"]=u,c.breadcrumbExtension.appendChild(u),n.type==="group"?(r=document.createElement("span"),r.className="groupContainer",r.style.display="none",r.setAttribute("pathNodeLevel",n.name),b[n.name+"Click"]=t(r).add_event("click",bu),b[n.name+"MouseEnter"]=t(r).add_event("mouseenter",cr),b[n.name+"MouseLeave"]=t(r).add_event("mouseleave",lr),i=document.createElement("span"),i.className="group",i.appendChild(document.createTextNode("")),f=document.createElement("span"),f.className="groupListSign",a[n.name+"Container"]=r,a[n.name]=i,a[n.name+"ListSign"]=f,r.appendChild(i),r.appendChild(f),c.breadcrumbExtension.appendChild(r)):(i=document.createElement("span"),i.className="pathNode",i.appendChild(document.createTextNode("")),i.style.display="none",b[n.name+"Click"]=t(i).add_event("click",ir),i.setAttribute("pathNodeLevel",n.name),i.setAttribute("uici","BC.PN."+n.name),a[n.name]=i,c.breadcrumbExtension.appendChild(i))}function lu(n,t){var i=lt(n);i.isVisible!==t&&(i.type==="group"&&t===!1&&i===it&&ut(!0),i.isVisible=t,y())}function au(n){eu(n),w.splice(vu(n),1),y()}function lt(n){for(var t=w.length;t--;)if(w[t].name===n)return w[t]}function vu(n){for(var t=w.length;t--;)if(w[t].name===n)return t}function or(t,i){var r=lt(t),u=r.value;r.value=i,a[t].firstChild.nodeValue=i,hi(t),y(),n.invoke(v,"groupselecteditemchanged",{groupName:t,newItem:i,oldItem:u})}function sr(t){ct=!0,ht=t,bt(!0),n.invoke(v,"locked")}function yu(t){at||(at=n.addHandler(f,"targetviewchanged",di)),f.setView(t),window.setTimeout(function(){at&&di()},100)}function pu(){ct=!1}function wu(){ct=!1,er(),ut(!0),pt(),ur(),h.currentZoom=f.getTargetZoom(),wr(),g=p[d],y(),ht=f.getTargetCenter(),bt(!0),n.invoke(v,"unlocked")}function hr(t){wu(),n.invoke(v,"closed"),t.stopPropagation()}function bu(){var t=this.attributes.pathNodeLevel.value,i=lt(t);hi(t),y(),a.groupList?ut(!0):yr(i),n.invoke(v,"pathnodeclicked",{pathNodeLevel:t,pathNodeValue:i.value})}function cr(){yr(lt(this.attributes.pathNodeLevel.value))}function lr(){a.groupList&&ut()}function wt(n){or(it.name,this.firstChild.nodeValue),ut(!0),i(n)}function ar(){var u,f,r;if(tt=null,a.groupList){for(n.removeHandler(ii),n.removeHandler(ri),u=a.groupList.childNodes,f=u.length;f--;)r=t(u[f]),r.remove_event("click",wt),r.remove_event("touchstart",i),r.remove_event("touchend",wt);ii=null,ri=null,a.groupList.parentNode.removeChild(a.groupList),a.groupList=null,it=null}}function ut(n){a.groupList&&(n?(tt&&(clearTimeout(tt),tt=null),ar()):tt||(tt=setTimeout(ar,1e3)))}function vr(n){var i=a.groupList;if(i){var r=t(o).get_absolute_pos(),u=c.breadcrumb,f=t(u).get_absolute_pos().y+u.offsetHeight-r.y,e=t(a[n.name+"Container"]).get_absolute_pos().x-r.x;i.style.top=f+"px",i.style.left=e+"px"}}function yr(n){var r,e,u,f;if(it)if(it!==n)ut(!0);else{tt&&(clearTimeout(tt),tt=null);return}r=document.createElement("ul"),a.groupList=r,it=n,r.className="pathList",r.style.position="absolute",r.setAttribute("pathNodeLevel",n.name),o.appendChild(r),ii=t(r).add_event("mouseenter",cr),ri=t(r).add_event("mouseleave",lr);for(e in n.values)u=document.createElement("li"),u.appendChild(document.createTextNode(n.values[e])),r.appendChild(u),f=t(u),f.add_event("click",wt),f.add_event("touchstart",i),f.add_event("touchend",wt);vr(n)}function ku(){l.country=null,l.state=null,l.county=null,l.city=null,l.neighborhood=null,l.street=null,l.current=null,l.countryBounds=null,l.stateBounds=null,l.countyBounds=null,l.cityBounds=null,l.neighborhoodBounds=null,l.streetBounds=null,l.currentBounds=null,l.countryEntityId=null,l.stateEntityId=null,l.countyEntityId=null,l.cityEntityId=null,l.neighborhoodEntityId=null,l.streetEntityId=null,l.currentEntityId=null,d=et.world,g="world"}function ei(){fi=vi,st++,f.getCredentials(function(n){if(n){var t=ci+"/"+ht.latitude.toFixed(10)+","+ht.longitude.toFixed(10)+"?include=EntityId&includeEntityTypes=Neighborhood,PopulatedPlace,AdminDivision1,AdminDivision2,CountryRegion&output=json&key="+n+"&culture="+ni;rt.useXHR||(t+="&jsonp=microsoftMapsNetworkCallback&jsonso={jsono}"),yt.getObjectAsync(t,nf,st)}})}function bt(n,t){n?(clearTimeout(nt),nt=null,ei()):(fi===pi&&nt&&(clearTimeout(nt),nt=null),st++,fi=pi,nt=t?setTimeout(ei,t):setTimeout(ei,nu))}function oi(n){for(var i="",r=et[n]+1,t;r-->1;){var u=p[r],e=du[u],o=h[u];if(e&&o)i+="&"+e+"="+o;else{si();return}}n!=="street"&&(t=ki.get(h[n+"EntityId"])),t?(h[n+"Bounds"]=t,si()):f.getCredentials(function(n){if(n){var t=ci+"?key="+n+"&culture="+ni+"&output=json"+i;rt.useXHR||(t+="&jsonp=microsoftMapsNetworkCallback&jsonso={jsono}"),yt.getObjectAsync(t,uf,st)}})}function y(){var f=et,u,n,i,r;vt.selectedCrumb=g;for(n in f)i=c[n],n!=="current"&&(n==="street"?i.firstChild.nodeValue="Near "+l[n]:(u=l[n],u||(u=""),i.firstChild.nodeValue=u),i.removeAttribute("title"),r=c[n+"Delim"],et[n]>d&&!ct||!l[n]?(i&&(i.style.display="none"),r&&n!=="world"&&(r.style.display="none")):(i&&(i.style.display="inline",n===g?t(i).add_class("pathNodeSelected"):t(i).remove_class("pathNodeSelected")),r&&n!=="world"&&(r.style.display="inline")));gu(),uu()}function gu(){for(var n,i,r,u=0,f=w.length;u<f;u++)n=w[u],i=a[n.name],i.firstChild.nodeValue=n.value,i.removeAttribute("title"),r=a[n.name+"Delim"],n.isVisible?(i&&(n.type==="group"?a[n.name+"Container"].style.display="inline":i.style.display="inline",n.name===g?t(i).add_class("pathNodeSelected"):t(i).remove_class("pathNodeSelected")),r&&(r.style.display="inline")):(i&&(n.type==="group"?(a[n.name+"Container"].style.display="none",ut(!0)):i.style.display="none"),r&&(r.style.display="none"))}function nf(n,t){var c=t.userData,e,o,f,s,r,u,i;if(c===st&&t.success&&n.statusCode===200){if(e=n.resourceSets[0],o=!1,e.estimatedTotal>0){for(f=e.resources,ur(),r=f.length;r--;)if(u=f[r],s=u.entityType,pr[s]&&s!=="Neighborhood"){i=u.address,h.country=i.countryRegion,h.state=i.adminDistrict,h.county=i.adminDistrict2,h.city=i.locality,h.street=i.addressLine,h.countryEntityId=i.countryRegionEntityId,h.stateEntityId=i.adminDistrictEntityId,h.countyEntityId=i.adminDistrict2EntityId,h.cityEntityId=i.localityEntityId,h.streetEntityId=i.addressLineEntityId;break}for(r=f.length;r--;)if(u=f[r],u.entityType==="Neighborhood"){i=u.address,h.country=i.countryRegion,h.state=i.adminDistrict,h.county=i.adminDistrict2,h.neighborhood=i.locality,h.countryEntityId=i.countryRegionEntityId,h.stateEntityId=i.adminDistrictEntityId,h.countyEntityId=i.adminDistrict2EntityId,h.neighborhoodEntityId=i.localityEntityId;break}o=!0}else ku(),y();vt={currentCrumb:p[d],selectedCrumb:g,country:h.country,state:h.state,county:h.county,neighborhood:h.neighborhood,city:h.city,street:h.street,location:n},o&&rf()}}function tf(n,t){var i=pr[n];h[i+"Bounds"]=t,ki.add(h[i+"EntityId"],t)}function rf(){li=3,oi("city"),oi("state"),oi("country")}function uf(n,t){var r=t.userData,i;r===st&&t.success&&n&&n.statusCode===200&&n.resourceSets&&n.resourceSets.length>0&&n.resourceSets[0].resources&&n.resourceSets[0].resources.length>0&&(i=n.resourceSets[0].resources[0],tf(i.entityType,i.bbox)),si()}function si(){--li||(l=h,wr(),vt.currentCrumb=p[d],n.invoke(v,"breadcrumbschanged"),y())}function ff(n){var t=f.getBounds();return!(n.width>t.width||n.height>t.height)}function ef(n){var t=f.getBounds(),i=Math.min(t.width/4,t.height/4);return n.width>=i||n.height>=i}function wr(){var n,u,t,i,f,r;if(ct){d=et.neighborhood;return}for(n=0,u=p.length-1;n<u;n++)if(l[p[n]])if(t=l[p[n]+"Bounds"],t)if(i=dt.fromEdges(t[2],t[1],t[0],t[3]),ff(i)){f=i,ef(i)&&(d=n);break}else d=n;else if(r=l[p[n]+"Zoom"],r)if(r>=l.currentZoom){if(r<l.currentZoom+2){d=n;break}}else d=n;g=p[d]}function of(){rr(),ht=f.getTargetCenter(),h.currentZoom=f.getTargetZoom(),bt(!1,5e3),ai=n.addHandler(f,"viewchangeend",sf)}function sf(){gt.areEqual(f.getTargetCenter(),wi)&&f.getTargetZoom()===bi||(pt(),ct===!1?(ht=f.getCenter(),h.currentZoom=f.getZoom(),bt()):y())}function hi(n){g!==n&&(g=n,y())}function br(){nt&&(clearTimeout(nt),nt=null),n.removeHandler(ai),tr()}function dr(){kt&&(n.removeHandler(kt),kt=null,br(),f.addComponent("breadcrumb",v))}var ci=e.Globals.bingMapsRESTServicesUrl,ni="en-us",li=0,ft=0,ti=null,st=0,ht,it,ii=null,ri=null,b={},ui,gr=!0,v=this,ct=!1,ai,vt={},g="world",vi="ready",pi="wait",fi=vi,wi,bi,at,nt,nu=1e3,tt,w=[],l={world:u.getString("L_world_Text"),worldBounds:[-75,-175,75,175],countryZoom:4,stateZoom:7,countyZoom:10,cityZoom:13,neighborhoodZoom:15,streetZoom:16,current:""},h=l,et={world:0,country:1,state:2,county:3,city:4,neighborhood:5,street:6,current:7},p=["world","country","state","county","city","neighborhood","street","current"],d=et.world,c={},a={},ki={_cacheSize:100,_history:[],_recentlyUsed:[],_cache:{},add:function(n,t){n&&(this._cache[n]=t,this._history.push(n),this._history.length>this._cacheSize&&delete this._cache[this._history.shift()])},get:function(n){return n?this._cache[n]:null}},du={street:"addressLine",city:"locality",county:"adminDistrict2",state:"adminDistrict",country:"countryRegion"},pr={Dependent:"country",Sovereign:"country",CountryRegion:"country",AdminDivision1:"state",AdminDivision2:"county",PopulatedPlace:"city",Neighborhood:"neighborhood",Address:"street"},kr=e.Globals.locale,kt;kr&&(ni=kr.toLowerCase()),n.addHandler(f,"resize",ru),f.addComponent("breadcrumb",v),kt=n.addHandler(f,"ondispose",dr),v.enable=of,v.disable=br,v.dispose=dr,v.setWidth=tu,v.lockToLocation=sr,v.unlockFromLocation=pu,v.showCloseButton=fr,v.hideCloseButton=er,v.addCrumb=hu,v.removeCrumb=au,v.setVisibility=lu,v.selectGroupItem=or,v.highlightCrumb=hi,v.showBookmark=gi,v.hideBookmark=pt,v.relocateCloseButton=function(n,t){c.breadcrumbUnlock.style.top=n,c.breadcrumbUnlock.style.right=t},v.getBreadcrumbs=function(){return vt},this.enable()}function lr(f,e,o){function nt(){b&&(n.removeHandler(b),b=null,a&&a.dispose(),t(p).remove_event("click",it).remove_event("mouseenter",l).remove_event("mouseleave",v),t(y).remove_event("click",tt).remove_event("mouseenter",l).remove_event("mouseleave",v),s.parentNode.removeChild(s))}function tt(n){i(n),h(f,n),vt()?l():d(),f.setView({zoom:f.getTargetZoom()+1})}function it(n){i(n),h(f,n),vt()?l():d(),f.setView({zoom:f.getTargetZoom()-1})}function l(){g(),o.getZoomBarVisible()&&(c||(c=r("div","NavBar_zoomDrop"),c.style.cssText="position:absolute;display:none;",a=new sr(f,c,o.getZoomBarToggle()),s.firstChild?s.insertBefore(c,s.firstChild):s.appendChild(c),o.getZoomBarToggle()&&t(c).add_event("mouseenter",l).add_event("mouseleave",v)),c.style.display==="none"&&(c.style.display="",a.show()),vt()&&a.resetZoomBarTimer())}function v(){g(),w=window.setTimeout(d,1e3)}function d(){g(),o.getZoomBarToggle()&&c&&(c.style.display="none")}function g(){w&&(window.clearTimeout(w),w=null),k&&(window.clearTimeout(k),k=null)}var rt=this,s,y,p,c,a,w,k,b;s=r("div",o.getClassName()),ot(s),p=at("NavBar_zoomOut",u.getString("L_zoomOutTooltip_Text")),t(p).add_event("click",it).add_event("mouseenter",l).add_event("mouseleave",v).set_attr("uici","NB.ZC.ZoomOut"),y=at("NavBar_zoomIn",u.getString("L_zoomInTooltip_Text")),t(y).add_event("click",tt).add_event("mouseenter",l).add_event("mouseleave",v).set_attr("uici","NB.ZC.ZoomIn"),o.getZoomOutVisible()&&s.appendChild(p),o.getZoomInVisible()&&s.appendChild(y),e.appendChild(s),o.getZoomBarToggle()||l(),o.getDomElement=function(){return s},b=n.addHandler(f,"ondispose",nt),this.dispose=nt}function ar(t,i,u){function a(){if(h){n.removeHandler(h),h=null;for(var t=e.length;t--;)n.removeHandler(e[t][2]);c.dispose(),f.parentNode.removeChild(f)}}var e=[["showmaptypemenu",function(n){o(v.getNavBar(t),"showmaptypemenu",n)}],["hidemaptypemenu",function(n){o(v.getNavBar(t),"hidemaptypemenu",n)}]],c,f=r("div",u.getClassName()),y,l,s,h;for(ot(f),y=r("span","NavBar_separator",f),l={disableBirdseye:u.getDisableBirdseye()},c=u.getMapTypes()!==null?new or(t,f,this,l):new er(t,f,this,l),i.appendChild(f),u.getDomElement=function(){return f},s=e.length;s--;)e[s][2]=n.addHandler(c,e[s][0],e[s][1]);h=n.addHandler(t,"ondispose",a),this.dispose=a}function vr(t,i,u){function p(){a&&(n.removeHandler(a),n.removeHandler(b),a=null,f.parentNode.removeChild(f)),v&&n.removeHandler(v),y&&n.removeHandler(y)}for(var o=new d,f=r("div",u.getClassName()),w=u.getLength(),s,h,l,e=0;e<w;e++)s=u.get(e),h=c.getRenderer(s),typeof h=="function"&&new h(t,f,s);u.getStopPropagation()&&ot(f),i=u.getParentOverride()||i,l=u.getNextSibling(),l?i.insertBefore(f,l):i.appendChild(f),u.getDomElement=function(){return f},o.setContext(f);var b=n.addHandler(u,"entitychanged",function(n){n&&n.entity==u&&(n.handled=!0,f.className=u.getClassName(),u.getStopPropagation()?ot(f):yi(f))}),v=n.addHandler(u,"entityadded",function(n){if(n&&n.collection==u){var i=n.entity,r=c.getRenderer(i);typeof r=="function"&&new r(t,f,i),o.insert(i,n.index)}}),y=n.addHandler(u,"entityremoved",function(n){o.remove(n.entity)}),a=n.addHandler(t,"ondispose",p);this.dispose=p}function d(n){function e(n){var t=document.createElement("div");return t.className="item",t.style.marginRight="1px",t.entity=n,t}function o(n){for(var t=n.length;t--;)s(n[t])}function s(n){n.parentNode&&n.parentNode.removeChild(n)}function u(n){var s,o,u,e,h;if(r){for(s=n===d.Layout.TopBottom||n===d.Layout.BottomTop?"none":"left",((i===d.Layout.TopBottom||i===d.Layout.LeftRight)&&(n===d.Layout.BottomTop||n===d.Layout.RightLeft)||(i===d.Layout.BottomTop||i===d.Layout.RightLeft)&&(n===d.Layout.TopBottom||n===d.Layout.LeftRight))&&t.reverse(),o=0;o<t.length;o++)u=t[o],u.wrapped||(e=u.entity,h=e&&e.getDomElement&&e.getDomElement(),h?u.appendChild(h):u.appendChild(e),u.wrapped=!0),u.style.cssFloat!==undefined?u.style.cssFloat=s:u.style.styleFloat!==undefined&&(u.style.styleFloat=s),r.appendChild(u);r.appendChild(f)}}var r=n,t=[],i=d.Layout.TopBottom,f=document.createElement("span");f.style.cssText="display:block;height:0;width:0;line-height:0;font-size:0;clear:both;",this.setContext=function(n){r||(r=n,u(i))},this.add=function(n){var r=e(n);t.push(r),u(i)},this.insert=function(n,r){var f=e(n);t.splice(r,0,f),u(i)},this.pop=function(){s(t.pop())},this.removeAt=function(n){o(t.splice(n,1))},this.remove=function(n){for(var i=t.length;i--;)if(t[i].entity===n){this.removeAt(i);break}},this.clear=function(){o(t),t.length=0},this.setLayout=function(n){n!==i&&(u(n),i=n)}}function li(n){var i=document.createElement("span");t(i).add_class("shadowtextDark"),n.appendChild(i),this.setColorsForDarkBackground=function(){t(i).swap_class("shadowtextDark","shadowtextLight")},this.setColorsForLightBackground=function(){t(i).swap_class("shadowtextLight","shadowtextDark")},this.setHtmlContent=function(n){i.innerHTML=n},this.setTextContent=function(n){i.innerHTML="",i.appendChild(document.createTextNode(n))}}function yr(t,i,u){function a(){p(),e=window.setTimeout(k,b)}function p(){e!=null&&window.clearTimeout(e)}function k(){e=null,f.getCopyrights(d)}function d(i,r){r!==l&&(l=r,n.invoke(t,"logorequirementschanged",{showCombinedLogo:l}));for(var f=i.concat(c).sort(function(n,t){return(n||"").length>(t||"").length}),e=f.length,u=0;u<e;u++)f[u]&&(f[u]='<span class = "copyrightAttribution">'+f[u]+"<\/span>");h.setHtmlContent(f.join(""))}function v(){g.getImageryBackground(t.getImageryId())===g.light?h.setColorsForLightBackground():h.setColorsForDarkBackground()}function nt(){if(s){n.removeHandler(s),s=null;for(var t=o.length;t--;)n.removeHandler(o[t]);o.length=0}}var y=r("div",u.getClassName(),i),o,s,w;u.getDomElement=function(){return y};var h=new li(y),f=t,c=[],e=null,b=1e3,l=null;a(),v(),o=[n.addThrottledHandler(f,"copyrightchanged",a,2e3),n.addHandler(f,"imagerychanged",v),n.addHandler(f,"modechanged",v),n.addHandler(f,"viewchangestart",p)],s=n.addHandler(t,"ondispose",nt),w=new function(){this.get_customAttributions=function(){return c},this.set_customAttributions=function(n){c=n,a()}},t.addComponent("copyright",w)}function pr(i,f,e){function ii(){var d,b,k,f,y;it=n.addHandler(i,"ondispose",ri),a=r("div",e.getClassName(),ni),e.getDomElement=function(){return a},l=t(a),(lt||at)&&l.add_event("mouseover",ht).add_event("mouseout",ct).add_event("mousedown",s).add_event("mouseup",s).add_event("dblclick",s).add_event("contextmenu",s).add_event("click",s),o=document.createElement("a"),o.href="http://www.bing.com",o.title=u.getString("L_BingLogoTooltip_Text"),o.target="mc_bingMaps",lt?n.addHandler(i,"viewchangeend",yt):(o.onclick=function(){return!1},o.style.cursor="default",o.tabIndex=-1),nt=document.createElement("span"),nt.id="bingLogo",o.appendChild(nt),v=document.createElement("span"),v.id="cobrandLogo",v.style.display="none",o.appendChild(v),d=document.createElement("span"),d.className="ms-clear",d.style.cssText="float: none !important",o.appendChild(d),a.appendChild(o),n.addHandler(i,"imagerychanged",ft),n.addHandler(i,"maptypechanged",ft),n.addHandler(i,"logorequirementschanged",pt),ft(),pt({showCombinedLogo:!1}),at&&(b=document.createElement("div"),b.className="LogoSearchContainer",k=document.createElement("div"),k.className="LogoSearchGroup",b.appendChild(k),f=document.createElement("input"),f.id="LogoSearchInput",f.type="text",rt.useXHR&&(f.style.margin="0"),f.maxLength=60,f.className="watermark",f.value=u.getString("L_BingSearchWatermark_Text"),w=!0,k.appendChild(f),y=document.createElement("input"),y.id="LogoSearchGo",rt.useXHR||(y.type="button"),y.title=u.getString("L_BingSearchGoTooltip_Text"),k.appendChild(y),h=t(b),h.set_style({display:"none"}),p=!1,t(o).add_event("focus",ht).add_event("blur",ct).add_event("keypress",oi),h.add_event("mouseover",wt).add_event("mouseout",bt).add_event("mousedown",s).add_event("mouseup",s).add_event("dblclick",s).add_event("contextmenu",s),tt=t(y),tt.add_event("blur",et).add_event("focus",ot).add_event("click",st),c=t(f),c.add_event("blur",kt).add_event("focus",dt).add_event("keydown",gt),a.appendChild(b))}function ri(){it&&(n.removeHandler(it),it=null),o&&n.removeHandler(yt),l&&l.remove_event("mouseover",ht).remove_event("mouseout",ct).remove_event("mousedown",s).remove_event("mouseup",s).remove_event("dblclick",s).remove_event("contextmenu",s).remove_event("click",s),a.parentNode.removeChild(a),h&&(h.remove_event("mouseover",wt).remove_event("mouseout",bt).remove_event("mousedown",s).remove_event("mouseup",s).remove_event("dblclick",s).remove_event("contextmenu",s),tt.remove_event("blur",et).remove_event("focus",ot).remove_event("click",st),c.remove_event("blur",kt).remove_event("focus",dt).remove_event("keydown",gt),h.element().parentNode.removeChild(h.element())),d(),o=null,nt=null,v=null,a=null,tt=null,c=null,h=null}function d(){h&&k&&(window.clearTimeout(k),k=null)}function ut(){h&&b&&(d(),k=window.setTimeout(fi,2e3))}function vt(){w||c.element().value||(c.element().value=u.getString("L_BingSearchWatermark_Text"),c.add_class("watermark"),w=!0)}function ui(){w&&(c.element().value="",c.remove_class("watermark"),w=!1)}function fi(){k=null,ei(),b=!1}function ei(){h.set_style({display:"none"}),l.remove_class("Active"),h.set_style("width",null)}function yt(){if(o){var n=i.getCenter();n&&(o.href=y.logoBingMapsLink.replace("{0}",n.latitude).replace("{1}",n.longitude).replace("{2}",i.getZoom()))}}function pt(n){t(v).set_style({display:n.showCombinedLogo?"":"none"}),l.set_style({display:ti&&!n.showCombinedLogo?"none":""})}function ft(){g.getImageryBackground(i.getImageryId())===g.dark?l.add_class("dark"):l.remove_class("dark")}function wt(){d()}function bt(){p||ut()}function oi(n){n.charCode&&(c[0].focus(),c.set_val(String.fromCharCode(n.charCode)))}function et(){p=!1,ut()}function ot(){p=!0,d()}function kt(n){et(n),vt()}function dt(n){ot(n),ui()}function st(){var n=c.element().value,t;!w&&typeof n=="string"&&n.length>0&&(c.element().value="",vt(),n=ur.encodeUrl(n),t=y.logoBingSearchUrl.replace("{0}",n),window.open(t,"mc_bingSearch"),ut())}function gt(n){p&&n.keyCode===13&&st()}function ht(){d(),h&&!b&&(h.set_style({display:""}),b=!0,l.add_class("Active"))}function ct(){h?b&&!p&&ut():l.remove_class("Active")}var ni=f,lt=e.getClickable(),at=e.getEnableSearch(),ti=e.getShowCombinedOnly(),si=this,nt=null,v=null,b=!1,p=!1,w=!1,k=null,l=null,h=null,c=null,tt=null,a=null,o=null,it;ii()}function ai(n,i){function p(n){for(var r=Math.floor(n),i,t=0;t<a.length;t++)if(i=a[t],r>i)return i;return 1}function w(n,t){for(var r,i=0;i<v.length;i++)if(r=v[i],n>r)return r*t;return t}function r(n){var r=Math.log(n)/y,u=Math.floor(r),t=Math.pow(10,u),i=n/t;return 1===t?p(i):w(i,t)}var y=2.3025850929940459,f=n,h=i,c=0,l=0,a=[5,2],v=[5,2.5,2],o,e,s;t(f).add_class("ScaleBar"),o=document.createElement("span"),f.appendChild(o),e=new li(o),s=document.createElement("span"),s.className="scalerect",f.appendChild(s),this.getMaxWidth=function(){return c},this.setMaxWidth=function(n){return c=n,n},this.getActualWidth=function(){return l},this.setActualWidth=function(n){return l=n,n},this.setColorsForBackground=function(n){n===g.light?e.setColorsForLightBackground():e.setColorsForDarkBackground()},this.setScale=function(n){var i,t,f,s,e,o;h===ct.kilometersMeters?(s=n*this.getMaxWidth(),s>nt.metersPerKm?(t=r(s/nt.metersPerKm),i=Math.floor(t*nt.metersPerKm/n),f=u.getString("L_scaleBarKilometers_Text")):(t=r(s),i=Math.floor(t/n),f=u.getString("L_scaleBarMeters_Text"))):(e=n*nt.feetPerMeter,o=e*this.getMaxWidth(),o>nt.feetPerMile?(t=r(o/nt.feetPerMile),i=Math.floor(t*nt.feetPerMile/e),f=u.getString("L_scaleBarMiles_Text")):h===ct.milesFeet?(t=r(o),i=Math.floor(t/e),f=u.getString("L_scaleBarFeet_Text")):(t=r(o/nt.feetPerYard),i=Math.floor(t*nt.feetPerYard/e),f=u.getString("L_scaleBarYards_Text"))),this.setControlScale(i,f.replace("{num}",t))},this.setControlScale=function(n,t){this.setActualWidth(n+2),f.style.width=this.getActualWidth().toFixed()+"px",e.setTextContent(t)}}function wr(n){var e=200,u=n,i,f,r;t(u).add_class("DoubleScaleBar"),_scaleBarMiElement=document.createElement("span"),i=new ai(_scaleBarMiElement,ct.milesFeet),i.setMaxWidth(e/2),u.appendChild(_scaleBarMiElement),f=document.createElement("span"),r=new ai(f,ct.kilometersMeters),r.setMaxWidth(e/2),u.appendChild(f),this.setColorsForBackground=function(n){r.setColorsForBackground(n),i.setColorsForBackground(n)},this.setScale=function(n){r.setScale(n),i.setScale(n)}}function br(t,i,u){function h(){f.setScale(t.getMetersPerPixel())}function c(){f.setColorsForBackground(g.getImageryBackground(t.getImageryId()))}function l(){if(o){n.removeHandler(o),o=null;for(var t=e.length;t--;)n.removeHandler(e[t]);e.length=0}}var s=r("div",u.getClassName(),i),f,e,o;u.getDomElement=function(){return s},f=new wr(s),f.setScale(t.getMetersPerPixel()),e=[n.addHandler(t,"viewchangeend",h),n.addHandler(t,"imagerychanged",c),n.addHandler(t,"modechanged",h)],o=n.addHandler(t,"ondispose",l)}function kr(i,r){function ut(){var n=i.getOptions();return!(n.disablePanning||n.disableMouseInput||n.disableUserInput)}function ft(){var n=i.getOptions();return!(n.disableZooming||n.disableMouseInput||n.disableUserInput)}function kt(n){var t=Math.round(i.getTargetZoom()),r=1<<t,u=new pt(t,Math.floor(n.x*r),Math.floor(n.y*r));return ni.fromTileId(u,!1)}function ti(){var n=i.getOptions().labelOverlay;nt=n===tt.hidden?!0:r}function ii(){var n=null,t=i.getImageryId();switch(t){case"Road":n=ui;break;case"Aerial":n=fi;break;case"EnhancedBirdseye":case"NativeBirdseye":u.removeLayer(a),a=null;break;default:h.removeLayer(a),a=null,vt()}n!==a&&(at(),h.removeLayer(a),h.addLayer(n),a=n,et())}function ei(n){d=n}function oi(){s&&(n.removeHandler(s),s=null,c||(d=null,c=n.addHandler(i,"mousemove",ei)),o&&ht())}function et(){c&&(n.removeHandler(c),c=null),s||(s=n.addHandler(i,"mousemove",ct));var t=Math.round(i.getTargetZoom()),r=p.getMapTargetMercatorBounds(i);h.loadQuadkeysForMercatorBounds(r,t),d&&(ct(d),d=null)}function si(n){return v&&(window.clearTimeout(v),v=null),n.handled=!1,!1}function hi(n){if(n.targetType!=="map"&&n.target.pointerEvents!=="none"||n.mouseMoved)return n.handled=!1,!1;if(v)return n.handled=!0,!0;var i=new f(n.getX(),n.getY()),t=st(i);return t?(v=window.setTimeout(function(){ci(t.hotRegion,i,t.worldPoint)},250),n.handled=!0,!0):(n.handled=!1,!1)}function ci(t,r,f){var s,h,w,o;if(v=null,s={hotRegion:t,cancelDefault:!1,clickLocation:i.tryPixelToLocation(r,null,{normalizeLongitude:!1})},n.invoke(u,"click",s),h=t.bmv,!s.cancelDefault&&h){var c=h.tl,l=h.br,b=h.z,a=h.c,y=360*Math.floor(f.x),p=180*Math.floor(f.y),e;c&&l?(w=dt.fromEdges(c.y+p,c.x+y,l.y+p,l.x+y),ot(w.center,s.clickLocation),e={bounds:w,animate:!0},ut()||(o=i.getCenter(),ot(o,s.clickLocation),e.center=o),ft()||(e.center=e.center||e.bounds.center,delete e.bounds),i.setView(e)):a&&b&&(o=ut()?new gt(a.y+p,a.x+y):i.getCenter(),ot(o,s.clickLocation),e={center:o,zoom:ft()?b:i.getZoom(),animate:!0},i.setView(e))}}function ot(n,t){while(n.longitude-t.longitude>180&&n.longitude>t.longitude)n.longitude-=360;while(t.longitude-n.longitude>180&&n.longitude<t.longitude)n.longitude+=360}function st(n){var s=i.getMode().tryPixelToMercatorPoint,t,c,r,u,e,o;if(s){t=s(n),c=new f(t.x,t.y),t.x=(t.x%1+1)%1,t.y=(t.y%1+1)%1;for(var v=kt(t),l=h.getTileHotRegionsForQuadkey(v),a=l.length;a--;)if((r=l[a],!nt||r.type!=="label")&&r.getMercatorBounds().contains(t))for(u=r.boundRegions,e=u.length;e--;)if(o=u[e],o.getMercatorBounds().contains(t)&&o.isMercatorPointInBoundRegion(t))return{hotRegion:r,worldPoint:c}}return null}function ht(){var t={hotRegion:o,cancelDefault:!1};n.invoke(u,"leave",t),!t.cancelDefault&&l&&(it.set_style({cursor:l}),l=null),o=null}function ct(i){var h;if(i.targetType!=="map"&&i.target.pointerEvents!=="none")if(o)var s=!0,c=!1,e=null;else return;if(!s)var v=new f(i.getX(),i.getY()),a=st(v),e=a&&a.hotRegion,s=o&&(!e||e.id!==o.id),c=e&&(!o||o.id!==e.id);s&&ht(),o=e,c&&(h={hotRegion:e,cancelDefault:!1},n.invoke(u,"enter",h),!h.cancelDefault&&e&&e.bmv&&(!r||e.type!=="label")&&(l=it.get_style("cursor"),rt.isWebkit&&l.toLowerCase().indexOf("/cursors/grab.cur")!==-1?l=bt.Grab:t.Browser.is_ie&&(l+=", "+bt.Grab),(ut()||ft())&&it.set_style({cursor:"pointer"})))}function at(){s||(s=n.addHandler(i,"mousemove",ct)),w||(w=n.addHandler(i,"click",hi)),g||(_mapMouseClickDoubleHandle=n.addHandler(i,"dblclick",si)),b||(b=n.addHandler(i,"viewchangeend",et)),k||(k=n.addHandler(i,"viewchangestart",oi))}function vt(){c&&(n.removeHandler(c),c=null),s&&(n.removeHandler(s),s=null),w&&(n.removeHandler(w),w=null),g&&(n.removeHandler(g),g=null),b&&(n.removeHandler(b),b=null),k&&(n.removeHandler(k),k=null),o&&ht()}function ri(){h.getLayerCount()>0?at():vt()}var u=this,s,w,g,yt,wt,b,k,nt=r,h=new dr,bt={Grab:"url("+y.cursorPath+"grab.cur)"+rt.cursorHotspot+", default"},it=t(i.getRootElement()),l=null,o=null,ui=new lt(e.Globals.hotRegionsRoadUrl,null,i,"r"),fi=new lt(e.Globals.hotRegionsAerialWithLabelsUrl,null,i,"a"),a=null,d,c,v;u.getHotRegionAtPoint=function(n){var t=st(n);return t&&t.hotRegion},u.enable=function(){at(),yt=n.addHandler(i,"maptypechanged",ti),wt=n.addHandler(i,"imagerychanged",ii),ti(),ii()},u.disable=function(){vt(),n.removeHandler(wt),n.removeHandler(yt),o=null},u.createLayer=function(n,t,i,r){return new lt(n,t,i,r)},u.addLayer=function(n,t){h.addLayer(n,t),ri(),et()},u.removeLayer=function(n){h.removeLayer(n),ri()},i.addComponent("hotRegions",u),u.enable()}function wt(n,t){function c(n){for(var i=[],r=n.length,t;r--;)t=n[r],i.push(new f(t.x,t.y));return i}var i,o,u,r,s,p,h;n.boundRegions=[];for(var l=n.boundRegions,a=n.brs,e=a.length;e--;)i=a[e],pi(i)?(r=c(i),r.push(r[0]),o=new ii(t,r),l.push(o)):i&&i.x&&i.y&&i.r&&(o=new ri(t,new f(i.x,i.y),i.r),l.push(o));if(n.hbrs){n.highlightBoundRegions=[];for(var v=n.highlightBoundRegions,y=n.hbrs,e=y.length;e--;)if(u=y[e],u)switch(u.t){case"polygon":r=c(u.v),r.push(r[0]),s=new ii(t,r),v.push(s);break;case"circle":s=new ri(t,new f(u.x,u.y),u.r),v.push(s)}}return p=/^YN/i,h=n.ypid,h&&p.test(h)&&(n.ypid=h.substring(2)),n.getLocationCenter=wt.prototype.getLocationCenter,n.getMercatorBounds=wt.prototype.getMercatorBounds,n}function vi(n){this.hotRegions=n}function ii(n,t){this._tileId=n,this._quadkeyTilePoints=t}function ri(n,t,i){this._tileId=n,this._quadkeyTilePointCenter=t,this._quadkeyTilePointRadius=i}function gr(i){function b(n){var t=!1,r;return n.hotRegion.type==="vm"&&(e.VenueMaps?(h||(h=new e.VenueMaps.VenueMapFactory(i)),r=h.getActiveVenueMap(),r&&n.hotRegion.vmid===r.id||(t=!0)):t=!0),t}function it(n){b(n)&&(n.cancelDefault=!0,s!==n.hotRegion.vmid&&lt(n.hotRegion.vmid))}function ut(n){b(n)&&(n.cancelDefault=!0,o=l.get_style("cursor"),rt.isWebkit&&o.toLowerCase().indexOf("/cursors/grab.cur")!==-1?o=d.Grab:t.Browser.is_ie&&(o+=", "+d.Grab),s===n.hotRegion.vmid?l.set_style({cursor:"wait"}):l.set_style({cursor:"pointer"}),f=n.hotRegion,et())}function ft(n){b(n)&&(o&&(l.set_style({cursor:o}),o=null),k(),f=null)}function k(){nt(),a&&(i.entities.remove(a),a=null)}function et(){var n,t,r,u;if(k(),f){for(a=new ei({zIndex:-1}),n=f.highlightBoundRegions?f.highlightBoundRegions:f.boundRegions,t=n.length;t--;)r=n[t],r.type==="polygon"&&(u=new rr(r.getLocations(),{strokeThickness:1,strokeColor:new si(255,0,0,0),fillColor:new si(0,0,0,0)}),u.pointerEvents="none",a.push(u));i.entities.push(a),s!==f.vmid&&ot()}}function ot(){if(!r){g=n.addHandler(i,"mousemove",st),r=document.createElement("span"),r.style.cssText="position:absolute;visibility:hidden;background-color:white;border: 1px solid black;padding:5px;";var t=f.name?u.getString("L_VenueMapExplorerTooltip_Text").replace("{0}",f.name):u.getString("L_VenueMapExplorerTooltip_Text").replace(" {0}","");r.appendChild(document.createTextNode(t)),i.getRootElement().appendChild(r)}}function nt(){r&&(n.removeHandler(g),r.parentNode.removeChild(r),r=null)}function st(n){r.style.visibility="visible",r.style.left=i.getWidth()/2+16+n.getX()+"px",r.style.top=i.getHeight()/2+16+n.getY()+"px"}function ht(){v||(v=n.addHandler(i.getComponent("hotRegions"),"click",it),p=n.addHandler(i.getComponent("hotRegions"),"enter",ut),w=n.addHandler(i.getComponent("hotRegions"),"leave",ft))}function ct(){v&&(n.removeHandler(v),v=null),p&&(n.removeHandler(p),p=null),w&&(n.removeHandler(w),w=null)}function lt(n){vt(n),e.loadModule("Microsoft.Maps.VenueMaps",{callback:function(){h||(h=new e.VenueMaps.VenueMapFactory(i));var t=h.getActiveVenueMap();t&&t.dispose(),h.create({venueMapId:n,success:at,error:yt})}})}function at(n){if(s===n.id){var t=n.bestMapView;t.animate=!0,i.setView(t),n.show(),tt(!0)}}function vt(t){s=t,f&&(l.set_style({cursor:"wait"}),nt()),n.invoke(c,"activationstart",t)}function tt(t){var i=s;s=null,f&&(o&&(l.set_style({cursor:o}),o=null),k()),n.invoke(c,"activationend",{isSuccess:t,venueMapId:i})}function yt(n,t){s===t.venueMapId&&tt(!1)}var c=this,v,p,w,h,s,o,d={Grab:"url("+y.cursorPath+"grab.cur)"+rt.cursorHotspot+", default"},l=t(i.getRootElement()),f,a,r,g;c.enable=function(){ht()},c.disable=function(){ct(),s=null},i.addComponent("venueMapsExplorer",c),c.enable()}function ft(){return null}function iu(n,t){function o(r,f){var s,e,o,h;r||f&&f.httpStatus===401?(s=r&&r.authenticationResultCode=="ValidCredentials",i=s&&typeof r.sessionId=="string"&&r.sessionId.length>0?r.sessionId:null,s||(e=document.createElement("div"),e.style.cssText="position:absolute; width:100%; top:50%; text-Align:center",o=document.createElement("div"),o.innerHTML=u.getString("L_invalidcredentials_text"),o.style.cssText="background: #f8f7f5; padding:10px; color: #000;",e.appendChild(o),h=n&&n.getRootElement(),h&&h.appendChild(e))):i=t,y.sessionId=i,_cleanup()}var e=this,r=y.logServiceUriFormat,f,i;if(r){f=[],r=r.replace(/{credentials}/,t),y.credentials=t,this.getCredentials=function(n){f.push(n)};function _cleanup(){e.getCredentials=function(n){n(i)};for(var n=f.length;n--;)e.getCredentials(f[n])}yt.getObjectAsyncWithNoJsonso(r,o,kt.getNext(),1e4)}else i=t,this.getCredentials=function(n){n(i)}}function c(n){function i(i){if(!i||i.handled!==!0){t&&t.dispose();var r=c.getRenderer(n.overlays);typeof r=="function"&&(t=new r(n,n.getRootElement(),n.overlays))}}var t;this.update=i}function wi(n){this.setOptions(n)}function bi(n){this.setOptions(n)}function ki(n){this.setOptions(n)}function et(n){this._namedEntities={},et.baseConstructor.call(this,n),this.setOptions(n)}function di(n){this.setOptions(n)}function gi(n){this.setOptions(n)}function nr(n){this.setOptions(n)}function tr(n){this.setOptions(n)}var e=window[$MapsNamespace].Maps,a=e.InternalNamespaceForDelay,ui=a.KeyEventArgs,u=window[$MapsNamespace].Maps.Resources,w=a.Common,ir=a.DelayMap,kt=a.IdGenerator,yt=a.Network,fi=a.PRF,ut,b,g,ct,nt,st,l;fi.start("mapdelay");var t=e.Gimme,y=e.Globals,ru=e.Map,f=e.Point,tt=e.LabelOverlay,n=e.Events,dt=e.LocationRect,gt=e.Location,uu=e.Pushpin,k=e.MapTypeId,ei=e.EntityCollection,it=a.MercatorCube,oi=a.SpatialCache,ni=e.QuadKey,pt=a.TileId,fu=e.AltitudeReference,ti=a.Rect,si=e.Color,rr=e.Polygon,ht=a.MapMath,rt=a.Quirks,ur=a.IOSec,v=new function(){function o(n,t,i){var r=document.createElement(n||"div");return t&&(r.className=t),i&&i.appendChild(r),r}function s(n){for(var i,t=u.length;t--;)u[t][0]===n&&(i=u[t][1]);return i}function h(t,i,r){n.invoke(t,i,r)}function f(n){n.stopPropagation()}function r(n){e=!0,n.stopPropagation()}var u=[],e=!1;this.addIgnoreEvents=function(n){t(n).add_event("mousedown",i).add_event("mouseup",i).add_event("mousewheel",i).add_event("dblclick",i).add_event("contextmenu",i).add_event("keydown",f).add_event("keyup",i).add_event("click",i).add_event("touchstart",r).add_event("touchmove",r).add_event("touchend",r).add_event("touchcancel",r)},this.removeIgnoreEvents=function(n){t(n).remove_event("mousedown",i).remove_event("mouseup",i).remove_event("mousewheel",i).remove_event("dblclick",i).remove_event("contextmenu",i).remove_event("keydown",f).remove_event("keyup",i).remove_event("click",i).remove_event("touchstart",r).remove_event("touchmove",r).remove_event("touchend",r).remove_event("touchcancel",r)},this.createElement=o,this.createToolButton=function(n,t){var i=o("a","NavBar_button NavBar_toolButton "+(n||""));return i.href="#",t&&(i.title=t),i},this.registerNavigationBar=function(n,t){u.push([n,t])},this.removeNavigationBar=function(n){for(var t=u.length;t--;)if(u[t][0]===n){u.splice(t,1);break}},this.reportAction=function(n,t){var r=s(n),i;r&&(i=t.currentTarget,i&&h(r,"navbaraction",{id:i.id,typeName:i.className,title:i.title}))},this.getNavBar=s,this.invokeEvent=h,this.ignoreEvent=function(n){n.stopPropagation(),n.preventDefault()},this.stopPropagation=f,this.isTouch=function(){return e},this.addClass=function(n,t){var i=new RegExp("(^| )"+t+"( |$)");return n+(n.search(i)===-1?" "+t:"")},this.removeClass=function(n,t){var i=new RegExp("(^| )"+t+"( |$)");return n.replace(i,"$1").replace(/^\s+|\s+$/g,"")}};a.NavigationCommon=v,ut={auto:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeAutoName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeAutoDescription_Text")}})},r:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeRoadName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeRoadDescription_Text")}})},a:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeAerialName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeAerialDescription_Text")}})},be:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeBirdsEyeName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeBirdsEyeDescription_Text")}})},cb:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeCollinsBartName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeCollinsBartDescription_Text")}})},os:new function(){w.defineGetter(this,"title",{get:function(){return u.getString("L_mapTypeOrdnanceSurveyName_Text")}}),w.defineGetter(this,"description",{get:function(){return u.getString("L_mapTypeOrdnanceSurveyDescription_Text")}})}},b={left:0,middle:1,right:2,getName:function(n){switch(n){case b.left:return"left";case b.middle:return"middle";case b.right:return"right"}return""},isValid:function(n){return n===b.left||n===b.middle||n===b.right}},e.ClientRegion=b,d.Layout={TopBottom:"topBottom",BottomTop:"bottomTop",LeftRight:"leftRight",RightLeft:"rightLeft"},g={light:0,dark:1},g.getImageryBackground=function(n){return n==="Aerial"||n==="EnhancedBirdseye"||n==="NativeBirdseye"||n==="streetside"?g.dark:g.light},ct={milesFeet:0,milesYards:1,kilometersMeters:2},nt={metersPerKm:1e3,yardsPerMeter:1.0936133,yardsPerMile:1760,feetPerYard:3,feetPerMeter:3.2808399,feetPerMile:5280},wt.prototype={getLocationCenter:function(){for(var i=this.highlightBoundRegions?this.highlightBoundRegions:this.boundRegions,r=0,u=0,n=i.length,e=n,t;e--;)t=i[e].getMercatorBounds().getCenter(),r+=t.x,u+=t.y;return this._locationCenter=it.toLocation(new f(r/n,u/n)),this.getLocationCenter=function(){return this._locationCenter},this._locationCenter},getMercatorBounds:function(){var t=null,i=null,r=null,u=null,e=this.boundRegions,f=this.boundRegions.length-1,n;if(f>-1)for(n=e[f].getMercatorBounds(),t=n.y,i=n.x,r=n.getRight(),u=n.getBottom();f--;){var n=e[f].getMercatorBounds(),o=n.y,s=n.x,h=n.getRight(),c=n.getBottom();o<t&&(t=o),c>u&&(u=c),s<i&&(i=s),h>r&&(r=h)}return this._mercatorBounds=new ti(i,t,r-i,u-t),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds}},vi.prototype={getHotRegionsForTile:function(n){var r={},h,u,t,c,o,s;for(this._tileIndexedHotRegions=r,h=n.length,u=this.hotRegions,t=0,c=u.length;t<c;t++)for(var e=u[t],i=e.getMercatorBounds(),v=new f(i.x,i.y),y=new f(i.getRight(),i.getBottom()),w=p.getMercatorBoundsDescriptor(v,y,h),l=p.getQuadkeysForBounds(w),a=l.length;a--;)o=l[a],s=r[o],s?s.push(e):r[o]=[e];return this.getHotRegionsForTile=function(n){var t=this._tileIndexedHotRegions[n];return t?t:[]},this.getHotRegionsForTile(n)}};var lt=function(n,t,i,r){function y(n,t){return n.z-t.z}function l(n){return n==="l1"?1:n==="l2"?2:n.length+2}function w(n,t){var u=l(n),f=o[u],r=h[u],y,s,a,e,w,v;if(f||(f=o[u]={},r=h[u]=[]),f[n])return!1;for(f[n]=t,r.push(n),y=(Math.ceil(i.getHeight()/1024)+2*c)*(Math.ceil(i.getWidth()/1024)+2*c);r.length>y;){for(s||(s=k(p.getMapTargetMercatorBounds(i),Math.max(u-2,0))),a=!1,e=0,w=r.length;e<w;e++)if(b(s,r[e])===-1){v=r.splice(0,e+1),delete f[v.pop()],r=r.concat(v),a=!0;break}if(!a)break}return!0}function b(n,t){for(var i=n.length;i--;)if(n[i]===t)return i;return-1}function k(n,t){var i=new f(n.left,n.top),r=new f(n.right,n.bottom),u=p.getMercatorBoundsDescriptor(i,r,t);return p.getQuadkeysForBounds(u)}function d(n,t){var i,o,s;if(delete u[t],n&&rt(n.hrs)){i=null,i=t==="l1"?new pt(-1,0,0):t==="l2"?new pt(0,0,0):ni.toTileId(t);for(var r=[],f=n.hrs,e=f.length;e--;)o=new wt(f[e],i),r.push(o);r.sort(y),s=new vi(r),w(t,s)}}function s(i){var y=l(i),h=o[y],f,e,s,c,v;h&&h[i]||(nt(),u[i]||(u[i]={requestTime:(new Date).getTime()},f="",e="",i==="l1"?e="&lod=1":i!=="l2"&&(f=i),s="0",f!==""&&(s=f.charAt(f.length-1)),c=typeof t=="function"?t(i):n,v=c.replace("{subdomain}",s).replace("{quadkey}",f).replace("{jsonp}",a).replace("{jsonso}",encodeURIComponent(r+"|"+i))+e,yt.getObjectAsyncCacheFriendly(v)))}function g(){u={}}function nt(){var i=(new Date).getTime(),n,t;for(n in u)t=u[n].requestTime,t&&i-t>v&&delete u[n]}function tt(n){var i=p.tileQuadkeyToSheetQuadkey(n),u=n.length,r=o[u],t;if(r){if(t=r[i],t)return t.getHotRegionsForTile(n);s(i)}return[]}function it(n,t){var i;if(t===1)s("l1");else if(t===2)s("l2");else for(var h=Math.max(t-2,0),c=new f(n.left,n.top),l=new f(n.right,n.bottom),a=p.getMercatorBoundsDescriptor(c,l,h),r=p.getQuadkeysForBounds(a),u=o[t],e=r.length;e--;)i=r[e],u&&u[i]||s(i)}function rt(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"}var e=this,a="microsoftMapsHotRegionsCacheCallback",o={},h={},c=1,v=1e4,u={};e.getTileHotRegionsForQuadkey=tt,e.loadQuadkeysForMercatorBounds=it,e.getHotRegionsNetworkCallback=d,e.clearRequestedQuadkeys=g,e.getId=function(){return r}},dr=function(){function i(t){for(var i=n.length;i--;)if(n[i].layer.getId()===t)return i;return null}function r(t,r){if(r){var u=decodeURIComponent(r).split("|"),e=u[0],o=u[1],f=i(e);f!==null&&n[f].layer.getHotRegionsNetworkCallback(t,o)}}function u(t){for(var i=[],r=n.length;r--;)i=i.concat(n[r].layer.getTileHotRegionsForQuadkey(t));return i}function f(t,i){for(var r=n.length;r--;)n[r].layer.loadQuadkeysForMercatorBounds(t,i)}function e(n,t){return t.zIndex-n.zIndex}function o(t,r){t instanceof lt&&(r||(r=0),i(t.getId())===null&&(n.push({zIndex:r,layer:t}),n.sort(e)))}function s(t){if(t instanceof lt){var r=i(t.getId());r!==null&&(n.splice(r,1),t.clearRequestedQuadkeys())}}function h(){return n.length}var t=this,n=[];t.addLayer=o,t.removeLayer=s,t.getLayerCount=h,t.getTileHotRegionsForQuadkey=u,t.loadQuadkeysForMercatorBounds=f,window["microsoftMapsHotRegionsCacheCallback"]=r},p=new function(){this.tilePixelToLocation=function(n,t){var i=this._tilePixelToMapPixel(n,t),r=this._mapPixelToMercatorPoint(n.levelOfDetail,i);return it.toLocation(r)},this.tilePixelToMapPixel=function(n,t){return new f(n.x*1024+t.x,n.y*1024+t.y)},this.mapPixelToMercatorPoint=function(n,t){var i;return i=n<0?1/(1<<Math.abs(n)):1<<n,new f(t.x/i/1024,t.y/i/1024)},this.getMapTargetMercatorBounds=function(n){var r=n.getMode().tryPixelToMercatorPoint,o,t;if(r){var u=n.getHeight()/2,e=n.getWidth()/2,s=new f(-e,-u),i=r(s);return i.x=(i.x%1+1)%1,i.y=(i.y%1+1)%1,o=new f(e,u),t=r(o),t.x=(t.x%1+1)%1,t.y=(t.y%1+1)%1,{left:i.x,right:t.x,top:i.y,bottom:t.y}}return null},this.getQuadkeysForBounds=function(n){for(var h=n.levelOfDetails,r=n.tileIdXCount,c=n.tileIdYCount,l=n.tileIdX0,a=n.tileIdY0,u=n.tileIdCount,f=[],t,e,o,i,s;r--;)for(t=c,e=(l+r)%u;t--;)o=(a+t)%u,i=ni.fromTileId(new pt(h,e,o)),i.length===0&&(s=0,s++),f.push(i);return f},this.getMercatorBoundsDescriptor=function(n,t,i){var u=oi.mercatorXYToTileId(n,i),o=oi.mercatorXYToTileId(t,i),r=1<<i,e=(o.x-u.x+r)%r+1,h=u.x,s,f;return e===1&&t.x<n.x&&(e=r,h=0),f=(o.y-u.y+r)%r+1,s=u.y,f===1&&t.y<n.y&&(f=r,s=0),{mercatorTL:n,mercatorBR:t,levelOfDetails:i,tileIdTL:u,tileIdBR:o,tileIdX0:h,tileIdY0:s,tileIdXCount:e,tileIdYCount:f,tileIdCount:r}},this.tileQuadkeyToSheetQuadkey=function(n){var t=n.length,i="l1";return t>2?i=n.substr(0,t-2):t===2&&(i="l2"),i}};ii.prototype={type:"polygon",getLocations:function(){var r,u;this._locations=[];for(var n=this._locations,t=this.getMercatorPoints(),i=t.length;i--;)r=t[i],u=it.toLocation(r),n.push(u);return this.getLocations=function(){return this._locations},n},getMercatorPoints:function(){var r,u;this._mercatorPoints=[];for(var n=this._mercatorPoints,t=this.getMapPixels(),i=t.length;i--;)r=t[i],u=p.mapPixelToMercatorPoint(this._tileId.levelOfDetail,r),n.push(u);return this.getMercatorPoints=function(){return this._mercatorPoints},n},getMapPixels:function(){var r;this._mapPixels=[];for(var n=this._mapPixels,t=this._quadkeyTilePoints,i=t.length;i--;)r=p.tilePixelToMapPixel(this._tileId,t[i]),n.push(r);return this.getMapPixels=function(){return this._mapPixels},n},getMercatorBounds:function(){var e=null,o=null,t=null,i=null,r=this.getMercatorPoints(),n=r.length-1,u,f;if(n>-1)for(e=t=r[n].x,o=i=r[n].y;n--;)u=r[n].x,f=r[n].y,u>e?e=u:u<t&&(t=u),f>o?o=f:f<i&&(i=f);return this._mercatorBounds=new ti(t,i,e-t,o-i),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds},isMercatorPointInBoundRegion:function(n){for(var t=this.getMercatorPoints(),o=t.length-1,c=n.x,u=n.y,f=!1,i=0,r=o-1;i<o;r=i++){var e=t[i].y,s=t[r].y,h=t[i].x,l=t[r].x;e>u!=s>u&&c<(l-h)*(u-e)/(s-e)+h&&(f=!f)}return f}},ri.prototype={getLocations:function(){var n=this.getMercatorBounds(),i=new f(n.x,n.y),r=new f(n.getRight(),n.y),u=new f(n.getRight(),n.getBottom()),e=new f(n.x,n.getBottom()),t=it.toLocation(i),o=it.toLocation(r),s=it.toLocation(u),h=it.toLocation(e);return this._locationBounds=[t,o,s,h,t],this.getLocations=function(){return this._locationBounds},this._locationBounds},type:"circle",getLocationCenter:function(){return this._locationCenter=it.toLocation(this.getMercatorCenter()),this.getLocationCenter=function(){return this._locationCenter},this._locationCenter},getMercatorCenter:function(){return this._mercatorCenter=p.mapPixelToMercatorPoint(this._tileId.levelOfDetail,this.getMapCenter()),this.getMercatorPoints=function(){return this._mercatorCenter},this._mercatorCenter},getMercatorRadius:function(){return this._mercatorRadius=p.mapPixelToMercatorPoint(this._tileId.levelOfDetail,new f(0,this._quadkeyTilePointRadius)).y,this.getMercatorRadius=function(){return this._mercatorRadius},this._mercatorRadius},getPixelRadius:function(){return this._quadkeyTilePointRadius},getMapCenter:function(){return this._mapCenter=p.tilePixelToMapPixel(this._tileId,this._quadkeyTilePointCenter),this.getMapCenter=function(){return this._mapCenter},this._mapCenter},getMercatorBounds:function(){var t=this.getMercatorCenter(),n=this.getMercatorRadius(),i=2*n;return this._mercatorBounds=new ti(t.x-n,t.y-n,i,i),this.getMercatorBounds=function(){return this._mercatorBounds},this._mercatorBounds},isMercatorPointInBoundRegion:function(n){var t=this.getMercatorCenter(),i=this.getMercatorRadius(),r=n.x-t.x,u=n.y-t.y;return r*r+u*u-i*i<=0}};var i=v.ignoreEvent,s=v.stopPropagation,h=v.reportAction,o=v.invokeEvent,r=v.createElement,at=v.createToolButton,ot=v.addIgnoreEvents,yi=v.removeIgnoreEvents,vt=v.isTouch,bt=v.addClass,nu=v.removeClass,tu=w.extend,pi=w.isArray;st=ir.prototype,st.showOverlays=function(t){var i,w,r,nt,h,b,l,a,tt,k,u,v,d,o,s,f,it,rt,g,ut,y,ot,p;if(this._map){if(i=this._map,w=!1,e.Themes&&(w=i.getTheme()instanceof e.Themes.BingTheme),r=new et({className:"MicrosoftNav"}),r.setNextSibling(i.getRootElement().firstChild),nt={breadcrumb:{overlayClass:bt(r.getClassName(),"NavBar_breadcrumb"),constructor:tr,args:t,displayField:"showBreadcrumb",defaultDisplay:!1},compass:{constructor:ki},zoom:{constructor:bi},modeselector:{constructor:wi,args:t,displayField:"showMapTypeSelector",defaultDisplay:!0,postCreate:function(n,t){b=new hr(i,t,n)}}},h=w?["modeselector","breadcrumb","zoom","compass"]:["breadcrumb","compass","zoom","modeselector"],t.showDashboard!==!1){for(l=new et({className:"OverlaysTL",stopPropagation:!0}),t.showDualMapTypeSelector&&(r.setOptions({className:bt(r.getClassName(),"NavBar_typeButton_count2")}),t.mapTypes=[]),tt=h.length,a=0;a<tt;a++)if(k=h[a],u=nt[k],u){if(u.displayField&&(v=t[u.displayField],v!==undefined&&!v||v===undefined&&!u.defaultDisplay))continue;u.overlayClass&&r.setOptions({className:bt(r.getClassName(),u.overlayClass)}),d=new u.constructor(u.args),l.addNamedEntity(k,d),u.postCreate&&u.postCreate(d,l)}r.addNamedEntity("overlaysTL",l)}(t.showScalebar!==!1||t.showCopyright!==!1||t.showLogo!==!1)&&(s=new et({className:"OverlaysBL"}),s.setParentOverride(i.getRootElement()),f=new et({className:"OverlaysBR"}),f.setParentOverride(i.getRootElement()),t.showLogo!==!1&&(it=new gi(t),o=t.logoPosition==="bottomLeft"?s:f,o.addNamedEntity("logo",it)),t.showScalebar!==!1&&(rt=new nr,o=t.scalebarPosition==="bottomLeft"?s:f,o.addNamedEntity("scalebar",rt)),t.showCopyright!==!1&&(g={},t.copyrightStacked===!0&&(g.className="CopyrightContainer stacked"),ut=new di(g),o=t.copyrightPosition==="bottomLeft"?s:f,o.addNamedEntity("copyright",ut)),t.copyrightPosition==="bottomRight"&&t.showLogo!==!1&&f.setOptions({className:"OverlaysBR-logoAware"}),r.addNamedEntity("overlaysBR",f),r.addNamedEntity("overlaysBL",s));function ft(){var n=r.getClassName();y&&(n=nu(n,"MapTypeId_"+y)),y=i.getMapTypeId(),n=bt(n,"MapTypeId_"+y),r.setOptions({className:n})}ot=n.addHandler(i,"maptypechanged",ft),ft();function st(){p&&(n.removeHandler(p),p=null,n.removeHandler(ot))}p=n.addHandler(i,"ondispose",st),i.overlays=r,n.invoke(i,"overlayscreationstart",{map:i,overlays:r}),this._overlays||(this._overlays=new c(i),this._overlays.update()),b&&i.addComponent("navigationBar",b)}},st.showHotRegions=function(n){this._map&&new kr(this._map,n)},st.showVenueMapsExplorer=function(){this._map&&new gr(this._map)},st.authenticate=function(n){this._map&&(this._authentication=new iu(this._map,n))},st.getCredentials=function(n){this._map&&this._authentication.getCredentials(n)},c.renderers={},c.registerOverlay=function(n,t){c.renderers[n]=t},c.getRenderer=function(n){return c.renderers[n.toString()]},a.Overlays=c,wi.prototype={_className:"NavBar_modeSelectorControlContainer",_mapTypes:null,_disableBirdseye:!1,getDomElement:ft,getClassName:function(){return this._className},getMapTypes:function(){return this._mapTypes},getDisableBirdseye:function(){return this._disableBirdseye},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),pi(t.mapTypes)&&(this._mapTypes=t.mapTypes,i=!0),typeof t.disableBirdseye=="boolean"&&(this._disableBirdseye=t.disableBirdseye,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ModeSelectorControl]"}},c.registerOverlay("[ModeSelectorControl]",ar),bi.prototype={_className:"NavBar_zoomControlContainer",_zoomInVisible:!0,_zoomOutVisible:!0,_zoomBarVisible:!0,_zoomBarToggle:!0,getDomElement:ft,getClassName:function(){return this._className},getZoomInVisible:function(){return this._zoomInVisible},getZoomOutVisible:function(){return this._zoomOutVisible},getZoomBarVisible:function(){return this._zoomBarVisible},getZoomBarToggle:function(){return this._zoomBarToggle},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.zoomInVisible=="boolean"&&(this._zoomInVisible=t.zoomInVisible,i=!0),typeof t.zoomOutVisible=="boolean"&&(this._zoomOutVisible=t.zoomOutVisible,i=!0),typeof t.zoomBarVisible=="boolean"&&(this._zoomBarVisible=t.zoomBarVisible,i=!0),typeof t.zoomBarToggle=="boolean"&&(this._zoomBarToggle=t.zoomBarToggle,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ZoomControl]"}},c.registerOverlay("[ZoomControl]",lr),ki.prototype={_className:"NavBar_compassControlContainer",_compassVisible:!0,_rotateVisible:!0,getDomElement:ft,getClassName:function(){return this._className},getCompassVisible:function(){return this._compassVisible},getRotateVisible:function(){return this._rotateVisible},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.compassVisible=="boolean"&&(this._compassVisible=t.compassVisible,i=!0),typeof t.rotateVisible=="boolean"&&(this._rotateVisible=t.rotateVisible,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[CompassControl]"}},c.registerOverlay("[CompassControl]",fr),tu(et,ei),l=et.prototype,l.getDomElement=ft,l._nextSibling=null,l.getNextSibling=function(){return this._nextSibling},l.setNextSibling=function(n){this._nextSibling=n},l._parentOverride=null,l.getParentOverride=function(){return this._parentOverride},l.setParentOverride=function(n){this._parentOverride=n},l._className="",l.getClassName=function(){return this._className},l._stopPropagation=!1,l.getStopPropagation=function(){return this._stopPropagation},l.setOptions=function(t,i){var r=et.superClass.setOptions.call(this,t,!0);return t&&(typeof t.className=="string"&&(this._className=t.className,r=!0),typeof t.stopPropagation=="boolean"&&(this._stopPropagation=t.stopPropagation,r=!0)),r&&!i&&n.invoke(this,"entitychanged",{entity:this}),r},l.addNamedEntity=function(n,t){this._namedEntities[n]=t,this.push(t)},l.insertNamedEntity=function(n,t,i){this._namedEntities[n]=t,this.insert(t,i)},l.getNamedEntity=function(n){return this._namedEntities[n]},l.removeNamedEntity=function(n){var t=this._namedEntities[n];t&&(delete this._namedEntities[n],this.remove(t))},l.toString=function(){return"[OverlayEntityCollection]"},c.registerOverlay("[OverlayEntityCollection]",vr),di.prototype={_className:"CopyrightContainer",getDomElement:ft,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[CopyrightControl]"}},c.registerOverlay("[CopyrightControl]",yr),gi.prototype={_className:"LogoContainer",_clickable:!0,_enableSearch:!0,_showCombinedOnly:!1,getDomElement:ft,getClassName:function(){return this._className},getClickable:function(){return this._clickable},getEnableSearch:function(){return this._enableSearch},getShowCombinedOnly:function(){return this._showCombinedOnly},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),typeof t.clickable=="boolean"&&(this._clickable=t.clickable,i=!0),typeof t.enableSearch=="boolean"&&(this._enableSearch=t.enableSearch,i=!0),t.showLogo==="combined"&&(this._showCombinedOnly=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[LogoControl]"}},c.registerOverlay("[LogoControl]",pr),nr.prototype={_className:"ScaleBarContainer",getDomElement:ft,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[ScalebarControl]"}},c.registerOverlay("[ScalebarControl]",br),tr.prototype={_className:"BreadcrumbContainer",getDomElement:ft,getClassName:function(){return this._className},setOptions:function(t){if(t){var i=!1;typeof t.className=="string"&&(this._className=t.className,i=!0),i&&n.invoke(this,"entitychanged",{entity:this})}},toString:function(){return"[BreadcrumbControl]"}},c.registerOverlay("[BreadcrumbControl]",cr),delete window[$MapsNamespace].Maps.initMapDelayCode,a.Dynamic&&a.Dynamic.done("Microsoft.Maps.Overlays"),fi.end("Map delay initialized","mapdelay")},window[$MapsNamespace].Maps.Map&&window[$MapsNamespace].Maps.initMapDelayCode&&window[$MapsNamespace].Maps.initMapDelayCode(),window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.initInfoboxRenderer=function(){function v(u){function s(n,i,u){if(n.trueEntity&&s(n.trueEntity,i,u),r.hasHandler(n,i)){var f=t.Screen.get_mouse_pos(u),e=new l(c,"infobox",n,i,f.x,f.y,0,!1,u);r.invoke(n,i,e)}}function y(n,r){var e=r&&r[f],o=e&&e.infoBoxNode,u;if(o&&(u=t(o).select("a[href!=#recycle],link[href],button,input,command,textarea,select").filter(function(n){return!n.disabled}),u=u[n.forwardFocus?0:u.length-1],u&&r.getTypeName()!==i.InfoboxType.mini))try{u.focus(),n.nativeEvent.preventDefault()}catch(s){}}var c=u,v="cm"+a.getNext(),f=v+"_etr";this.shouldDraw=function(n,t){return n.getVisible()&&(n.getClip()===!1?t.actualBounds.contains(n.getLocation()):t.currentBounds.contains(n.getLocation()))},this.update=function(l,a){var ni=a.customRenderer,ft=a.update,ti=l.trueEntity||l,p,v,st,ii,yt,rt,b,ct,fr,ri,li,ut,ui,et,nt,d,it,fi,ht,w,ai,g,k,pt,ei,oi,lr,tt,yi,kt,pi,wi,si,bi,lt,or,sr,hi,gi,bt,nr,tr,ir,rr,ur,cr,ot,vt;if(r.hasHandler(ti,"focusreceived")||r.addHandler(ti,"focusreceived",function(n){y(n,l)}),v=l[f],v?(ft=v.updateEntity||ft,v.updateEntity=!1):(p=n(null,h.safariRenderHack),st=document.createElement("a"),st.href="#recycle",st.innerHTML="&nbsp;",st.style.cssText="position:absolute;height:1px;width:1px;top:0;left:0;text-decoration:none;line-height:0;",ii=st.cloneNode(!0),st.onclick=ii.onclick=function(){return!1},st.onfocus=ii.onfocus=function(){var n=ti.getPushpin();n&&n.receiveFocus()},v={dom:p,recycleAnchors:{a:st,z:ii}},l[f]=v,ft=!0),p=v.dom,yt=l.getTypeName(),rt=l.getHtmlContent()==null||l.getTitle()!==null&&l.getTitle()!==""||l.getDescription()!==null&&l.getDescription()!="",ft)if(v.htmlContent!=null&&rt&&(v.htmlContent.style.display="none",v.infoBoxNode!=null&&(v.infoBoxNode.style.display="")),rt){for(v.infoBoxNode==null?(b=n("div"),p.appendChild(b),b.className=yt,v.infoBoxNode=b):(b=v.infoBoxNode,b.className=yt),b.offsetWidth,l.getShowCloseButton()&&v.closeButtonNode==null&&rt?(ct=n("a"),fr=document.createTextNode("x"),b.appendChild(ct),ct.className="infobox-close",ct.href="#",ct.appendChild(fr),ri=function(n){n.preventDefault(),(l.trueEntity||l).setOptions({visible:!1})},t(ct).add_event("click",ri).add_event("touchend",ri),v.closeButtonHideEvent=ri,v.closeButtonNode=ct):l.getShowCloseButton()&&rt||!v.closeButtonNode||(t(v.closeButtonNode).remove_event("click",v.closeButtonHideEvent).remove_event("touchend",v.closeButtonHideEvent),v.closeButtonHideEvent=null,b.removeChild(v.closeButtonNode),v.closeButtonNode=null),li=l.getHeight()-55,l.getActions().length>0&&(li-=32),ut=l.getTitle(),ui=null,ut===""&&(ut=null),ut&&l.getTitleIsPlaintext()&&(ui=document.createTextNode(ut)),et=l.getDescription(),et===""&&(et=null),nt=v.contentNode,nt==null&&rt?(nt=n("div"),nt.className="infobox-body",b.appendChild(nt),v.contentNode=nt):nt==null||rt||(b.removeChild(nt),v.contentNode=null),d=v.titleDivNode,ut!=null&&v.titleDivNode==null&&(d=n("div"),d.className="infobox-title",nt.insertBefore(d,nt.firstChild),v.titleDivNode=d),it=v.titleLinkNode,it!=null&&(v.titleLinkHandler!=null&&(t(it).remove_event("click",v.titleLinkHandler).remove_event("touchend",v.titleLinkHandler),v.titleLinkHandler=null),it.firstChild&&it.removeChild(it.firstChild),v.titleLinkNode=null,it=null);d!=null&&d.firstChild;)d.removeChild(d.firstChild);if(ut==null&&d!=null&&(nt.removeChild(d),v.titleDivNode=null),ut!=null&&(fi=d,l.getTitleClickHandler()!=null&&(fi=it=n("a"),d.appendChild(it),v.titleLinkNode=it,it.setAttribute("href","#"),t(it).add_event("click",l.getTitleClickHandler()).add_event("touchend",l.getTitleClickHandler()),v.titleLinkHandler=l.getTitleClickHandler()),ui?fi.appendChild(ui):fi.innerHTML=ut),ut!==null&&l.getTitleAction()!==null&&(ht=l.getTitleAction(),v.titleAction=[],w=n("a"),w.className="infobox-titleActionLink",w.appendChild(document.createTextNode(ht.label)),kt=ht.url?ht.url:"#",w.setAttribute("href",kt),ht.urltarget&&w.setAttribute("target",ht.urltarget),ai=document.createElement("span"),ai.className="infobox-titleActionSeparator",d.appendChild(ai),d.appendChild(w),t(w).add_event("click",ht.eventHandler).add_event("touchend",ht.eventHandler)),g=v.descriptionNode,et!=null&&g==null&&(g=n("div"),g.cssText="height:"+li+"px",g.className="infobox-info",v.actionsNode?nt.insertBefore(g,v.actionsNode):nt.appendChild(g),v.descriptionNode=g),et!=null)if(et.innerHTML){while(g.firstChild)g.removeChild(g.firstChild);g.appendChild(et)}else g.innerHTML=et;else g&&(p.removeChild(g),v.descriptionNode=null);if(k=l.getActions(),k.length>0)if(v.actionsNode!=null){while(v.actionsNode.firstChild)v.actionsNode.removeChild(v.actionsNode.firstChild);pt=v.actionsNode}else pt=n("div"),v.actionsNode=pt,pt.className="infobox-actions",nt.appendChild(pt);if(v.actionsEventHandlers!=null)try{while((ei=v.actionsEventHandlers.pop())!=null)t(ei.elem).remove_event("click",ei.event).remove_event("touchend",ei.event)}catch(pr){}if(k.length>0){for(oi=n("ul"),oi.className="infobox-actions-list",lr=[],v.actionsEventHandlers=[],tt=0;tt<k.length;tt++){var er=n("li"),w=n("a"),vi,ar=c.getImageryId();switch(ar){case"Aerial":case"EnhancedBirdseye":case"NativeBirdseye":vi="dark";break;default:vi="light"}yi=k[tt][vi+"Icon"]||k[tt].icon,kt=k[tt].url?k[tt].url:"#",w.setAttribute("href",kt),k[tt].urltarget&&w.setAttribute("target",k[tt].urltarget),yi?(w.className="icon",pi=n("img"),pi.src=yi,w.appendChild(pi),wi=n("span"),wi.className="iconUnderline",w.appendChild(wi)):(w.innerHTML=k[tt].label,w.id=k[tt].id),er.appendChild(w),oi.appendChild(er),t(w).add_event("click",k[tt].eventHandler).add_event("touchend",k[tt].eventHandler),v.actionsEventHandlers.push({elem:w,event:k[tt].eventHandler})}pt.appendChild(oi)}l.getShowPointer()&&v.pointerNode==null&&rt?(si=n("div"),si.className="infobox-stalk",b.appendChild(si),v.pointerNode=si):l.getShowPointer()&&rt||!v.pointerNode||(b.removeChild(v.pointerNode),v.pointerNode=null)}else bi=l.getHtmlContent(),lt=v.htmlContent,ut==null&&et==null&&bi!=null&&(lt==null&&(lt=n("div"),p.appendChild(lt),v.htmlContent=lt),lt.innerHTML=bi,b=lt,v.infoBoxNode!=null&&(v.infoBoxNode.style.display="none"),v.pointerNode!=null&&(v.pointerNode.style.display="none"),p.style.pointerEvents="all");ti.getPushpin()&&(or=v.recycleAnchors.a,sr=v.recycleAnchors.z,p.insertBefore(or,p.firstChild),p.appendChild(sr));var dt="position:absolute;overflow:visible;white-space:normal;line-height:16px;pointer-events:none;",gt="position:absolute;background-color:white;border:1px solid rgb(136, 136, 136);left:0px;top:0px;pointer-events:auto;",ki="width:33px;height:38px;overflow:hidden;position:absolute;z-index:1;",wt=l.getClip();if(!ni&&(!a.linear||!v.isDrawn||wt===!1))if(hi=c.tryLocationToPixel(l.getLocation(),wt===!1?o.control:o.viewport),hi){var hr=l.getOffset(),di=l.getAnchor(),vr=wt===!1?0:a.parentOffsetLeft||0,yr=wt===!1?0:a.parentOffsetTop||0,ci=hi.x-vr,at=hi.y-yr;ci=ci+hr.x-di.x,at=at-hr.y-di.y,ft&&rt?(dt+="left:"+ci+"px;",dt+="top:"+at+"px;"):(p.style.position="absolute",p.style.left=ci+"px",p.style.top=at+"px",p.style.display="")}else ft?dt+="display:none;":p.style.display="none";ft&&rt&&(gi=l.getZIndex(),typeof gi=="number"&&(dt+="z-index:"+gi+";"),gt+="width:"+l.getWidth(),gt+=typeof l.getWidth()=="number"?"px;":";",gt+="height:"+l.getHeight(),gt+=typeof l.getHeight()=="number"?"px;":";",wt===!1&&(p.className=u.getRootElement().className,t(p).remove_class("MapTypeId_m").add_class("InfoboxExtension")),p.style.cssText=dt+h.safariRenderHack,ki+="left:20px;",ki+="top:"+l.getHeight()+"px;",yt==="Infobox"?v.infoBoxNode.style.cssText=gt:(ot=l.getWidth(),k&&k.length>5&&ot<390&&(ot=ot+16),vt=l.getHeight(),bt="",bt+="width:"+ot,bt+=typeof ot=="number"?"px;":";",bt+="height:"+vt,bt+=typeof vt=="number"?"px;":";",v.infoBoxNode.style.cssText=bt),l.getShowPointer()&&yt==="Infobox"&&(v.pointerNode.style.cssText=ki)),l.getShouldFireEvents()&&(v.mapImageryChanged||(nr=function(){r.invoke(l,"entitychanged",{entity:l})},r.addHandler(c,"imagerychanged",nr),v.mapImageryChanged=nr),v.mouseDoubleClickInfobox||(tr=function(n){s(l,"dblclick",n),n.stopPropagation()},t(p).add_event("dblclick",tr,!0),v.mouseDoubleClickInfobox=tr),v.mouseEnterInfobox||(ir=function(n){s(l,"mouseenter",n),n.stopPropagation()},t(p).add_event("mouseenter",ir,!0),v.mouseEnterInfobox=ir),v.mouseLeaveInfobox||(rr=function(n){s(l,"mouseleave",n),n.stopPropagation()},t(p).add_event("mouseleave",rr,!0),v.mouseLeaveInfobox=rr),v.mouseClickInfobox||(ur=function(n){s(l,"click",n),n.stopPropagation()},t(p).add_event("click",ur,!1),v.mouseClickInfobox=ur),t(p).add_event("touchstart",e)),ni?v.isDrawn?ft&&ni.updateEntity(l):(ni.addEntity(l,p),v.isDrawn=!0):(v.isDrawn||(wt===!1?(cr=u.getRootElement().parentNode,cr.appendChild(p)):a.parentDom.appendChild(p),v.isDrawn=!0),b&&ft===!0&&(yt!==i.InfoboxType.standard||l.getHtmlContent()!==null)&&(ot=b.offsetWidth,vt=b.offsetHeight,l.setCalculatedSize({width:ot,height:vt}),at=at+di.y-vt,p.style.top=at+"px"))},this.remove=function(n,i){if(n&&n[f]){var u=n[f],o=u.dom;o&&u.isDrawn&&(r.removeHandler(u.mapImageryChanged),t(o).remove_event("mouseenter",u.mouseEnterInfobox,!0).remove_event("mouseleave",u.mouseLeaveInfobox,!0).remove_event("click",u.mouseClickInfobox,!1).remove_event("dblclick",u.mouseDoubleClickInfobox,!0).remove_event("touchstart",e,!1),u.mapImageryChanged=u.mouseEnterInfobox=u.mouseLeaveInfobox=u.mouseClickInfobox=u.mouseDoubleClickInfobox=null,o.parentNode&&o.parentNode.removeChild(o)),u.updateEntity=u.updateEntity||i.update,u.isDrawn=!1,i.customRenderer&&i.customRenderer.removeEntity(n)}},this.dispose=function(n){delete n[f]}}var i=window[$MapsNamespace].Maps,t=i.Gimme,y=i.Globals,r=i.Events,c=i.Infobox,o=i.PixelReference,u=i.InternalNamespaceForDelay,s=u.CompositeMode,f=u.Common,l=u.MouseEventArgs,s=u.CompositeMode,a=u.IdGenerator,h=u.Quirks,e=f.stopPropagation,n=f.createElement,e=f.stopPropagation,n=f.createElement;new function(){var n=[],t=[],i=function(i,r){var u=null,f;if(r instanceof c){for(f=n.length;f--;)n[f]===i&&(u=t[f]);u||(u=new v(i),n.push(i),t.push(u))}return u};s.registerEntityRenderer(i)},delete window[$MapsNamespace].Maps.initInfoboxRenderer},window[$MapsNamespace].Maps.Map&&window[$MapsNamespace].Maps.initInfoboxRenderer&&window[$MapsNamespace].Maps.initInfoboxRenderer(),window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.Streetside=window[$MapsNamespace].Maps.Streetside||{},window[$MapsNamespace].Maps.initStreetsideAvailabilityCode=function(){function p(t,r,u){var f=t.bounds,c=t.center,y=t.radius||n.BlockLookupService.defaultRadiusInMeters,a,e,v,p,h;u=u||i.streetside360,u===i.streetside360?(a=n.CubeLookupService,e=[1,f],f instanceof s||(v=l(y),f=new s(c,v,v),e=[1,f])):(a=n.BlockLookupService,e=[c,y],c instanceof o||(p=w(f),e=[f.center,p])),h=g(u,r),e.push(h.available,h.unavailable,h.error),a.lookup.apply(window,e)}function w(n){var t=n.height*h.earthCircumferenceInMeters/360,i=n.width*Math.cos(n.center.latitude*v.radiansPerDegree)*h.earthCircumferenceInMeters/360;return Math.floor(Math.sqrt(i*i+t*t)/2)}function l(n){return n*720/h.earthCircumferenceInMeters}function g(n,t){function r(n){t(!0,{mapTypeId:i.streetside360,cubeID:n[1].id,center:new o(n[1].la,n[1].lo,n[1].al,k.ellipsoid),cubePitch:n[1].pi,cubeHeading:n[1].he,cubeRoll:n[1].ro})}function u(n,r){n.streetsideMetadata=r,n.mapTypeId=i.streetsideSlide,n.center=n.projectedLatitude!=null&&n.projectedLongitude!=null?new o(n.projectedLatitude,n.projectedLongitude):location,t(!0,n)}function f(){t(!1,null)}function e(){t(!1,null)}return{available:n===i.streetside360?r:u,unavailable:f,error:e}}var r=window[$MapsNamespace].Maps,b=r.Map,a=r.Gimme,t=r.Globals,o=r.Location,s=r.LocationRect,i=r.MapTypeId,k=r.AltitudeReference,n=r.Streetside,u=r.InternalNamespaceForDelay,d=u.Dispatcher,h,v,y,c,f,nt,e;u.Streetside=u.Streetside||{},h=u.MapMath,v=u.VectorMath,i.streetside360="ss360",i.streetsideSlide="ssSlide",y=1e6,c=8.5,n.isAvailabilityRectTooLarge=function(t,r){return r===i.streetsideSlide?n.isAvailabilityRadiusTooLarge(w(t),r):t.getNorth()-t.getSouth()>c||t.getEast()-t.getWest()>c},n.isAvailabilityRadiusTooLarge=function(t,r){if(r===i.streetsideSlide)return t>y;var u=l(t),f=new location(0,0);return n.isAvailabilityRectTooLarge(new s(f,u,u))},n.isValidMapTypeId=function(n){return n===i.streetside360||n===i.streetsideSlide},n.checkAvailabilityRadius=function(n,t,i,r){if(n instanceof o&&t>=0){var u={center:n,radius:t,bounds:{}};p(u,i,r)}else throw"Cannot invoke availability lookup service -- insufficient or invalid location and/or radius data";},n.checkAvailabilityRect=function(n,t,i){if(n instanceof s){var r={center:{},radius:null,bounds:n};p(r,t,i)}else throw"Cannot invoke availability lookup service -- insufficient or invalid locationRect";},u.Streetside.estimateRectHeightAndWidthFromRadius=l,b.prototype.isStreetside=function(){var n=this.getMapTypeId();return n===i.streetside360||i===n.streetsideSlide},f=n.Config,function(){f||(n.Config={Debug:!0},f=n.Config)}(),n.Debug=function(){this.assert=function(n,t){if(!n&&f.Debug)throw"assert failed: "+t;},this.log=function(n){var t=window.console||{};f.Debug&&t.log&&t.log(n)}},nt=n.Debug=new n.Debug,e=new function(){var u,f=0,c="microsoftMapsStreetsideCacheableNetworkCallback{0}",l="microsoftMapsStreetsideNetworkCallback{0}",e=5e3,v=30,y=.5,p=function(){return u||(u=a("HEAD").element()),u},i={},w=function(){var n=0,t;for(t in i)i.hasOwnProperty(t)&&++n;return n},b=function(n,t){return n.time>t.time?1:n.time<t.time?-1:0},k=function(){var u=w(),e=Math.floor(u*y),t,n,r=[],f;if(u>=v){for(t in i)i.hasOwnProperty(t)&&(f=i[t],f.id=t,r.push(f));for(r.sort(b),n=0;n<u-e;++n)r[n].inflight===!1&&delete i[r[n].id]}},g=function(n,t){if(k(),i[n]){if(i[n].listeners.length>0){for(var r=0;r<i[n].listeners.length;++r)i[n].listeners[r](t);i[n].listeners.length=0}}else i[n]={},i[n].listeners=[];i[n].inflight=!1,i[n].data=t,i[n].time=new Date},nt=function(n){delete i[n]},o=function(t,r,u){i[r]===undefined&&(i[r]={},i[r].listeners=[],i[r].inflight=!1),i[r].data!==undefined?(i[r].time=new Date,d.dispatch(n.Utils.createCallback(null,u,i[r].data))):(i[r].listeners.push(u),i[r].inflight||(i[r].inflight=!0,ut(t,r)))},s=function(t,i,r){t?g(r,i):(n.Debug.log("timed out or 404ed id = "+r),nt(r))},tt=function(n){n&&(n.src&&(n.src=""),n.parentNode&&n.parentNode.removeChild(n))},r=function(n,t){var n=n,t=t;return function(){if(window[n]!==undefined)try{delete window[n]}catch(i){window[n]=null}tt(a("#"+n).element()),t&&window.clearTimeout(t)}},it=function(n,t,i){var n=n,t=t,i=i,u=r(t,i);return function(t){s(!0,t,n),u()}},rt=function(n,t){var n=n,t=t,i=r(t);return function(){s(!1,null,n),i()}},h=function(n,t){var i=document.createElement("script");i.type="text/javascript",i.language="javascript",i.src=n,i.id=t,p().appendChild(i)},ut=function(n,t){var i=c.replace("{0}",t),u=window.setTimeout(rt(t,i),e),r;window[i]=it(t,i,u),r=n.replace("{callbackName}",i),h(r,i)};this.getChunkMetadataAsync=function(n,i,r){var u=t.streetsideChunkMetadataUriFormat.replace("{0}",t.locale).replace("{1}",i).replace("{2}",n).replace("{3}",t.streetsideTileGeneration).replace("{4}","{callbackName}");o(u,n,r)},this.getGlobalMetadataAsync=function(n,i,r){var u=t.streetsideGlobalMetadataUriFormat.replace("{0}",t.locale).replace("{1}",i).replace("{2}",n).replace("{3}",t.streetsideTileGeneration).replace("{4}","{callbackName}");o(u,n,r)},this.getJsonAsync=function(n,t){var i=l.replace("{0}",f),u=n.replace("{callbackName}",i),o=function(n,t,i){var u=r(n,t),i=i;return function(n){u(),i(n)}},s=window.setTimeout(r(i),e);window[i]=o(i,s,t),++f,h(u,i)}},n.MetadataService=e,n.BlockLookupService=new function(){this.defaultRadiusInMeters=20;var i=15,u=10,f=1e6,r=function(t,i,r){return function(u){u===null?i():u.statusCode&&u.statusCode!==200?(n.Debug.log("Invalid JSON data"+u.errorDetails),r(u)):u.bl&&u.smd?t(u.bl,u.smd):(n.Debug.log("Unexpected JSON response"),r(u))}};this.lookup=function(o,s,h,c,l){if(o&&o.latitude>=-90&&o.latitude<=90&&o.longitude>=-180&&o.longitude<=180&&s&&typeof h=="function"&&typeof c=="function"&&typeof l=="function"){s=Math.min(Math.max(s,u),f);var a=t.streetsideSingleBlockLookupWithDataUriFormat.replace("{0}",t.locale).replace("{1}",t.streetsideTileGeneration).replace("{2}",o.latitude.toFixed(i)).replace("{3}",o.longitude.toFixed(i)).replace("{4}",s).replace("{5}","{callbackName}");e.getJsonAsync(a,r(h,c,l))}else n.Debug.assert(!1,"Expected location, radius, and 3 callback functions as arguments")},this.tokenLookup=function(i,u,f,o){if(i&&typeof u=="function"&&typeof f=="function"&&typeof o=="function"){var s=t.streetsideSingleBlockTokenLookupWithDataUriFormat.replace("{0}",t.locale).replace("{1}",t.streetsideTileGeneration).replace("{2}",i).replace("{3}","{callbackName}");e.getJsonAsync(s,r(u,f,o))}else n.Debug.assert(!1,"Expected token, and 3 callback functions as arguments")}},n.CubeLookupService=new function(){function r(t,i,r){return function(u){u===null?(n.Debug.log("Unexpected JSON response"),r(u)):u.length>1?t(u):i()}}var i=t.streetsideCubeDataLookupUriFormat;this.lookup=function(u,f,o,s,h,c){u=u||1,s=s||function(){},h=h||function(){},c=c||"",n.Debug.assert(f&&o,"Minimum expected arguments: locationRect, and a callback function");var l=i.replace("{0}",u).replace("{1}",f.getNorth()).replace("{2}",f.getSouth()).replace("{3}",f.getEast()).replace("{4}",f.getWest()).replace("{5}","{callbackName}").replace("{6}",c).replace("{7}",t.tileMetaGeneration);e.getJsonAsync(l,r(o,s,h))}},delete window[$MapsNamespace].Maps.initStreetsideAvailabilityCode},window[$MapsNamespace].Maps.Map&&window[$MapsNamespace].Maps.initStreetsideAvailabilityCode&&window[$MapsNamespace].Maps.initStreetsideAvailabilityCode(),window.$MapsNamespace=window.$MapsNamespace||"Microsoft",window[$MapsNamespace]=window[$MapsNamespace]||{},window[$MapsNamespace].Maps=window[$MapsNamespace].Maps||{},window[$MapsNamespace].Maps.initMapAnalytics=function(){var n="length",o="indexOf",i=window[$MapsNamespace].Maps,s=i.Analytics=i.Analytics||{},f=i.Gimme,e=i.Globals,r=i.Events,u=i.InternalNamespaceForDelay,h=u.Common,t;if(!e.disableAnalytics){function c(i){function rt(n){if(n&&n.currentTarget){var t=f(n.currentTarget).get_attr("uici");t&&p({uici:t,autoLog:!0})}}function wt(n){if(n){n.lod=u.getZoom().toPrecision(2),n.mo=u.getHeading().toPrecision(3);var t=u.getCenter();n.mc="["+t.latitude.toPrecision(6)+","+t.longitude.toPrecision(6)+"]",n.til=y,tt=!1}}function bt(){var n=u.getTileDownloadMetrics();y=n>y?n:y+n,tt=!0}function kt(){tt&&!u.isDownloadingTiles()&&t.getDataBacklog()<=0&&p({})}function dt(n){n.componentName===ot&&(ct(),r.removeHandler(d),d=null)}function ct(){u&&u.overlays&&lt(u.overlays.getDomElement())}function gt(){for(var r=nt[n],t,i=0;i<r;i++)t=nt.shift(),typeof t[3]!="string"&&(t[3]=a?v:l),ht.LogIG.apply(s,t)}function p(n){var e,o,r,i,u;if(n){var t=n.customData||{},f=a?v:n.IG||l,c=n.autoLog;if(wt(t),t.uici=n.uici,c)for(e in h)h[e](t);if(n&&n.onClientAction)n.onClientAction(t);o=n.forceDispatch||!1,r=[vt,0,o,f];for(i in t)u=t[i],i!==null&&i!==undefined&&u!==null&&u!==undefined&&r.push(i,u);f&&g?ht.LogIG.apply(s,r):nt.push(r)}}function ut(n,t){if(t&&n)for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function ni(n,t){c[n]=ut({},t)}function ti(n,t){c[n]=ut(c[n],t)}function ii(n,t,i){var o=c[n],u,f,e,s,r;if(o){for(e=0,s=t.length;e<s;e++)r=o[t[e]],r&&(u=Math.min(u||r,r),f=Math.max(f||r,r));u&&f&&(o[i]=f-u)}}function ri(n,t){var i=ut(c[n],t);i&&p({uici:n,customData:i}),c[n]=null}function lt(n){f(n).select(et).add_event(b,rt)}function ui(n){f(n).add_event(b,rt)}function fi(n,t){typeof n=="string"&&typeof t=="function"&&(h[n]=t)}function ei(n){typeof n=="string"&&delete h[n]}function oi(n){g||(n&&(l=n.pageViewId||null,v=n.sessionKey||null,w=n.cId||null,ft=n.pcId||null),(l||a&&v)&&(g=!0,gt(),st=window.setInterval(kt,pt)))}function at(){var n,i;window.clearInterval(st),t.dispose(),r.removeHandler(k),k=null,r.removeHandler(it),it=null;for(n in h)delete h[n];h=null,u&&u.overlays&&(i=f(u.overlays.getDomElement()),i.select(et).remove_event(b,rt))}function si(){u&&(k=r.addHandler(u,"ondispose",at),u.getComponent(ot)?ct():d=r.addHandler(u,"componentadded",dt),u.addComponent("analyticsManager",s),it=r.addHandler(u,"tiledownloadcomplete",bt))}var s=i.getComponent("analyticsManager");if(s)return s;s=this;var l,w,ft=null,et="a,input[type=button],input[type=submit],input[type=checkbox],input[type=radio],button,.button,.pathNode",vt="MAPSAction",b="mousedown",h={},u=i,k=null,d=null,g=!1,ot="navigationBar",nt=[],v=null,a=e.frontdoorLogUrl?!1:!0,yt=e.frontdoorLogUrl||e.biciLoggingService,pt=3e4,st=-1,y=0,tt=!0,it=null,c={},ht=new function(){function b(){h("Init","CI","Base",!1),s=window.setInterval(v,p),r=1,f(window).add_event("beforeunload",c)}function h(i,r,u,f,e){var y="",w=e||l,v,h,s,p;if(w){if(f)for(v=0;v<f[n];v+=2)h=f[v],s=f[v+1],(typeof h!="string"||h[o]('"')<0)&&(h='"'+h+'"'),typeof s=="string"&&s[o]("{")<0&&s[o]('"')<0&&(s='"'+s+'"'),y+=h+":"+s+",";p='"TS":'+(new Date).getTime(),y+=a?p:'"T":"CI.'+i+'",'+(typeof r=="number"?'"K":'+r:'"FID":"'+r+'"')+","+p,t.add(w,y),u&&c()}}function k(){var n=yt;return n+(a?"?sk=%ig%&pid="+e.biciPID+"&DATA=":"?IG=%ig%"+(w?"&CID="+w:"")+(ft?"&PM=Y":"")+"&TYPE=Event.ClientInst&DATA=")}function c(){while(t.getDataBacklog()>0)v()}function v(){if(t.getDataBacklog()>0&&!u.isDownloadingTiles()){var n=t.fetchNextRequest(k(),y);n&&(i.ping.src=n)}}var i=this,y=2048,p=2e3,r=0,s=-1;i.ping=new Image,i.LogIG=function(n,t,i,u){r||b(),h(n,t,i,[].slice.apply(arguments).slice(4),u)}};s.removePreProcessor=ei,s.addPreProcessor=fi,s.registerAction=ui,s.registerChildActions=lt,s.logClientAction=p,s.beginBatchedAction=ni,s.logBatchedEvent=ti,s.computeTotalDuration=ii,s.endBatchedAction=ri,s.dispose=at,s.enable=oi,si()}s.AnalyticsManager=c}t=new function(){var t={},i=0;this.getDataBacklog=function(){return i},this.add=function(r,u){var f=t[r],u="{"+encodeURIComponent(u)+"}";f||(f=t[r]=[]),f.push(u),i+=u[n]},this.dispose=function(){for(var n in t)t.hasOwnProperty(n)&&(t[n]=null,delete t[n]);t={},i=0},this.fetchNextRequest=function(r,u){var l=null,e,o,v,s,a,f,c;if(typeof r=="string"&&u>0)for(e in t)if(o=e&&t[e],r=r.replace("%ig%",e),v=r[n]+e[n]+1,h.isArray(o)&&o[n]>0){for(s="[",a=!0;o[n]>0;)if(f=o.shift(),f){if(c=f[n],i-=c,f=(a?"":",")+f,c=f[n],c+s[n]+v>=u){l=r+s+"]";break}s+=f,a=!1}l=r+s+"]",delete t[e];break}return l}},delete window[$MapsNamespace].Maps.initMapAnalytics,u&&u.Dynamic&&u.Dynamic.done("Microsoft.Maps.Analytics"),u&&u.PRF.end("Module initialized","Microsoft.Maps.Analytics",{module:"Analytics"})},window[$MapsNamespace].Maps.Map&&window[$MapsNamespace].Maps.initMapAnalytics&&window[$MapsNamespace].Maps.initMapAnalytics()